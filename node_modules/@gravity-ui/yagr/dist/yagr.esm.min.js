/**
* Copyright (c) 2024, Yandex LLC
* All rights reserved. (MIT Licensed)
*
* Yagr@4.3.0
* High-performance HTML5 canvas chart renderer based on uPlot
* https://github.com/gravity-ui/yagr
*/

"use strict";var ma=Object.defineProperty,va=(e,t)=>{for(var s in t)ma(e,s,{get:t[s],enumerable:!0})},dl={};va(dl,{AXIS_LABEL_FONT:()=>tn,AXIS_VALUES_FONT:()=>sn,BARS_DRAW_FACTOR:()=>Rl,BARS_DRAW_MAX:()=>Pl,CURSOR_STYLE:()=>ln,DARK_DEFAULT_LINE_COLOR:()=>wl,DAY:()=>Ke,DECADE:()=>_a,DEFAULT_AXIS_FONT_SIZE:()=>bl,DEFAULT_CANVAS_PIXEL_RATIO:()=>tt,DEFAULT_FOCUS_ALPHA:()=>gl,DEFAULT_LOGARITHMIC_MIN_SCALE_VALUE:()=>en,DEFAULT_MAX_TICKS:()=>ml,DEFAULT_POINT_SIZE:()=>Hs,DEFAULT_SCALE_MIN_RANGE:()=>vl,DEFAULT_SYNC_KEY:()=>_l,DEFAULT_TITLE_FONT_SIZE:()=>Sl,DEFAULT_X_SCALE:()=>Ae,DEFAULT_X_SERIE_NAME:()=>Ji,DEFAULT_Y_AXIS_LABEL_PADDING:()=>Ll,DEFAULT_Y_AXIS_OFFSET:()=>Qi,DEFAULT_Y_AXIS_PADDING:()=>Al,DEFAULT_Y_AXIS_SIZE:()=>Tl,DEFAULT_Y_SCALE:()=>_t,HOUR:()=>Rt,LIGHT_DEFAULT_LINE_COLOR:()=>yl,MARKER_DIAMETER:()=>Ul,MINUTE:()=>$t,MIN_SELECTION_WIDTH:()=>Bl,PADDING_BOTH:()=>Nl,PADDING_LEFT:()=>Fl,PADDING_RIGHT:()=>Cl,SECOND:()=>Tt,SERIE_AREA_BORDER_COLOR:()=>Vl,SERIE_AREA_BORDER_WIDTH:()=>Hl,SERIE_COLOR:()=>zl,SERIE_LINE_WIDTH:()=>nn,TIME_MULTIPLIER:()=>Us,TOOLTIP_DEFAULT_MAX_LINES:()=>Yl,TOOLTIP_X_OFFSET:()=>Wl,TOOLTIP_Y_OFFSET:()=>$l,TYPES_ORDER:()=>Sa,X_AXIS_INCRS:()=>Ml,X_AXIS_SIZE:()=>Dl,X_AXIS_SPACE:()=>Ol,X_AXIS_TICK_GAP:()=>xl,YEAR:()=>Wt,Y_AXIS_LABEL_SIZE:()=>kl,Y_AXIS_SIZE:()=>Il,Y_AXIS_TICK_GAP:()=>El,default:()=>Gl});var Ji="date",Ae="x",_t="y",gl=.3,tt=typeof window>"u"?1:window.devicePixelRatio,ml=5,Qi=.05,vl=.01,en=.001,Hs=tt>=2?4:2,_l="sync",Sl=14,yl="#222222",wl="#eeeeee",bl=11,tn="normal 11px Lucida Grande, Arial, Helvetica, sans-serif",sn="11px Lucida Grande, Arial, Helvetica, sans-serif",El=6,Tl=12,Al=12,Ll=2,Il=(e,t,s)=>{if(!t)return Tl;const i=t.reduce((c,f)=>c.length>f.length?c:f),{ctx:n}=e;n.save();const r=e.axes[s];n.font=r.font?r.font[0]:sn;const{width:o}=n.measureText(i);n.restore();let u=0;if(r.label){u=r.labelSize||bl,n.font=r.labelFont?r.labelFont[0]:tn;const{fontBoundingBoxAscent:c}=n.measureText(r.label);u=c,n.restore()}return u?o/tt+u/tt+Ll:o/tt+Al},kl=11,Tt=1e3,$t=Tt*60,Rt=$t*60,Ke=Rt*24,Wt=Ke*365,_a=Wt*10,xl=6,Dl=32,Ol=80,Ml=[1,10,50,100,200,500,Tt,Tt*2,Tt*5,Tt*10,Tt*15,Tt*30,$t,$t*5,$t*10,$t*30,Rt,Rt*2,Rt*3,Rt*4,Rt*6,Rt*12,Ke,Ke*2,Ke*3,Ke*5,Ke*10,Ke*15,Ke*30,Ke*60,Ke*120,Ke*180,Wt,Wt*2,Wt*5,Wt*10],Sa=["dots","line","area","column"],Rl=.5,Pl=100,Fl=[14,14,0,4],Cl=[14,4,0,14],Nl=[14,4,0,4],zl="rgba(0, 0, 0, 1)",nn=2,Vl="rgba(0, 0, 0, 0.2)",Hl=1,Ul=8,ln="1px solid #ffa0a0",Bl=15,ya=.68,wa=-.6,Gl=class{constructor(e,t="light"){this.setTheme(t),this.colors=e}setTheme(e){this.theme=e}get GRID(){return{show:!0,stroke:()=>this.colors.parse("--yagr-grid"),width:1}}get X_AXIS_TICKS(){return{size:8,...this.GRID}}get Y_AXIS_TICKS(){return{size:6,...this.GRID}}get AXIS_STROKE(){return this.colors.parse("--yagr-axis-stroke")}get BACKGROUND(){return this.colors.parse("--yagr-background")}get SHIFT(){return this.theme?.startsWith("light")?ya:wa}get DEFAULT_LINE_COLOR(){return this.theme?.startsWith("light")?yl:wl}},$l=24,Wl=24,Yl=10,Us=1,ba=[0,0,0,.6],ui=class{static parseRgba(e){const t=e.match(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,?\s*(\d+\.?\d*)?\s*\)/);return t?[t[1],t[2],t[3],t[4]||1].map(Number):null}parse(e="000"){const t=e.startsWith("var(--");let s=e,i=!0,n;const r=this.context,o=r.style.color;return t||e.startsWith("--")?(i=!1,n=t?e.slice(4,-1):e):!e.startsWith("#")&&!e.startsWith("rgb")&&(r.style.color=e,n="color",i=!1),s=i?s:getComputedStyle(r).getPropertyValue(n),r.style.color=o,s}setContext(e){this.context=e}rgba(e){return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}toRgba(e,t){return ui.parseRgba(this.parse(e))||t}shade([e,t,s,i],n){const r=n<0,o=r?0:255*n,u=r?1+n:1-n,c=Math.round(e*u+o),f=Math.round(t*u+o),p=Math.round(s*u+o);return"rgba("+c+","+f+","+p+","+i+")"}},Ea=(e,t)=>{const s=e.utils.theme.SHIFT,i=e.uplot.series[t],n=ui.parseRgba(i.color)||ba;return e.utils.colors.shade(n,s)},jl=(e,t)=>(s,i)=>{const n=s.series[i];return n._focus===!1?n.getFocusedColor(e,i):n[t]},Ta=(e,t,s=!0)=>{const i=t>=0;let n=-1/0,r=null,o=1/0,u=null;const c=[];let f=null;for(let p=e.rows.length-1;p>=0;p--){const m=e.rows[p],{displayY:h,rowIdx:b}=m;let _;h!==null&&(h>n&&(n=h,r=m.rowIdx),h<o&&(o=h,u=m.rowIdx)),h===null||(i?h<0:h>=0)?_=null:i?_=t>h?null:h-t:_=t<h?null:Math.abs(h-t);const y=f===null?1/0:c[f],A=_===null?y:Math.min(y,_);(_!==null&&y===_||A!==y)&&(f=b)}return f===null&&s?t>=n?r:t<=o?u:null:f},Aa=(e,t,s)=>{let i=0,n=0;for(;n<e.length;){const r=e.length-n-1,o=e[r],u=o.$c;if(n+=1,o.scale!==s||o.show===!1)continue;const c=u[t];i+=typeof c=="number"?c:0}return i},La=(e,t)=>{let s,i,n=0;for(;!i&&n<e.rows.length;){const r=e.rows[n].displayY;r!==null&&(s=n,i=Math.abs(r-(t||0))),n+=1}if(!i||s===void 0)return null;for(n=s+1;n<e.rows.length;n++){const r=e.rows[n].displayY;if(r===null)continue;const o=Math.abs(r-t);i>o&&(i=o,s=n)}return s},Ia=e=>e>=1e18?[1e18,"E"]:e>=1e15?[1e15,"P"]:e>=1e12?[1e12,"T"]:e>=1e9?[1e9,"G"]:e>=1e6?[1e6,"M"]:e>=1e3?[1e3,"K"]:[1,""];function ka(e,t){if(t===0)return parseInt(e);if(Number.isInteger(e))return e+"."+"0".repeat(t);const[s,i]=e.toString().split(".");return i.length>=t?`${s}.${i.slice(0,t)}`:`${s}.${i}${"0".repeat(t-i.length)}`}function fi(e,t,s,i="closest",n=null){let r=s,o=s;const u=t.snapToValues??i;if(u===!1)return s;if(u==="left"||u==="closest"){for(let c=s-1;c>=0;c--)if(e[c]!==n){r=c;break}}if(u==="right"||u==="closest"){for(let c=s+1;c<e.length;c++)if(e[c]!==n){o=c;break}}return u==="left"?r:u==="right"?o:o-s>s-r?r:o}var Xl=(e,t,s,i,n,r,o,u="linear")=>{let c=null;const f=e[r];switch(u){case"linear":{if(t===null||s===null)return null;c=t+(f-i)*(s-t)/(n-i),(isNaN(c)||Math.abs(c)===1/0)&&(c=null);break}case"previous":{c=t;break}case"next":{c=s;break}case"left":{c=o[o.length-1]===e.length-1||s===null?null:t;break}case"right":{c=o[0]===0?null:s;break}case"closest":{const p=Math.abs(i-e[r]),m=Math.abs(n-e[r]);c=p<m?t:s;break}default:c=u}return c},Kl=()=>Math.random().toString(36).substr(2,9).replace(/^\d+/,""),xa=(e,t,s)=>{const i=[],n=s.nullValues||{},r=s.interpolation;for(let o=0;o<e.length;o++){const u=e[o],c=[];let f=[],p=null,m=null,h,b;for(let _=0;_<u.length;_++){let y=u[_];if(r&&y===r.value){f.push(_);continue}if(n[y]&&(y=null),f.length){m=y,b=t[_];for(const A of f)c[A]=Xl(t,p,m,h||t[0],b||t[t.length-1],A,f,r&&r.type);f=[]}p=y,h=t[_],c.push(y)}if(m=null,f.length)for(const _ of f)c.push(Xl(t,p,m,h||t[0],b||t[t.length-1],_,f,r&&r.type));i.push(c)}return i};function Da(e,t=300){let s;return(...i)=>{clearTimeout(s),s=setTimeout(()=>e(...i),t)}}var Pt=e=>e+"px",Yt=(e,t={},s)=>{const i=document.createElement(e);return Object.keys(t).forEach(n=>{const r=t[n];i.setAttribute(n,typeof r=="object"?Object.entries(r).map(([o,u])=>`${o}:${u}`).join(";"):r)}),s&&(typeof s=="string"?i.innerHTML=s:i.appendChild(s)),i};function ql(e,t){return t.split(".").reduce((s,i)=>Object.getOwnPropertyDescriptor(s,i)?.value??{},e)}function Bs(e,t){if(typeof e!=typeof t)return!1;if((typeof e=="function"||typeof t=="function")&&(e=e.toString(),t=t.toString()),typeof e!="object"||jt(e)||jt(t))return e===t;const s=e,i=t,n=Object.keys(s),r=Object.keys(i);if(n.length!==r.length)return!1;for(const o of n)if(!i.hasOwnProperty(o)||!Bs(s[o],i[o]))return!1;return!0}function Zl(e){return typeof e=="function"||typeof e>"u"?e:()=>e}function jt(e){return e==null}function Jl(e,t,s){return e>=t&&e<=s?e:e<t?t:s}var Oa=50;function Ql(e,t,s){if(s||=t.querySelector("span"),!s)return;t.style.background=`${e.color}`,s.style.background=e.color||zl;const i=ui.parseRgba(e.color)||[256,256,256,0];t.style.boxShadow=`0px 0px 0px 1px rgba(${i[0]}, ${i[1]}, ${i[2]}, 0.5)`}function Ma(e,t){const s=e.series[t],i=Yt("span"),n=Yt("div",{class:"yagr-point","data-idx":String(t)},s.empty?void 0:i);return s.empty?(n.style.display="none",n):(Ql(s,n,i),n)}function er(e,t){return t===void 0?Array.from(e.querySelectorAll(".yagr-point")):[e.querySelector(`.yagr-point[data-idx="${t}"]`)]}function Ra(e,t){const i=e.config.processing||{},n=!!i.interpolation,r=i.interpolation?.value,o=t.snapToValues===!1?!1:t.snapToValues||"closest",u=n?i.interpolation?.snapToValues??"closest":!1;let c={};const f=(p,m,h)=>{const b=p.series[m];if(b.scale===Ae)return h;const _=b.$c||p.data[m],y=_[h];return n&&y===r?fi(_,b,h,u,r):y===null?fi(_,b,h,o,null):h};return{showPoints:p=>{const m=e.uplot.over;if(!m)return;er(m,p).forEach(b=>{b.style.visibility="visible"})},hidePoints:p=>{const m=e.uplot.over;if(!m)return;er(m,p).forEach(b=>{b.style.visibility="hidden"})},pin:p=>{const m=e.root.querySelector(".u-over");if(m)if(p){const h=document.createElement("div");h.classList.add("yagr-points-holder"),m.querySelectorAll(".yagr-point").forEach(b=>{const _=b.cloneNode(!0);h.appendChild(_);const y=_.dataset.idx;y&&(c[y]=_)}),m.appendChild(h)}else c={},m.querySelector(".yagr-points-holder")?.remove()},updatePoints:()=>{e.root.querySelectorAll(".yagr-point").forEach(p=>{const m=Number(p.dataset.idx);if(isNaN(m))return;const h=e.uplot.series[m];Ql(h,p)})},focus:(p,m)=>{Object.entries(c).forEach(([h,b])=>{if(p===null){b.style.display=m?"block":"none";return}b.style.display=h===String(p)&&m?"block":"none"})},uplot:{opts:(p,m)=>{m.cursor=m.cursor||{};const h=m.series.filter(y=>y.empty).length,b=m.series.length-1,_=t?.maxMarkers??Oa;m.cursor.points={show:b-h<=_?Ma:!1,size:(y,A)=>{const I=y.series[A];return(I.cursorOptions?I.cursorOptions.markersSize:t?.markersSize)||Ul}},m.cursor.dataIdx=f},hooks:{...t.hideMarkers&&{setCursor:p=>{const m=p.cursor.idx;if(!jt(m))for(let h=1;h<p.series.length;h++){const b=p.series[h].$c[m];t.hideMarkers(b,h)?e.plugins.cursor?.hidePoints(h):e.plugins.cursor?.showPoints(h)}}},init:p=>{const m=p.root.querySelector(".u-cursor-x");m&&(t.x&&t.x.visible===!1&&(m.style.display="none"),m.style.borderRight=t.x&&t.x.style||ln);const h=p.root.querySelector(".u-cursor-y");h&&(t.y&&t.y.visible!==!1?h.style.borderBottom=t.y.style||ln:h.style.display="none")}}}}}var tr=e=>e.preventDefault(),Gs="null",Pa=18,Fa=20,Ca=48,Na=12,za=.3,rn=e=>e.some(({show:t,id:s})=>s!==Ji&&t),sr=(e,t)=>t.length>3&&e(rn(t)?"hide-all":"show-all"),Va=e=>e.length>3&&Gs||void 0,ir=class{constructor(){this.pagesCount=0,this.state={page:0,pages:1,pageSize:0,rowsPerPage:1,paginated:!1,requiredSpace:0,totalSpace:0},this.itemsHtml="",this.preInit=(e,t,s)=>{this.yagr=e,this.options=Object.assign({show:!1,position:"bottom",fontSize:Na,maxLegendSpace:za,className:void 0,behaviour:"basic"},t||{}),this.calc(s)},this.init=e=>{this.options.show&&(this.uplot=e,e.root.querySelector(".u-legend")?.remove(),this.render())},this.update=()=>{this.yagr.root.querySelectorAll("[data-serie-id]").forEach(t=>{const s=t.getAttribute("data-serie-id");if(!s||s===Gs)return;const i=this.uplot?.series[this.yagr.state.y2uIdx[s]]?.show;t.classList[i?"remove":"add"]("yagr-legend__item_hidden")})},this.measureLegend=e=>{const t=this.yagr.root,s=Yt("div",{class:"yagr-legend",style:{visibility:"hidden"}},e);t.appendChild(s);const n=s.childNodes[0].getBoundingClientRect();return s.remove(),n},this.nextPage=()=>{const{state:e}=this;this.state.page+=1,this.items&&(this.items.style.transform=`translate(0, ${-1*e.page*e.pageSize}px)`,this.renderPagination())},this.prevPage=()=>{const{state:e}=this;this.state.page-=1,this.items&&(this.items.style.transform=`translate(0, ${-1*e.page*e.pageSize}px)`,this.renderPagination())}}redraw(){this.options.show&&this.render()}destroy(){this._onDestroy&&this._onDestroy(),this.legendEl?.remove()}applyHandlers(){const{yagr:e,uplot:t}=this;if(!t)return()=>{};const s=e.root.querySelectorAll("[data-serie-id]"),i=[],o={basic:p=>()=>{const m=p.getAttribute("data-serie-id"),h=[];if(m===Gs){const _=!rn(t.series);for(let y=1;y<t.series.length;y++)h.push([t.series[y],_])}else{const _=t.series.find(({id:y})=>y===m);if(!_)return;h.push([_,!_.show])}h.forEach(([_,y])=>{if(_.show===y)return;const A=e.root.querySelector(`[data-serie-id="${_.id}"]`);e.setVisible(_.id,y,!1),A?.classList[y?"remove":"add"]("yagr-legend__item_hidden")});const b=e.root.querySelector(".yagr-legend__all-series");if(b){const _=sr(this.yagr.utils.i18n,t.series);b.innerHTML=_||""}},extended:p=>{const m=(y,A)=>{const I=e.root.querySelector(`[data-serie-id="${y}"]`);e.setVisible(y,A,!1),I?.classList[A?"remove":"add"]("yagr-legend__item_hidden")},h=y=>{m(y.id,!y.show)},b=y=>{this.state.startSerieRange=y;const A=t.series.filter(O=>O.id!==y.id),I=!rn(A)&&y.show!==!1;t.series.forEach(O=>{const w=y.id===O.id?!0:I;m(O.id,w)})},_=y=>{this.state.startSerieRange||(this.state.startSerieRange=t.series[1]);const A=[];t.series.forEach((I,O)=>{I.id===y.id&&A.push(O),I.id===this.state.startSerieRange?.id&&A.push(O)}),t.series.forEach((I,O)=>{const w=O>=A[0]&&O<=A[1];m(I.id,w)})};return y=>{const A=p.getAttribute("data-serie-id"),I=t.series.find(({id:O})=>O===A);I&&(y.preventDefault(),y.ctrlKey||y.metaKey?h(I):y.shiftKey?_(I):b(I))}}},u=p=>()=>{const m=p.getAttribute("data-serie-id");if(p.classList.contains("yagr-legend__item_hidden")||m===Gs)return;const h=this.yagr.uplot.series.find(({id:b})=>b===m);h&&e.setFocus(h.id,!0)},c=()=>{e.setFocus(null,!0)};s.forEach(p=>{const m=o[this.options.behaviour||"basic"](p),h=u(p);p.addEventListener("click",m),p.addEventListener("mouseenter",h),p.addEventListener("mouseleave",c),p.addEventListener("mousedown",tr),i.push(()=>{p.removeEventListener("click",m),p.removeEventListener("mouseenter",h),p.removeEventListener("mouseleave",c),p.removeEventListener("mousedown",tr)})});const f=()=>i.forEach(p=>p());return this._onDestroy=f,f}render(){let e=!1;const{uplot:t,options:s}=this;if(!t)return;let i=this.yagr.root.querySelector(".yagr-legend");if(i?e=!0:i=Yt("div",{class:`yagr-legend yagr-legend__${this.options.position} ${s?.className||""}`}),!!i){if(e||(s.position==="top"?t.root.before(i):t.root?.after(i)),this.legendEl=i,(!this.itemsHtml||e)&&this.calc(this.yagr.options),i.innerHTML=`<div class="yagr-legend__container" style="height: ${this.state.requiredSpace}px">${this.itemsHtml}</div>`,this.items=i.querySelector(".yagr-legend__items"),this.container=i.querySelector(".yagr-legend__container"),this.state.paginated){const n=this.renderPagination();this.container?.after(n)}else this.items.style.justifyContent="center";this.applyHandlers()}}renderPagination(){const{state:e}=this;let t=this.yagr.root.querySelector(".yagr-legend__pagination");if(t){const o=t.querySelector(".yagr-legend__icon-down"),u=t.querySelector(".yagr-legend__icon-up");o.removeEventListener("click",this.nextPage),u.removeEventListener("click",this.prevPage)}else t=Yt("div",{class:"yagr-legend__pagination"});const s=e.page===0?"yagr-legend__icon-up_disabled":"",i=e.page===e.pages-1?"yagr-legend__icon-down_disabled":"";t.innerHTML=`<span class="yagr-legend__icon-up ${s}"></span>
<span class="yagr-legend__pagination-text">${e.page+1}/${e.pages}</span>
<span class="yagr-legend__icon-down ${i}"></span>`;const n=t.querySelector(".yagr-legend__icon-down"),r=t.querySelector(".yagr-legend__icon-up");return i||n.addEventListener("click",this.nextPage),s||r.addEventListener("click",this.prevPage),t}createIconLineElement(e){return Yt("span",{class:`yagr-legend__icon yagr-legend__icon_${e.type}`,style:{"background-color":e.color}})}createSerieNameElement(e){const t=Yt("span");return t.innerText=e.name||"unnamed",t}renderItems(e){const t=sr(this.yagr.utils.i18n,e.series),s=this.options.behaviour!=="extended"&&Va(e.series),i=s?[s]:[];for(let r=1;r<e.series.length;r++)i.push(e.series[r]);return`<div class="yagr-legend__items">${i.map(r=>{let o,u,c=" ";if(r===Gs)o=t,u=s,c=" yagr-legend__all-series ";else{u=r.id;const p=this.createIconLineElement(r),m=this.createSerieNameElement(r);o=`${p.outerHTML}${m.outerHTML}`}const f=typeof r=="string"?!0:r.show!==!1;return`<div class="yagr-legend__item${c}${f?"":"yagr-legend__item_hidden"}" data-serie-id="${u}">${o}</div>`}).join("")}</div>`}calc(e){if(!this.options.show)return;const t=e.height-this.VERTICAL_PADDING,s=this.renderItems(e),{height:i}=this.measureLegend(s),n=this.options.fontSize+2,r=t*this.options.maxLegendSpace,o=Math.floor(r/n),u=o-1,c=Math.min(u*n,r),f=Math.min(o*n,r),p=i>c&&c>0,m=Math.min(p?f:c,i),h=Math.ceil(i/c),b=p?this.VERTICAL_PADDING+Pa:this.VERTICAL_PADDING;this.state.requiredSpace=m,this.state.totalSpace=m+b,this.state.paginated=p,this.state.page=this.state.page||0,this.state.pages=h,this.state.pageSize=c,this.state.rowsPerPage=o,this.itemsHtml=s}get VERTICAL_PADDING(){return this.options.position==="bottom"?Fa:Ca}},Ha=!0,Le="u-",Ua="uplot",Ba=Le+"hz",Ga=Le+"vt",$a=Le+"title",Wa=Le+"wrap",Ya=Le+"under",ja=Le+"over",Xa=Le+"axis",Xt=Le+"off",Ka=Le+"select",qa=Le+"cursor-x",Za=Le+"cursor-y",Ja=Le+"cursor-pt",Qa=Le+"legend",ec=Le+"live",tc=Le+"inline",sc=Le+"series",ic=Le+"marker",nr=Le+"label",nc=Le+"value",$s="width",Ws="height",Ys="top",lr="bottom",cs="left",on="right",an="#000",rr=an+"0",or="mousemove",ar="mousedown",cn="mouseup",cr="mouseenter",ur="mouseleave",fr="dblclick",lc="resize",rc="scroll",hr="change",hi="dppxchange",un="--",us=typeof window<"u",fn=us?document:null,fs=us?window:null,oc=us?navigator:null,le,pi;function hn(){let e=devicePixelRatio;le!=e&&(le=e,pi&&gn(hr,pi,hn),pi=matchMedia(`(min-resolution: ${le-.001}dppx) and (max-resolution: ${le+.001}dppx)`),Kt(hr,pi,hn),fs.dispatchEvent(new CustomEvent(hi)))}function qe(e,t){if(t!=null){let s=e.classList;!s.contains(t)&&s.add(t)}}function pn(e,t){let s=e.classList;s.contains(t)&&s.remove(t)}function ve(e,t,s){e.style[t]=s+"px"}function ut(e,t,s,i){let n=fn.createElement(e);return t!=null&&qe(n,t),s?.insertBefore(n,i),n}function st(e,t){return ut("div",e,t)}var pr=new WeakMap;function hs(e,t,s,i,n){let r="translate("+t+"px,"+s+"px)",o=pr.get(e);r!=o&&(e.style.transform=r,pr.set(e,r),t<0||s<0||t>i||s>n?qe(e,Xt):pn(e,Xt))}var dr=new WeakMap;function ac(e,t,s){let i=t+s,n=dr.get(e);i!=n&&(dr.set(e,i),e.style.background=t,e.style.borderColor=s)}var gr=new WeakMap;function cc(e,t,s,i){let n=t+""+s,r=gr.get(e);n!=r&&(gr.set(e,n),e.style.height=s+"px",e.style.width=t+"px",e.style.marginLeft=i?-t/2+"px":0,e.style.marginTop=i?-s/2+"px":0)}var dn={passive:!0},mr={...dn,capture:!0};function Kt(e,t,s,i){t.addEventListener(e,s,i?mr:dn)}function gn(e,t,s,i){t.removeEventListener(e,s,i?mr:dn)}us&&hn();function Ft(e,t,s,i){let n;s=s||0,i=i||t.length-1;let r=i<=2147483647;for(;i-s>1;)n=r?s+i>>1:Je((s+i)/2),t[n]<e?s=n:i=n;return e-t[s]<=t[i]-e?s:i}function ps(e,t,s,i){for(let n=i==1?t:s;n>=t&&n<=s;n+=i)if(e[n]!=null)return n;return-1}function uc(e,t,s,i){let n=Z,r=-Z;if(i==1)n=e[t],r=e[s];else if(i==-1)n=e[s],r=e[t];else for(let o=t;o<=s;o++){let u=e[o];u!=null&&(u<n&&(n=u),u>r&&(r=u))}return[n,r]}function fc(e,t,s){let i=Z,n=-Z;for(let r=t;r<=s;r++){let o=e[r];o!=null&&o>0&&(o<i&&(i=o),o>n&&(n=o))}return[i==Z?1:i,n==-Z?10:n]}function di(e,t,s,i){let n=Sr(e),r=Sr(t),o=s==10?At:yr;e==t&&(n==-1?(e*=s,t/=s):(e/=s,t*=s));let u=n==1?Je:ds,c=r==1?ds:Je,f=u(o(Re(e))),p=c(o(Re(t))),m=gs(s,f),h=gs(s,p);return s==10&&(f<0&&(m=fe(m,-f)),p<0&&(h=fe(h,-p))),i||s==2?(e=m*n,t=h*r):(e=Lr(e,m),t=vs(t,h)),[e,t]}function mn(e,t,s,i){let n=di(e,t,s,i);return e==0&&(n[0]=0),t==0&&(n[1]=0),n}var vn=.1,vr={mode:3,pad:vn},js={pad:0,soft:null,mode:0},hc={min:js,max:js};function gi(e,t,s,i){return _i(s)?_r(e,t,s):(js.pad=s,js.soft=i?0:null,js.mode=i?3:0,_r(e,t,hc))}function re(e,t){return e??t}function pc(e,t,s){for(t=re(t,0),s=re(s,e.length-1);t<=s;){if(e[t]!=null)return!0;t++}return!1}function _r(e,t,s){let i=s.min,n=s.max,r=re(i.pad,0),o=re(n.pad,0),u=re(i.hard,-Z),c=re(n.hard,Z),f=re(i.soft,Z),p=re(n.soft,-Z),m=re(i.mode,0),h=re(n.mode,0),b=t-e,_=At(b),y=Ue(Re(e),Re(t)),A=At(y),I=Re(A-_);(b<1e-9||I>10)&&(b=0,(e==0||t==0)&&(b=1e-9,m==2&&f!=Z&&(r=0),h==2&&p!=-Z&&(o=0)));let O=b||y||1e3,w=At(O),x=gs(10,Je(w)),E=O*(b==0?e==0?.1:1:r),F=fe(Lr(e-E,x/10),9),R=e>=f&&(m==1||m==3&&F<=f||m==2&&F>=f)?f:Z,U=Ue(u,F<R&&e>=R?R:it(R,F)),N=O*(b==0?t==0?.1:1:o),P=fe(vs(t+N,x/10),9),L=t<=p&&(h==1||h==3&&P>=p||h==2&&P<=p)?p:-Z,H=it(c,P>L&&t<=L?L:Ue(L,P));return U==H&&U==0&&(H=100),[U,H]}var dc=new Intl.NumberFormat(us?oc.language:"en-US"),_n=e=>dc.format(e),Ze=Math,mi=Ze.PI,Re=Ze.abs,Je=Ze.floor,He=Ze.round,ds=Ze.ceil,it=Ze.min,Ue=Ze.max,gs=Ze.pow,Sr=Ze.sign,At=Ze.log10,yr=Ze.log2,gc=(e,t=1)=>Ze.sinh(e)*t,Sn=(e,t=1)=>Ze.asinh(e/t),Z=1/0;function wr(e){return(At((e^e>>31)-(e>>31))|0)+1}function vi(e,t,s){return it(Ue(e,t),s)}function J(e){return typeof e=="function"?e:()=>e}var mc=()=>{},br=e=>e,Er=(e,t)=>t,vc=e=>null,Tr=e=>!0,Ar=(e,t)=>e==t,ms=e=>fe(e,14);function qt(e,t){return ms(fe(ms(e/t))*t)}function vs(e,t){return ms(ds(ms(e/t))*t)}function Lr(e,t){return ms(Je(ms(e/t))*t)}function fe(e,t=0){if(_c(e))return e;let s=10**t,i=e*s*(1+Number.EPSILON);return He(i)/s}var _s=new Map;function Ir(e){return((""+e).split(".")[1]||"").length}function Xs(e,t,s,i){let n=[],r=i.map(Ir);for(let o=t;o<s;o++){let u=Re(o),c=fe(gs(e,o),u);for(let f=0;f<i.length;f++){let p=i[f]*c,m=(p>=0&&o>=0?0:u)+(o>=r[f]?0:r[f]),h=fe(p,m);n.push(h),_s.set(h,m)}}return n}var Ks={},kr=[],Ss=[null,null],Ct=Array.isArray,_c=Number.isInteger,Sc=e=>e===void 0;function xr(e){return typeof e=="string"}function _i(e){let t=!1;if(e!=null){let s=e.constructor;t=s==null||s==Object}return t}function Dr(e){return e!=null&&typeof e=="object"}var yc=Object.getPrototypeOf(Uint8Array);function Zt(e,t=_i){let s;if(Ct(e)){let i=e.find(n=>n!=null);if(Ct(i)||t(i)){s=Array(e.length);for(let n=0;n<e.length;n++)s[n]=Zt(e[n],t)}else s=e.slice()}else if(e instanceof yc)s=e.slice();else if(t(e)){s={};for(let i in e)s[i]=Zt(e[i],t)}else s=e;return s}function Ee(e){let t=arguments;for(let s=1;s<t.length;s++){let i=t[s];for(let n in i)_i(e[n])?Ee(e[n],Zt(i[n])):e[n]=Zt(i[n])}return e}var wc=0,bc=1,Ec=2;function Tc(e,t,s){for(let i=0,n,r=-1;i<t.length;i++){let o=t[i];if(o>r){for(n=o-1;n>=0&&e[n]==null;)e[n--]=null;for(n=o+1;n<s&&e[n]==null;)e[r=n++]=null}}}function Ac(e,t){if(kc(e)){let o=e[0].slice();for(let u=1;u<e.length;u++)o.push(...e[u].slice(1));return xc(o[0])||(o=Ic(o)),o}let s=new Set;for(let o=0;o<e.length;o++){let c=e[o][0],f=c.length;for(let p=0;p<f;p++)s.add(c[p])}let i=[Array.from(s).sort((o,u)=>o-u)],n=i[0].length,r=new Map;for(let o=0;o<n;o++)r.set(i[0][o],o);for(let o=0;o<e.length;o++){let u=e[o],c=u[0];for(let f=1;f<u.length;f++){let p=u[f],m=Array(n).fill(void 0),h=t?t[o][f]:bc,b=[];for(let _=0;_<p.length;_++){let y=p[_],A=r.get(c[_]);y===null?h!=wc&&(m[A]=y,h==Ec&&b.push(A)):m[A]=y}Tc(m,b,n),i.push(m)}}return i}var Lc=typeof queueMicrotask>"u"?e=>Promise.resolve().then(e):queueMicrotask;function Ic(e){let t=e[0],s=t.length,i=Array(s);for(let r=0;r<i.length;r++)i[r]=r;i.sort((r,o)=>t[r]-t[o]);let n=[];for(let r=0;r<e.length;r++){let o=e[r],u=Array(s);for(let c=0;c<s;c++)u[c]=o[i[c]];n.push(u)}return n}function kc(e){let t=e[0][0],s=t.length;for(let i=1;i<e.length;i++){let n=e[i][0];if(n.length!=s)return!1;if(n!=t){for(let r=0;r<s;r++)if(n[r]!=t[r])return!1}}return!0}function xc(e,t=100){const s=e.length;if(s<=1)return!0;let i=0,n=s-1;for(;i<=n&&e[i]==null;)i++;for(;n>=i&&e[n]==null;)n--;if(n<=i)return!0;const r=Ue(1,Je((n-i+1)/t));for(let o=e[i],u=i+r;u<=n;u+=r){const c=e[u];if(c!=null){if(c<=o)return!1;o=c}}return!0}var Or=["January","February","March","April","May","June","July","August","September","October","November","December"],Mr=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Rr(e){return e.slice(0,3)}var Dc=Mr.map(Rr),Oc=Or.map(Rr),Mc={MMMM:Or,MMM:Oc,WWWW:Mr,WWW:Dc};function qs(e){return(e<10?"0":"")+e}function Rc(e){return(e<10?"00":e<100?"0":"")+e}var Pc={YYYY:e=>e.getFullYear(),YY:e=>(e.getFullYear()+"").slice(2),MMMM:(e,t)=>t.MMMM[e.getMonth()],MMM:(e,t)=>t.MMM[e.getMonth()],MM:e=>qs(e.getMonth()+1),M:e=>e.getMonth()+1,DD:e=>qs(e.getDate()),D:e=>e.getDate(),WWWW:(e,t)=>t.WWWW[e.getDay()],WWW:(e,t)=>t.WWW[e.getDay()],HH:e=>qs(e.getHours()),H:e=>e.getHours(),h:e=>{let t=e.getHours();return t==0?12:t>12?t-12:t},AA:e=>e.getHours()>=12?"PM":"AM",aa:e=>e.getHours()>=12?"pm":"am",a:e=>e.getHours()>=12?"p":"a",mm:e=>qs(e.getMinutes()),m:e=>e.getMinutes(),ss:e=>qs(e.getSeconds()),s:e=>e.getSeconds(),fff:e=>Rc(e.getMilliseconds())};function yn(e,t){t=t||Mc;let s=[],i=/\{([a-z]+)\}|[^{]+/gi,n;for(;n=i.exec(e);)s.push(n[0][0]=="{"?Pc[n[1]]:n[0]);return r=>{let o="";for(let u=0;u<s.length;u++)o+=typeof s[u]=="string"?s[u]:s[u](r,t);return o}}var Fc=new Intl.DateTimeFormat().resolvedOptions().timeZone;function Cc(e,t){let s;return t=="UTC"||t=="Etc/UTC"?s=new Date(+e+e.getTimezoneOffset()*6e4):t==Fc?s=e:(s=new Date(e.toLocaleString("en-US",{timeZone:t})),s.setMilliseconds(e.getMilliseconds())),s}var Pr=e=>e%1==0,Si=[1,2,2.5,5],Nc=Xs(10,-16,0,Si),Fr=Xs(10,0,16,Si),zc=Fr.filter(Pr),Vc=Nc.concat(Fr),wn=`
`,Cr="{YYYY}",Nr=wn+Cr,zr="{M}/{D}",Zs=wn+zr,yi=Zs+"/{YY}",Vr="{aa}",Hc="{h}:{mm}",ys=Hc+Vr,Hr=wn+ys,Ur=":{ss}",ce=null;function Br(e){let t=e*1e3,s=t*60,i=s*60,n=i*24,r=n*30,o=n*365,c=(e==1?Xs(10,0,3,Si).filter(Pr):Xs(10,-3,0,Si)).concat([t,t*5,t*10,t*15,t*30,s,s*5,s*10,s*15,s*30,i,i*2,i*3,i*4,i*6,i*8,i*12,n,n*2,n*3,n*4,n*5,n*6,n*7,n*8,n*9,n*10,n*15,r,r*2,r*3,r*4,r*6,o,o*2,o*5,o*10,o*25,o*50,o*100]);const f=[[o,Cr,ce,ce,ce,ce,ce,ce,1],[n*28,"{MMM}",Nr,ce,ce,ce,ce,ce,1],[n,zr,Nr,ce,ce,ce,ce,ce,1],[i,"{h}"+Vr,yi,ce,Zs,ce,ce,ce,1],[s,ys,yi,ce,Zs,ce,ce,ce,1],[t,Ur,yi+" "+ys,ce,Zs+" "+ys,ce,Hr,ce,1],[e,Ur+".{fff}",yi+" "+ys,ce,Zs+" "+ys,ce,Hr,ce,1]];function p(m){return(h,b,_,y,A,I)=>{let O=[],w=A>=o,x=A>=r&&A<o,E=m(_),F=fe(E*e,3),R=bn(E.getFullYear(),w?0:E.getMonth(),x||w?1:E.getDate()),U=fe(R*e,3);if(x||w){let N=x?A/r:0,P=w?A/o:0,L=F==U?F:fe(bn(R.getFullYear()+P,R.getMonth()+N,1)*e,3),H=new Date(He(L/e)),X=H.getFullYear(),K=H.getMonth();for(let Y=0;L<=y;Y++){let oe=bn(X+P*Y,K+N*Y,1),W=oe-m(fe(oe*e,3));L=fe((+oe+W)*e,3),L<=y&&O.push(L)}}else{let N=A>=n?n:A,P=Je(_)-Je(F),L=U+P+vs(F-U,N);O.push(L);let H=m(L),X=H.getHours()+H.getMinutes()/s+H.getSeconds()/i,K=A/i,Y=h.axes[b]._space,oe=I/Y;for(;L=fe(L+A,e==1?0:3),!(L>y);)if(K>1){let W=Je(fe(X+K,6))%24,Q=m(L).getHours()-W;Q>1&&(Q=-1),L-=Q*i,X=(X+K)%24;let ae=O[O.length-1];fe((L-ae)/A,3)*oe>=.7&&O.push(L)}else O.push(L)}return O}}return[c,f,p]}var[Uc,Bc,Gc]=Br(1),[$c,Wc,Yc]=Br(.001);Xs(2,-53,53,[1]);function Gr(e,t){return e.map(s=>s.map((i,n)=>n==0||n==8||i==null?i:t(n==1||s[8]==0?i:s[1]+i)))}function $r(e,t){return(s,i,n,r,o)=>{let u=t.find(_=>o>=_[0])||t[t.length-1],c,f,p,m,h,b;return i.map(_=>{let y=e(_),A=y.getFullYear(),I=y.getMonth(),O=y.getDate(),w=y.getHours(),x=y.getMinutes(),E=y.getSeconds(),F=A!=c&&u[2]||I!=f&&u[3]||O!=p&&u[4]||w!=m&&u[5]||x!=h&&u[6]||E!=b&&u[7]||u[1];return c=A,f=I,p=O,m=w,h=x,b=E,F(y)})}}function jc(e,t){let s=yn(t);return(i,n,r,o,u)=>n.map(c=>s(e(c)))}function bn(e,t,s){return new Date(e,t,s)}function Wr(e,t){return t(e)}var Xc="{YYYY}-{MM}-{DD} {h}:{mm}{aa}";function Yr(e,t){return(s,i,n,r)=>r==null?un:t(e(i))}function Kc(e,t){let s=e.series[t];return s.width?s.stroke(e,t):s.points.width?s.points.stroke(e,t):null}function qc(e,t){return e.series[t].fill(e,t)}var Zc={show:!0,live:!0,isolate:!1,mount:mc,markers:{show:!0,width:2,stroke:Kc,fill:qc,dash:"solid"},idx:null,idxs:null,values:[]};function Jc(e,t){let s=e.cursor.points,i=st(),n=s.size(e,t);ve(i,$s,n),ve(i,Ws,n);let r=n/-2;ve(i,"marginLeft",r),ve(i,"marginTop",r);let o=s.width(e,t,n);return o&&ve(i,"borderWidth",o),i}function Qc(e,t){let s=e.series[t].points;return s._fill||s._stroke}function eu(e,t){let s=e.series[t].points;return s._stroke||s._fill}function tu(e,t){return e.series[t].points.size}function su(e,t,s){return s}var En=[0,0];function iu(e,t,s){return En[0]=t,En[1]=s,En}function wi(e,t,s,i=!0){return n=>{n.button==0&&(!i||n.target==t)&&s(n)}}function Tn(e,t,s,i=!0){return n=>{(!i||n.target==t)&&s(n)}}var nu={show:!0,x:!0,y:!0,lock:!1,move:iu,points:{show:Jc,size:tu,width:0,stroke:eu,fill:Qc},bind:{mousedown:wi,mouseup:wi,click:wi,dblclick:wi,mousemove:Tn,mouseleave:Tn,mouseenter:Tn},drag:{setScale:!0,x:!0,y:!1,dist:0,uni:null,click:(e,t)=>{t.stopPropagation(),t.stopImmediatePropagation()},_x:!1,_y:!1},focus:{prox:-1,bias:0},left:-10,top:-10,idx:null,dataIdx:su,idxs:null,event:null},jr={show:!0,stroke:"rgba(0,0,0,0.07)",width:2},An=Ee({},jr,{filter:Er}),Xr=Ee({},An,{size:10}),Kr=Ee({},jr,{show:!1}),Ln='12px system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',qr="bold "+Ln,Zr=1.5,Jr={show:!0,scale:"x",stroke:an,space:50,gap:5,size:50,labelGap:0,labelSize:30,labelFont:qr,side:2,grid:An,ticks:Xr,border:Kr,font:Ln,lineGap:Zr,rotate:0},lu="Value",ru="Time",Qr={show:!0,scale:"x",auto:!1,sorted:1,min:Z,max:-Z,idxs:[]};function ou(e,t,s,i,n){return t.map(r=>r==null?"":_n(r))}function au(e,t,s,i,n,r,o){let u=[],c=_s.get(n)||0;s=o?s:fe(vs(s,n),c);for(let f=s;f<=i;f=fe(f+n,c))u.push(Object.is(f,-0)?0:f);return u}function In(e,t,s,i,n,r,o){const u=[],c=e.scales[e.axes[t].scale].log,f=c==10?At:yr,p=Je(f(s));n=gs(c,p),c==10&&p<0&&(n=fe(n,-p));let m=s;do u.push(m),m=m+n,c==10&&(m=fe(m,_s.get(n))),m>=n*c&&(n=m);while(m<=i);return u}function cu(e,t,s,i,n,r,o){let c=e.scales[e.axes[t].scale].asinh,f=i>c?In(e,t,Ue(c,s),i,n):[c],p=i>=0&&s<=0?[0]:[];return(s<-c?In(e,t,Ue(c,-i),-s,n):[c]).reverse().map(h=>-h).concat(p,f)}var eo=/./,uu=/[12357]/,fu=/[125]/,to=/1/,kn=(e,t,s,i)=>e.map((n,r)=>t==4&&n==0||r%i==0&&s.test(n.toExponential()[n<0?1:0])?n:null);function hu(e,t,s,i,n){let r=e.axes[s],o=r.scale,u=e.scales[o],c=e.valToPos,f=r._space,p=c(10,o),m=c(9,o)-p>=f?eo:c(7,o)-p>=f?uu:c(5,o)-p>=f?fu:to;if(m==to){let h=Re(c(1,o)-p);if(h<f)return kn(t.slice().reverse(),u.distr,m,ds(f/h)).reverse()}return kn(t,u.distr,m,1)}function pu(e,t,s,i,n){let r=e.axes[s],o=r.scale,u=r._space,c=e.valToPos,f=Re(c(1,o)-c(2,o));return f<u?kn(t.slice().reverse(),3,eo,ds(u/f)).reverse():t}function du(e,t,s,i){return i==null?un:t==null?"":_n(t)}var so={show:!0,scale:"y",stroke:an,space:30,gap:5,size:50,labelGap:0,labelSize:30,labelFont:qr,side:3,grid:An,ticks:Xr,border:Kr,font:Ln,lineGap:Zr,rotate:0};function gu(e,t){let s=3+(e||1)*2;return fe(s*t,3)}function mu(e,t){let{scale:s,idxs:i}=e.series[0],n=e._data[0],r=e.valToPos(n[i[0]],s,!0),o=e.valToPos(n[i[1]],s,!0),u=Re(o-r),c=e.series[t],f=u/(c.points.space*le);return i[1]-i[0]<=f}var io={scale:null,auto:!0,sorted:0,min:Z,max:-Z},no=(e,t,s,i,n)=>n,lo={show:!0,auto:!0,sorted:0,gaps:no,alpha:1,facets:[Ee({},io,{scale:"x"}),Ee({},io,{scale:"y"})]},ro={scale:"y",auto:!0,sorted:0,show:!0,spanGaps:!1,gaps:no,alpha:1,points:{show:mu,filter:null},values:null,min:Z,max:-Z,idxs:[],path:null,clip:null};function vu(e,t,s,i,n){return s/10}var oo={time:Ha,auto:!0,distr:1,log:10,asinh:1,min:null,max:null,dir:1,ori:0},_u=Ee({},oo,{time:!1,ori:1}),ao={};function co(e,t){let s=ao[e];return s||(s={key:e,plots:[],sub(i){s.plots.push(i)},unsub(i){s.plots=s.plots.filter(n=>n!=i)},pub(i,n,r,o,u,c,f){for(let p=0;p<s.plots.length;p++)s.plots[p]!=n&&s.plots[p].pub(i,n,r,o,u,c,f)}},e!=null&&(ao[e]=s)),s}var Jt=1,bi=2;function Qt(e,t,s){const i=e.mode,n=e.series[t],r=i==2?e._data[t]:e._data,o=e.scales,u=e.bbox;let c=r[0],f=i==2?r[1]:r[t],p=i==2?o[n.facets[0].scale]:o[e.series[0].scale],m=i==2?o[n.facets[1].scale]:o[n.scale],h=u.left,b=u.top,_=u.width,y=u.height,A=e.valToPosH,I=e.valToPosV;return p.ori==0?s(n,c,f,p,m,A,I,h,b,_,y,Ai,ws,Ii,ho,go):s(n,c,f,p,m,I,A,b,h,y,_,Li,bs,Dn,po,mo)}function Ei(e,t){let s=0,i=0,n=re(e.bands,kr);for(let r=0;r<n.length;r++){let o=n[r];o.series[0]==t?s=o.dir:o.series[1]==t&&(o.dir==1?i|=1:i|=2)}return[s,i==1?-1:i==2?1:i==3?2:0]}function Su(e,t,s,i,n){let r=e.mode,o=e.series[t],u=r==2?o.facets[1].scale:o.scale,c=e.scales[u];return n==-1?c.min:n==1?c.max:c.distr==3?c.dir==1?c.min:c.max:0}function Lt(e,t,s,i,n,r){return Qt(e,t,(o,u,c,f,p,m,h,b,_,y,A)=>{let I=o.pxRound;const O=f.dir*(f.ori==0?1:-1),w=f.ori==0?ws:bs;let x,E;O==1?(x=s,E=i):(x=i,E=s);let F=I(m(u[x],f,y,b)),R=I(h(c[x],p,A,_)),U=I(m(u[E],f,y,b)),N=I(h(r==1?p.max:p.min,p,A,_)),P=new Path2D(n);return w(P,U,N),w(P,F,N),w(P,F,R),P})}function Ti(e,t,s,i,n,r){let o=null;if(e.length>0){o=new Path2D;const u=t==0?Ii:Dn;let c=s;for(let m=0;m<e.length;m++){let h=e[m];if(h[1]>h[0]){let b=h[0]-c;b>0&&u(o,c,i,b,i+r),c=h[1]}}let f=s+n-c,p=10;f>0&&u(o,c,i-p/2,f,i+r+p)}return o}function yu(e,t,s){let i=e[e.length-1];i&&i[0]==t?i[1]=s:e.push([t,s])}function xn(e,t,s,i,n,r,o){let u=[],c=e.length;for(let f=n==1?s:i;f>=s&&f<=i;f+=n)if(t[f]===null){let m=f,h=f;if(n==1)for(;++f<=i&&t[f]===null;)h=f;else for(;--f>=s&&t[f]===null;)h=f;let b=r(e[m]),_=h==m?b:r(e[h]),y=m-n;b=o<=0&&y>=0&&y<c?r(e[y]):b;let I=h+n;_=o>=0&&I>=0&&I<c?r(e[I]):_,_>=b&&u.push([b,_])}return u}function uo(e){return e==0?br:e==1?He:t=>qt(t,e)}function fo(e){let t=e==0?Ai:Li,s=e==0?(n,r,o,u,c,f)=>{n.arcTo(r,o,u,c,f)}:(n,r,o,u,c,f)=>{n.arcTo(o,r,c,u,f)},i=e==0?(n,r,o,u,c)=>{n.rect(r,o,u,c)}:(n,r,o,u,c)=>{n.rect(o,r,c,u)};return(n,r,o,u,c,f=0,p=0)=>{f==0&&p==0?i(n,r,o,u,c):(f=it(f,u/2,c/2),p=it(p,u/2,c/2),t(n,r+f,o),s(n,r+u,o,r+u,o+c,f),s(n,r+u,o+c,r,o+c,p),s(n,r,o+c,r,o,p),s(n,r,o,r+u,o,f),n.closePath())}}var Ai=(e,t,s)=>{e.moveTo(t,s)},Li=(e,t,s)=>{e.moveTo(s,t)},ws=(e,t,s)=>{e.lineTo(t,s)},bs=(e,t,s)=>{e.lineTo(s,t)},Ii=fo(0),Dn=fo(1),ho=(e,t,s,i,n,r)=>{e.arc(t,s,i,n,r)},po=(e,t,s,i,n,r)=>{e.arc(s,t,i,n,r)},go=(e,t,s,i,n,r,o)=>{e.bezierCurveTo(t,s,i,n,r,o)},mo=(e,t,s,i,n,r,o)=>{e.bezierCurveTo(s,t,n,i,o,r)};function vo(e){return(t,s,i,n,r)=>Qt(t,s,(o,u,c,f,p,m,h,b,_,y,A)=>{let{pxRound:I,points:O}=o,w,x;f.ori==0?(w=Ai,x=ho):(w=Li,x=po);const E=fe(O.width*le,3);let F=(O.size-O.width)/2*le,R=fe(F*2,3),U=new Path2D,N=new Path2D,{left:P,top:L,width:H,height:X}=t.bbox;Ii(N,P-R,L-R,H+R*2,X+R*2);const K=Y=>{if(c[Y]!=null){let oe=I(m(u[Y],f,y,b)),W=I(h(c[Y],p,A,_));w(U,oe+F,W),x(U,oe,W,F,0,mi*2)}};if(r)r.forEach(K);else for(let Y=i;Y<=n;Y++)K(Y);return{stroke:E>0?U:null,fill:U,clip:N,flags:Jt|bi}})}function _o(e){return(t,s,i,n,r,o)=>{i!=n&&(r!=i&&o!=i&&e(t,s,i),r!=n&&o!=n&&e(t,s,n),e(t,s,o))}}var wu=_o(ws),bu=_o(bs);function So(e){const t=re(e?.alignGaps,0);return(s,i,n,r)=>Qt(s,i,(o,u,c,f,p,m,h,b,_,y,A)=>{let I=o.pxRound,O=B=>I(m(B,f,y,b)),w=B=>I(h(B,p,A,_)),x,E;f.ori==0?(x=ws,E=wu):(x=bs,E=bu);const F=f.dir*(f.ori==0?1:-1),R={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:Jt},U=R.stroke;let N=Z,P=-Z,L,H,X,K=O(u[F==1?n:r]),Y=ps(c,n,r,1*F),oe=ps(c,n,r,-1*F),W=O(u[Y]),Pe=O(u[oe]),Fe=!1;for(let B=F==1?n:r;B>=n&&B<=r;B+=F){let pe=O(u[B]),G=c[B];pe==K?G!=null?(H=w(G),N==Z&&(x(U,pe,H),L=H),N=it(H,N),P=Ue(H,P)):G===null&&(Fe=!0):(N!=Z&&(E(U,K,N,P,L,H),X=K),G!=null?(H=w(G),x(U,pe,H),N=P=L=H):(N=Z,P=-Z,G===null&&(Fe=!0)),K=pe)}N!=Z&&N!=P&&X!=K&&E(U,K,N,P,L,H);let[Q,ae]=Ei(s,i);if(o.fill!=null||Q!=0){let B=R.fill=new Path2D(U),pe=o.fillTo(s,i,o.min,o.max,Q),G=w(pe);x(B,Pe,G),x(B,W,G)}if(!o.spanGaps){let B=[];Fe&&B.push(...xn(u,c,n,r,F,O,t)),R.gaps=B=o.gaps(s,i,n,r,B),R.clip=Ti(B,f.ori,b,_,y,A)}return ae!=0&&(R.band=ae==2?[Lt(s,i,n,r,U,-1),Lt(s,i,n,r,U,1)]:Lt(s,i,n,r,U,ae)),R})}function Eu(e){const t=re(e.align,1),s=re(e.ascDesc,!1),i=re(e.alignGaps,0),n=re(e.extend,!1);return(r,o,u,c)=>Qt(r,o,(f,p,m,h,b,_,y,A,I,O,w)=>{let x=f.pxRound,{left:E,width:F}=r.bbox,R=Q=>x(_(Q,h,O,A)),U=Q=>x(y(Q,b,w,I)),N=h.ori==0?ws:bs;const P={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:Jt},L=P.stroke,H=h.dir*(h.ori==0?1:-1);u=ps(m,u,c,1),c=ps(m,u,c,-1);let X=U(m[H==1?u:c]),K=R(p[H==1?u:c]),Y=K,oe=K;n&&t==-1&&(oe=E,N(L,oe,X)),N(L,K,X);for(let Q=H==1?u:c;Q>=u&&Q<=c;Q+=H){let ae=m[Q];if(ae==null)continue;let B=R(p[Q]),pe=U(ae);t==1?N(L,B,X):N(L,Y,pe),N(L,B,pe),X=pe,Y=B}let W=Y;n&&t==1&&(W=E+F,N(L,W,X));let[Pe,Fe]=Ei(r,o);if(f.fill!=null||Pe!=0){let Q=P.fill=new Path2D(L),ae=f.fillTo(r,o,f.min,f.max,Pe),B=U(ae);N(Q,W,B),N(Q,oe,B)}if(!f.spanGaps){let Q=[];Q.push(...xn(p,m,u,c,H,R,i));let ae=f.width*le/2,B=s||t==1?ae:-ae,pe=s||t==-1?-ae:ae;Q.forEach(G=>{G[0]+=B,G[1]+=pe}),P.gaps=Q=f.gaps(r,o,u,c,Q),P.clip=Ti(Q,h.ori,A,I,O,w)}return Fe!=0&&(P.band=Fe==2?[Lt(r,o,u,c,L,-1),Lt(r,o,u,c,L,1)]:Lt(r,o,u,c,L,Fe)),P})}function Tu(e){e=e||Ks;const t=re(e.size,[.6,Z,1]),s=e.align||0,i=(e.gap||0)*le;let n=e.radius;n=n==null?[0,0]:typeof n=="number"?[n,0]:n;const r=J(n),o=1-t[0],u=re(t[1],Z)*le,c=re(t[2],1)*le,f=re(e.disp,Ks),p=re(e.each,b=>{}),{fill:m,stroke:h}=f;return(b,_,y,A)=>Qt(b,_,(I,O,w,x,E,F,R,U,N,P,L)=>{let H=I.pxRound,X,K;x.ori==0?[X,K]=r(b,_):[K,X]=r(b,_);const Y=x.dir*(x.ori==0?1:-1),oe=E.dir*(E.ori==1?1:-1);let W=x.ori==0?Ii:Dn,Pe=x.ori==0?p:(z,he,Te,Ie,Ge,ke,$e)=>{p(z,he,Te,Ge,Ie,$e,ke)},[Fe,Q]=Ei(b,_),ae=E.distr==3?Fe==1?E.max:E.min:0,B=R(ae,E,L,N),pe,G,te=H(I.width*le),yt=!1,wt=null,ht=null,It=null,bt=null;m!=null&&(te==0||h!=null)&&(yt=!0,wt=m.values(b,_,y,A),ht=new Map,new Set(wt).forEach(z=>{z!=null&&ht.set(z,new Path2D)}),te>0&&(It=h.values(b,_,y,A),bt=new Map,new Set(It).forEach(z=>{z!=null&&bt.set(z,new Path2D)})));let{x0:nt,size:Nt}=f,Js=!0;if(nt!=null&&Nt!=null){O=nt.values(b,_,y,A),nt.unit==2&&(O=O.map(he=>b.posToVal(U+he*P,x.key,!0)));let z=Nt.values(b,_,y,A);Nt.unit==2?G=z[0]*P:G=F(z[0],x,P,U)-F(0,x,P,U),te>=G/2&&(te=0),G=H(vi(G-te,c,u)),pe=Y==1?-te/2:G+te/2}else{let z=P;if(O.length>1){let Te=null;for(let Ie=0,Ge=1/0;Ie<O.length;Ie++)if(w[Ie]!==void 0){if(Te!=null){let ke=Re(O[Ie]-O[Te]);ke<Ge&&(Ge=ke,z=Re(F(O[Ie],x,P,U)-F(O[Te],x,P,U)))}Te=Ie}}let he=z*o;G=z-he-i,te>=G/2&&(te=0),he+i<5&&(H=br),G=H(vi(z-he,c,u)-te-i),pe=(s==0?G/2:s==Y?0:G)-s*Y*i/2,G+te>z&&(Js=!1)}const pt={stroke:null,fill:null,clip:null,band:null,gaps:null,flags:Jt|bi};let Ts;Q!=0&&(pt.band=new Path2D,Ts=H(R(Q==1?E.max:E.min,E,L,N)));const As=yt?null:new Path2D,zt=pt.band;let{y0:Qe,y1:Ls}=f,kt=null;Qe!=null&&Ls!=null&&(w=Ls.values(b,_,y,A),kt=Qe.values(b,_,y,A));let Vt=X*G,se=K*G;for(let z=Y==1?y:A;z>=y&&z<=A;z+=Y){let he=w[z];if(he===void 0)continue;let Te=x.distr!=2||f!=null?O[z]:z,Ie=F(Te,x,P,U),Ge=R(re(he,ae),E,L,N);kt!=null&&he!=null&&(B=R(kt[z],E,L,N));let ke=H(Ie-pe),$e=H(Ue(Ge,B)),Ye=H(it(Ge,B)),lt=$e-Ye;if(he!=null){let dt=he<0?se:Vt,rt=he<0?Vt:se;yt?(te>0&&It[z]!=null&&W(bt.get(It[z]),ke,Ye+Je(te/2),G,Ue(0,lt-te),dt,rt),wt[z]!=null&&W(ht.get(wt[z]),ke,Ye+Je(te/2),G,Ue(0,lt-te),dt,rt)):W(As,ke,Ye+Je(te/2),G,Ue(0,lt-te),dt,rt),Pe(b,_,z,ke-te/2,Ye,G+te,lt)}Q!=0&&(he!=null||Js)&&(oe*Q==1?($e=Ye,Ye=Ts):(Ye=$e,$e=Ts),lt=$e-Ye,W(zt,ke-te/2,Ye,G+te,Ue(0,lt),0,0))}return te>0?pt.stroke=yt?bt:As:yt||(pt._fill=I.width==0?I._fill:I._stroke??I._fill,pt.width=0),pt.fill=yt?ht:As,pt})}function Au(e,t){const s=re(t?.alignGaps,0);return(i,n,r,o)=>Qt(i,n,(u,c,f,p,m,h,b,_,y,A,I)=>{let O=u.pxRound,w=W=>O(h(W,p,A,_)),x=W=>O(b(W,m,I,y)),E,F,R;p.ori==0?(E=Ai,R=ws,F=go):(E=Li,R=bs,F=mo);const U=p.dir*(p.ori==0?1:-1);r=ps(f,r,o,1),o=ps(f,r,o,-1);let N=w(c[U==1?r:o]),P=N,L=[],H=[];for(let W=U==1?r:o;W>=r&&W<=o;W+=U)if(f[W]!=null){let Fe=c[W],Q=w(Fe);L.push(P=Q),H.push(x(f[W]))}const X={stroke:e(L,H,E,R,F,O),fill:null,clip:null,band:null,gaps:null,flags:Jt},K=X.stroke;let[Y,oe]=Ei(i,n);if(u.fill!=null||Y!=0){let W=X.fill=new Path2D(K),Pe=u.fillTo(i,n,u.min,u.max,Y),Fe=x(Pe);R(W,P,Fe),R(W,N,Fe)}if(!u.spanGaps){let W=[];W.push(...xn(c,f,r,o,U,w,s)),X.gaps=W=u.gaps(i,n,r,o,W),X.clip=Ti(W,p.ori,_,y,A,I)}return oe!=0&&(X.band=oe==2?[Lt(i,n,r,o,K,-1),Lt(i,n,r,o,K,1)]:Lt(i,n,r,o,K,oe)),X})}function Lu(e){return Au(Iu,e)}function Iu(e,t,s,i,n,r){const o=e.length;if(o<2)return null;const u=new Path2D;if(s(u,e[0],t[0]),o==2)i(u,e[1],t[1]);else{let c=Array(o),f=Array(o-1),p=Array(o-1),m=Array(o-1);for(let h=0;h<o-1;h++)p[h]=t[h+1]-t[h],m[h]=e[h+1]-e[h],f[h]=p[h]/m[h];c[0]=f[0];for(let h=1;h<o-1;h++)f[h]===0||f[h-1]===0||f[h-1]>0!=f[h]>0?c[h]=0:(c[h]=3*(m[h-1]+m[h])/((2*m[h]+m[h-1])/f[h-1]+(m[h]+2*m[h-1])/f[h]),isFinite(c[h])||(c[h]=0));c[o-1]=f[o-2];for(let h=0;h<o-1;h++)n(u,e[h]+m[h]/3,t[h]+c[h]*m[h]/3,e[h+1]-m[h]/3,t[h+1]-c[h+1]*m[h]/3,e[h+1],t[h+1])}return u}var On=new Set;function yo(){for(let e of On)e.syncRect(!0)}us&&(Kt(lc,fs,yo),Kt(rc,fs,yo,!0),Kt(hi,fs,()=>{ee.pxRatio=le}));var ku=So(),xu=vo();function wo(e,t,s,i){return(i?[e[0],e[1]].concat(e.slice(2)):[e[0]].concat(e.slice(1))).map((r,o)=>Mn(r,o,t,s))}function Du(e,t){return e.map((s,i)=>i==0?null:Ee({},t,s))}function Mn(e,t,s,i){return Ee({},t==0?s:i,e)}function bo(e,t,s){return t==null?Ss:[t,s]}var Ou=bo;function Mu(e,t,s){return t==null?Ss:gi(t,s,vn,!0)}function Eo(e,t,s,i){return t==null?Ss:di(t,s,e.scales[i].log,!1)}var Ru=Eo;function To(e,t,s,i){return t==null?Ss:mn(t,s,e.scales[i].log,!1)}var Pu=To;function Fu(e,t,s,i,n){let r=Ue(wr(e),wr(t)),o=t-e,u=Ft(n/i*o,s);do{let c=s[u],f=i*c/o;if(f>=n&&r+(c<5?_s.get(c):0)<=17)return[c,f]}while(++u<s.length);return[0,0]}function Ao(e){let t,s;return e=e.replace(/(\d+)px/,(i,n)=>(t=He((s=+n)*le))+"px"),[e,t,s]}function Cu(e){e.show&&[e.font,e.labelFont].forEach(t=>{let s=fe(t[2]*le,1);t[0]=t[0].replace(/[0-9.]+px/,s+"px"),t[1]=s})}function ee(e,t,s){const i={mode:re(e.mode,1)},n=i.mode;function r(l,a){return((a.distr==3?At(l>0?l:a.clamp(i,l,a.min,a.max,a.key)):a.distr==4?Sn(l,a.asinh):l)-a._min)/(a._max-a._min)}function o(l,a,d,g){let v=r(l,a);return g+d*(a.dir==-1?1-v:v)}function u(l,a,d,g){let v=r(l,a);return g+d*(a.dir==-1?v:1-v)}function c(l,a,d,g){return a.ori==0?o(l,a,d,g):u(l,a,d,g)}i.valToPosH=o,i.valToPosV=u;let f=!1;i.status=0;const p=i.root=st(Ua);if(e.id!=null&&(p.id=e.id),qe(p,e.class),e.title){let l=st($a,p);l.textContent=e.title}const m=ut("canvas"),h=i.ctx=m.getContext("2d"),b=st(Wa,p);Kt("click",b,l=>{l.target===y&&(de!=ss||ge!=is)&&Ne.click(i,l)},!0);const _=i.under=st(Ya,b);b.appendChild(m);const y=i.over=st(ja,b);e=Zt(e);const A=+re(e.pxAlign,1),I=uo(A);(e.plugins||[]).forEach(l=>{l.opts&&(e=l.opts(i,e)||e)});const O=e.ms||.001,w=i.series=n==1?wo(e.series||[],Qr,ro,!1):Du(e.series||[null],lo),x=i.axes=wo(e.axes||[],Jr,so,!0),E=i.scales={},F=i.bands=e.bands||[];F.forEach(l=>{l.fill=J(l.fill||null),l.dir=re(l.dir,-1)});const R=n==2?w[1].facets[0].scale:w[0].scale,U={axes:ta,series:qo},N=(e.drawOrder||["axes","series"]).map(l=>U[l]);function P(l){let a=E[l];if(a==null){let d=(e.scales||Ks)[l]||Ks;if(d.from!=null)P(d.from),E[l]=Ee({},E[d.from],d,{key:l});else{a=E[l]=Ee({},l==R?oo:_u,d),a.key=l;let g=a.time,v=a.range,S=Ct(v);if((l!=R||n==2&&!g)&&(S&&(v[0]==null||v[1]==null)&&(v={min:v[0]==null?vr:{mode:1,hard:v[0],soft:v[0]},max:v[1]==null?vr:{mode:1,hard:v[1],soft:v[1]}},S=!1),!S&&_i(v))){let T=v;v=(k,M,C)=>M==null?Ss:gi(M,C,T)}a.range=J(v||(g?Ou:l==R?a.distr==3?Ru:a.distr==4?Pu:bo:a.distr==3?Eo:a.distr==4?To:Mu)),a.auto=J(S?!1:a.auto),a.clamp=J(a.clamp||vu),a._min=a._max=null}}}P("x"),P("y"),n==1&&w.forEach(l=>{P(l.scale)}),x.forEach(l=>{P(l.scale)});for(let l in e.scales)P(l);const L=E[R],H=L.distr;let X,K;L.ori==0?(qe(p,Ba),X=o,K=u):(qe(p,Ga),X=u,K=o);const Y={};for(let l in E){let a=E[l];(a.min!=null||a.max!=null)&&(Y[l]={min:a.min,max:a.max},a.min=a.max=null)}const oe=e.tzDate||(l=>new Date(He(l/O))),W=e.fmtDate||yn,Pe=O==1?Gc(oe):Yc(oe),Fe=$r(oe,Gr(O==1?Bc:Wc,W)),Q=Yr(oe,Wr(Xc,W)),ae=[],B=i.legend=Ee({},Zc,e.legend),pe=B.show,G=B.markers;B.idxs=ae,G.width=J(G.width),G.dash=J(G.dash),G.stroke=J(G.stroke),G.fill=J(G.fill);let te,yt,wt,ht=[],It=[],bt,nt=!1,Nt={};if(B.live){const l=w[1]?w[1].values:null;nt=l!=null,bt=nt?l(i,1,0):{_:0};for(let a in bt)Nt[a]=un}if(pe)if(te=ut("table",Qa,p),wt=ut("tbody",null,te),B.mount(i,te),nt){yt=ut("thead",null,te,wt);let l=ut("tr",null,yt);ut("th",null,l);for(var Js in bt)ut("th",nr,l).textContent=Js}else qe(te,tc),B.live&&qe(te,ec);const pt={show:!0},Ts={show:!1};function As(l,a){if(a==0&&(nt||!B.live||n==2))return Ss;let d=[],g=ut("tr",sc,wt,wt.childNodes[a]);qe(g,l.class),l.show||qe(g,Xt);let v=ut("th",null,g);if(G.show){let k=st(ic,v);if(a>0){let M=G.width(i,a);M&&(k.style.border=M+"px "+G.dash(i,a)+" "+G.stroke(i,a)),k.style.background=G.fill(i,a)}}let S=st(nr,v);S.textContent=l.label,a>0&&(G.show||(S.style.color=l.width>0?G.stroke(i,a):G.fill(i,a)),Qe("click",v,k=>{if($._lock)return;Ht(k);let M=w.indexOf(l);if((k.ctrlKey||k.metaKey)!=B.isolate){let C=w.some((D,V)=>V>0&&V!=M&&D.show);w.forEach((D,V)=>{V>0&&mt(V,C?V==M?pt:Ts:pt,!0,we.setSeries)})}else mt(M,{show:!l.show},!0,we.setSeries)},!1),ks&&Qe(cr,v,k=>{$._lock||(Ht(k),mt(w.indexOf(l),rs,!0,we.setSeries))},!1));for(var T in bt){let k=ut("td",nc,g);k.textContent="--",d.push(k)}return[g,d]}const zt=new Map;function Qe(l,a,d,g=!0){const v=zt.get(a)||{},S=$.bind[l](i,a,d,g);S&&(Kt(l,a,v[l]=S),zt.set(a,v))}function Ls(l,a,d){const g=zt.get(a)||{};for(let v in g)(l==null||v==l)&&(gn(v,a,g[v]),delete g[v]);l==null&&zt.delete(a)}let kt=0,Vt=0,se=0,z=0,he=0,Te=0,Ie=0,Ge=0,ke=0,$e=0;i.bbox={};let Ye=!1,lt=!1,dt=!1,rt=!1,Oi=!1,et=!1;function Mi(l,a,d){(d||l!=i.width||a!=i.height)&&Nn(l,a),Os(!1),dt=!0,lt=!0,$.left>=0&&(rt=et=!0),Bt()}function Nn(l,a){i.width=kt=se=l,i.height=Vt=z=a,he=Te=0,Bo(),Go();let d=i.bbox;Ie=d.left=qt(he*le,.5),Ge=d.top=qt(Te*le,.5),ke=d.width=qt(se*le,.5),$e=d.height=qt(z*le,.5)}const Vo=3;function Ho(){let l=!1,a=0;for(;!l;){a++;let d=Qo(a),g=ea(a);l=a==Vo||d&&g,l||(Nn(i.width,i.height),lt=!0)}}function Uo({width:l,height:a}){Mi(l,a)}i.setSize=Uo;function Bo(){let l=!1,a=!1,d=!1,g=!1;x.forEach((v,S)=>{if(v.show&&v._show){let{side:T,_size:k}=v,M=T%2,C=v.label!=null?v.labelSize:0,D=k+C;D>0&&(M?(se-=D,T==3?(he+=D,g=!0):d=!0):(z-=D,T==0?(Te+=D,l=!0):a=!0))}}),Ut[0]=l,Ut[1]=d,Ut[2]=a,Ut[3]=g,se-=xt[1]+xt[3],he+=xt[3],z-=xt[2]+xt[0],Te+=xt[0]}function Go(){let l=he+se,a=Te+z,d=he,g=Te;function v(S,T){switch(S){case 1:return l+=T,l-T;case 2:return a+=T,a-T;case 3:return d-=T,d+T;case 0:return g-=T,g+T}}x.forEach((S,T)=>{if(S.show&&S._show){let k=S.side;S._pos=v(k,S._size),S.label!=null&&(S._lpos=v(k,S.labelSize))}})}const $=i.cursor=Ee({},nu,{drag:{y:n==2}},e.cursor),Ht=l=>{$.event=l};$.idxs=ae,$._lock=!1;let gt=$.points;gt.show=J(gt.show),gt.size=J(gt.size),gt.stroke=J(gt.stroke),gt.width=J(gt.width),gt.fill=J(gt.fill);const Is=i.focus=Ee({},e.focus||{alpha:.3},$.focus),ks=Is.prox>=0;let je=[null];function $o(l,a){if(a>0){let d=$.points.show(i,a);if(d)return qe(d,Ja),qe(d,l.class),hs(d,-10,-10,se,z),y.insertBefore(d,je[a]),d}}function zn(l,a){if(n==1||a>0){let d=n==1&&E[l.scale].time,g=l.value;l.value=d?xr(g)?Yr(oe,Wr(g,W)):g||Q:g||du,l.label=l.label||(d?ru:lu)}if(a>0){l.width=l.width==null?1:l.width,l.paths=l.paths||ku||vc,l.fillTo=J(l.fillTo||Su),l.pxAlign=+re(l.pxAlign,A),l.pxRound=uo(l.pxAlign),l.stroke=J(l.stroke||null),l.fill=J(l.fill||null),l._stroke=l._fill=l._paths=l._focus=null;let d=gu(Ue(1,l.width),1),g=l.points=Ee({},{size:d,width:Ue(1,d*.2),stroke:l.stroke,space:d*2,paths:xu,_stroke:null,_fill:null},l.points);g.show=J(g.show),g.filter=J(g.filter),g.fill=J(g.fill),g.stroke=J(g.stroke),g.paths=J(g.paths),g.pxAlign=l.pxAlign}if(pe){let d=As(l,a);ht.splice(a,0,d[0]),It.splice(a,0,d[1]),B.values.push(null)}if($.show){ae.splice(a,0,null);let d=$o(l,a);d&&je.splice(a,0,d)}Ve("addSeries",a)}function Wo(l,a){a=a??w.length,l=n==1?Mn(l,a,Qr,ro):Mn(l,a,null,lo),w.splice(a,0,l),zn(w[a],a)}i.addSeries=Wo;function Yo(l){if(w.splice(l,1),pe){B.values.splice(l,1),It.splice(l,1);let a=ht.splice(l,1)[0];Ls(null,a.firstChild),a.remove()}$.show&&(ae.splice(l,1),je.length>1&&je.splice(l,1)[0].remove()),Ve("delSeries",l)}i.delSeries=Yo;const Ut=[!1,!1,!1,!1];function jo(l,a){if(l._show=l.show,l.show){let d=l.side%2,g=E[l.scale];g==null&&(l.scale=d?w[1].scale:R,g=E[l.scale]);let v=g.time;l.size=J(l.size),l.space=J(l.space),l.rotate=J(l.rotate),Ct(l.incrs)&&l.incrs.forEach(T=>{!_s.has(T)&&_s.set(T,Ir(T))}),l.incrs=J(l.incrs||(g.distr==2?zc:v?O==1?Uc:$c:Vc)),l.splits=J(l.splits||(v&&g.distr==1?Pe:g.distr==3?In:g.distr==4?cu:au)),l.stroke=J(l.stroke),l.grid.stroke=J(l.grid.stroke),l.ticks.stroke=J(l.ticks.stroke),l.border.stroke=J(l.border.stroke);let S=l.values;l.values=Ct(S)&&!Ct(S[0])?J(S):v?Ct(S)?$r(oe,Gr(S,W)):xr(S)?jc(oe,S):S||Fe:S||ou,l.filter=J(l.filter||(g.distr>=3&&g.log==10?hu:g.distr==3&&g.log==2?pu:Er)),l.font=Ao(l.font),l.labelFont=Ao(l.labelFont),l._size=l.size(i,null,a,0),l._space=l._rotate=l._incrs=l._found=l._splits=l._values=null,l._size>0&&(Ut[a]=!0,l._el=st(Xa,b))}}function xs(l,a,d,g){let[v,S,T,k]=d,M=a%2,C=0;return M==0&&(k||S)&&(C=a==0&&!v||a==2&&!T?He(Jr.size/3):0),M==1&&(v||T)&&(C=a==1&&!S||a==3&&!k?He(so.size/2):0),C}const Vn=i.padding=(e.padding||[xs,xs,xs,xs]).map(l=>J(re(l,xs))),xt=i._padding=Vn.map((l,a)=>l(i,a,Ut,0));let Ce,xe=null,De=null;const Qs=n==1?w[0].idxs:null;let ot=null,ei=!1;function Hn(l,a){if(t=l==null?[]:Zt(l,Dr),n==2){Ce=0;for(let d=1;d<w.length;d++)Ce+=t[d][0].length;i.data=t=l}else if(t[0]==null&&(t[0]=[]),i.data=t.slice(),ot=t[0],Ce=ot.length,H==2){t[0]=Array(Ce);for(let d=0;d<Ce;d++)t[0][d]=d}if(i._data=t,Os(!0),Ve("setData"),H==2&&(dt=!0),a!==!1){let d=L;d.auto(i,ei)?Ri():ns(R,d.min,d.max),rt=rt||$.left>=0,et=!0,Bt()}}i.setData=Hn;function Ri(){ei=!0;let l,a;n==1&&(Ce>0?(xe=Qs[0]=0,De=Qs[1]=Ce-1,l=t[0][xe],a=t[0][De],H==2?(l=xe,a=De):l==a&&(H==3?[l,a]=di(l,l,L.log,!1):H==4?[l,a]=mn(l,l,L.log,!1):L.time?a=l+He(86400/O):[l,a]=gi(l,a,vn,!0))):(xe=Qs[0]=l=null,De=Qs[1]=a=null)),ns(R,l,a)}let ti,ts,Pi,Fi,Ci,Ni,zi,Vi,Hi,Ds;function Un(l,a,d,g,v,S){l??=rr,d??=kr,g??="butt",v??=rr,S??="round",l!=ti&&(h.strokeStyle=ti=l),v!=ts&&(h.fillStyle=ts=v),a!=Pi&&(h.lineWidth=Pi=a),S!=Ci&&(h.lineJoin=Ci=S),g!=Ni&&(h.lineCap=Ni=g),d!=Fi&&h.setLineDash(Fi=d)}function Bn(l,a,d,g){a!=ts&&(h.fillStyle=ts=a),l!=zi&&(h.font=zi=l),d!=Vi&&(h.textAlign=Vi=d),g!=Hi&&(h.textBaseline=Hi=g)}function Ui(l,a,d,g,v=0){if(g.length>0&&l.auto(i,ei)&&(a==null||a.min==null)){let S=re(xe,0),T=re(De,g.length-1),k=d.min==null?l.distr==3?fc(g,S,T):uc(g,S,T,v):[d.min,d.max];l.min=it(l.min,d.min=k[0]),l.max=Ue(l.max,d.max=k[1])}}function Xo(){let l=Zt(E,Dr);for(let g in l){let v=l[g],S=Y[g];if(S!=null&&S.min!=null)Ee(v,S),g==R&&Os(!0);else if(g!=R||n==2)if(Ce==0&&v.from==null){let T=v.range(i,null,null,g);v.min=T[0],v.max=T[1]}else v.min=Z,v.max=-Z}if(Ce>0){w.forEach((g,v)=>{if(n==1){let S=g.scale,T=l[S],k=Y[S];if(v==0){let M=T.range(i,T.min,T.max,S);T.min=M[0],T.max=M[1],xe=Ft(T.min,t[0]),De=Ft(T.max,t[0]),De-xe>1&&(t[0][xe]<T.min&&xe++,t[0][De]>T.max&&De--),g.min=ot[xe],g.max=ot[De]}else g.show&&g.auto&&Ui(T,k,g,t[v],g.sorted);g.idxs[0]=xe,g.idxs[1]=De}else if(v>0&&g.show&&g.auto){let[S,T]=g.facets,k=S.scale,M=T.scale,[C,D]=t[v];Ui(l[k],Y[k],S,C,S.sorted),Ui(l[M],Y[M],T,D,T.sorted),g.min=T.min,g.max=T.max}});for(let g in l){let v=l[g],S=Y[g];if(v.from==null&&(S==null||S.min==null)){let T=v.range(i,v.min==Z?null:v.min,v.max==-Z?null:v.max,g);v.min=T[0],v.max=T[1]}}}for(let g in l){let v=l[g];if(v.from!=null){let S=l[v.from];if(S.min==null)v.min=v.max=null;else{let T=v.range(i,S.min,S.max,g);v.min=T[0],v.max=T[1]}}}let a={},d=!1;for(let g in l){let v=l[g],S=E[g];if(S.min!=v.min||S.max!=v.max){S.min=v.min,S.max=v.max;let T=S.distr;S._min=T==3?At(S.min):T==4?Sn(S.min,S.asinh):S.min,S._max=T==3?At(S.max):T==4?Sn(S.max,S.asinh):S.max,a[g]=d=!0}}if(d){w.forEach((g,v)=>{n==2?v>0&&a.y&&(g._paths=null):a[g.scale]&&(g._paths=null)});for(let g in a)dt=!0,Ve("setScale",g);$.show&&$.left>=0&&(rt=et=!0)}for(let g in Y)Y[g]=null}function Ko(l){let a=vi(xe-1,0,Ce-1),d=vi(De+1,0,Ce-1);for(;l[a]==null&&a>0;)a--;for(;l[d]==null&&d<Ce-1;)d++;return[a,d]}function qo(){Ce>0&&(w.forEach((l,a)=>{if(a>0&&l.show&&(Gn(a,!1),Gn(a,!0),l._paths==null)){let d=n==2?[0,t[a][0].length-1]:Ko(t[a]);l._paths=l.paths(i,a,d[0],d[1])}}),w.forEach((l,a)=>{if(a>0&&l.show){Ds!=l.alpha&&(h.globalAlpha=Ds=l.alpha),l._paths!=null&&$n(a,!1);{let d=l._paths!=null?l._paths.gaps:null,g=l.points.show(i,a,xe,De,d),v=l.points.filter(i,a,g,d);(g||v)&&(l.points._paths=l.points.paths(i,a,xe,De,v),$n(a,!0))}Ds!=1&&(h.globalAlpha=Ds=1),Ve("drawSeries",a)}}))}function Gn(l,a){let d=a?w[l].points:w[l];d._stroke=d.stroke(i,l),d._fill=d.fill(i,l)}function $n(l,a){let d=a?w[l].points:w[l],{stroke:g,fill:v,clip:S,flags:T,_stroke:k=d._stroke,_fill:M=d._fill,_width:C=d.width}=d._paths;C=fe(C*le,3);let D=null,V=C%2/2;a&&M==null&&(M=C>0?"#fff":k);let j=d.pxAlign==1&&V>0;if(j&&h.translate(V,V),!a){let Se=Ie-C/2,q=Ge-C/2,ne=ke+C,ie=$e+C;D=new Path2D,D.rect(Se,q,ne,ie)}a?Bi(k,C,d.dash,d.cap,M,g,v,T,S):Zo(l,k,C,d.dash,d.cap,M,g,v,T,D,S),j&&h.translate(-V,-V)}function Zo(l,a,d,g,v,S,T,k,M,C,D){let V=!1;F.forEach((j,Se)=>{if(j.series[0]==l){let q=w[j.series[1]],ne=t[j.series[1]],ie=(q._paths||Ks).band;Ct(ie)&&(ie=j.dir==1?ie[0]:ie[1]);let ue,_e=null;q.show&&ie&&pc(ne,xe,De)?(_e=j.fill(i,Se)||S,ue=q._paths.clip):ie=null,Bi(a,d,g,v,_e,T,k,M,C,D,ue,ie),V=!0}}),V||Bi(a,d,g,v,S,T,k,M,C,D)}const Wn=Jt|bi;function Bi(l,a,d,g,v,S,T,k,M,C,D,V){Un(l,a,d,g,v),(M||C||V)&&(h.save(),M&&h.clip(M),C&&h.clip(C)),V?(k&Wn)==Wn?(h.clip(V),D&&h.clip(D),ii(v,T),si(l,S,a)):k&bi?(ii(v,T),h.clip(V),si(l,S,a)):k&Jt&&(h.save(),h.clip(V),D&&h.clip(D),ii(v,T),h.restore(),si(l,S,a)):(ii(v,T),si(l,S,a)),(M||C||V)&&h.restore()}function si(l,a,d){d>0&&(a instanceof Map?a.forEach((g,v)=>{h.strokeStyle=ti=v,h.stroke(g)}):a!=null&&l&&h.stroke(a))}function ii(l,a){a instanceof Map?a.forEach((d,g)=>{h.fillStyle=ts=g,h.fill(d)}):a!=null&&l&&h.fill(a)}function Jo(l,a,d,g){let v=x[l],S;if(g<=0)S=[0,0];else{let T=v._space=v.space(i,l,a,d,g),k=v._incrs=v.incrs(i,l,a,d,g,T);S=Fu(a,d,k,g,T)}return v._found=S}function Gi(l,a,d,g,v,S,T,k,M,C){let D=T%2/2;A==1&&h.translate(D,D),Un(k,T,M,C,k),h.beginPath();let V,j,Se,q,ne=v+(g==0||g==3?-S:S);d==0?(j=v,q=ne):(V=v,Se=ne);for(let ie=0;ie<l.length;ie++)a[ie]!=null&&(d==0?V=Se=l[ie]:j=q=l[ie],h.moveTo(V,j),h.lineTo(Se,q));h.stroke(),A==1&&h.translate(-D,-D)}function Qo(l){let a=!0;return x.forEach((d,g)=>{if(!d.show)return;let v=E[d.scale];if(v.min==null){d._show&&(a=!1,d._show=!1,Os(!1));return}else d._show||(a=!1,d._show=!0,Os(!1));let S=d.side,T=S%2,{min:k,max:M}=v,[C,D]=Jo(g,k,M,T==0?se:z);if(D==0)return;let V=v.distr==2,j=d._splits=d.splits(i,g,k,M,C,D,V),Se=v.distr==2?j.map(ue=>ot[ue]):j,q=v.distr==2?ot[j[1]]-ot[j[0]]:C,ne=d._values=d.values(i,d.filter(i,Se,g,D,q),g,D,q);d._rotate=S==2?d.rotate(i,ne,g,D):0;let ie=d._size;d._size=ds(d.size(i,ne,g,l)),ie!=null&&d._size!=ie&&(a=!1)}),a}function ea(l){let a=!0;return Vn.forEach((d,g)=>{let v=d(i,g,Ut,l);v!=xt[g]&&(a=!1),xt[g]=v}),a}function ta(){for(let l=0;l<x.length;l++){let a=x[l];if(!a.show||!a._show)continue;let d=a.side,g=d%2,v,S,T=a.stroke(i,l),k=d==0||d==3?-1:1;if(a.label){let ct=a.labelGap*k,Et=He((a._lpos+ct)*le);Bn(a.labelFont[0],T,"center",d==2?Ys:lr),h.save(),g==1?(v=S=0,h.translate(Et,He(Ge+$e/2)),h.rotate((d==3?-mi:mi)/2)):(v=He(Ie+ke/2),S=Et),h.fillText(a.label,v,S),h.restore()}let[M,C]=a._found;if(C==0)continue;let D=E[a.scale],V=g==0?ke:$e,j=g==0?Ie:Ge,Se=He(a.gap*le),q=a._splits,ne=D.distr==2?q.map(ct=>ot[ct]):q,ie=D.distr==2?ot[q[1]]-ot[q[0]]:M,ue=a.ticks,_e=a.border,Xe=ue.show?He(ue.size*le):0,me=a._rotate*-mi/180,be=I(a._pos*le),Be=(Xe+Se)*k,ye=be+Be;S=g==0?ye:0,v=g==1?ye:0;let We=a.font[0],at=a.align==1?cs:a.align==2?on:me>0?cs:me<0?on:g==0?"center":d==3?on:cs,Mt=me||g==1?"middle":d==2?Ys:lr;Bn(We,T,at,Mt);let ul=a.font[1]*a.lineGap,ci=q.map(ct=>I(c(ct,D,V,j))),fl=a._values;for(let ct=0;ct<fl.length;ct++){let Et=fl[ct];if(Et!=null){g==0?v=ci[ct]:S=ci[ct],Et=""+Et;let hl=Et.indexOf(`
`)==-1?[Et]:Et.split(/\n/gm);for(let Vs=0;Vs<hl.length;Vs++){let pl=hl[Vs];me?(h.save(),h.translate(v,S+Vs*ul),h.rotate(me),h.fillText(pl,0,0),h.restore()):h.fillText(pl,v,S+Vs*ul)}}}ue.show&&Gi(ci,ue.filter(i,ne,l,C,ie),g,d,be,Xe,fe(ue.width*le,3),ue.stroke(i,l),ue.dash,ue.cap);let as=a.grid;as.show&&Gi(ci,as.filter(i,ne,l,C,ie),g,g==0?2:1,g==0?Ge:Ie,g==0?$e:ke,fe(as.width*le,3),as.stroke(i,l),as.dash,as.cap),_e.show&&Gi([be],[1],g==0?1:0,g==0?1:2,g==1?Ge:Ie,g==1?$e:ke,fe(_e.width*le,3),_e.stroke(i,l),_e.dash,_e.cap)}Ve("drawAxes")}function Os(l){w.forEach((a,d)=>{d>0&&(a._paths=null,l&&(n==1?(a.min=null,a.max=null):a.facets.forEach(g=>{g.min=null,g.max=null})))})}let $i=!1;function Bt(){$i||(Lc(sa),$i=!0)}function sa(){Ye&&(Xo(),Ye=!1),dt&&(Ho(),dt=!1),lt&&(ve(_,cs,he),ve(_,Ys,Te),ve(_,$s,se),ve(_,Ws,z),ve(y,cs,he),ve(y,Ys,Te),ve(y,$s,se),ve(y,Ws,z),ve(b,$s,kt),ve(b,Ws,Vt),m.width=He(kt*le),m.height=He(Vt*le),x.forEach(({_el:l,_show:a,_size:d,_pos:g,side:v})=>{if(l!=null)if(a){let S=v===3||v===0?d:0,T=v%2==1;ve(l,T?"left":"top",g-S),ve(l,T?"width":"height",d),ve(l,T?"top":"left",T?Te:he),ve(l,T?"height":"width",T?z:se),pn(l,Xt)}else qe(l,Xt)}),ti=ts=Pi=Ci=Ni=zi=Vi=Hi=Fi=null,Ds=1,Ns(!0),Ve("setSize"),lt=!1),kt>0&&Vt>0&&(h.clearRect(0,0,m.width,m.height),Ve("drawClear"),N.forEach(l=>l()),Ve("draw")),ze.show&&Oi&&(ri(ze),Oi=!1),$.show&&rt&&(Gt(null,!0,!1),rt=!1),B.show&&B.live&&et&&(Xi(),et=!1),f||(f=!0,i.status=1,Ve("ready")),ei=!1,$i=!1}i.redraw=(l,a)=>{dt=a||!1,l!==!1?ns(R,L.min,L.max):Bt()};function Wi(l,a){let d=E[l];if(d.from==null){if(Ce==0){let g=d.range(i,a.min,a.max,l);a.min=g[0],a.max=g[1]}if(a.min>a.max){let g=a.min;a.min=a.max,a.max=g}if(Ce>1&&a.min!=null&&a.max!=null&&a.max-a.min<1e-16)return;l==R&&d.distr==2&&Ce>0&&(a.min=Ft(a.min,t[0]),a.max=Ft(a.max,t[0]),a.min==a.max&&a.max++),Y[l]=a,Ye=!0,Bt()}}i.setScale=Wi;let Yi,ji,ni,li,Yn,jn,ss,is,Xn,Kn,de,ge,Dt=!1;const Ne=$.drag;let Oe=Ne.x,Me=Ne.y;$.show&&($.x&&(Yi=st(qa,y)),$.y&&(ji=st(Za,y)),L.ori==0?(ni=Yi,li=ji):(ni=ji,li=Yi),de=$.left,ge=$.top);const ze=i.select=Ee({show:!0,over:!0,left:0,width:0,top:0,height:0},e.select),Ms=ze.show?st(Ka,ze.over?y:_):null;function ri(l,a){if(ze.show){for(let d in l)ze[d]=l[d],d in Qn&&ve(Ms,d,l[d]);a!==!1&&Ve("setSelect")}}i.setSelect=ri;function ia(l,a){let d=w[l],g=pe?ht[l]:null;d.show?g&&pn(g,Xt):(g&&qe(g,Xt),je.length>1&&hs(je[l],-10,-10,se,z))}function ns(l,a,d){Wi(l,{min:a,max:d})}function mt(l,a,d,g){a.focus!=null&&aa(l),a.show!=null&&w.forEach((v,S)=>{S>0&&(l==S||l==null)&&(v.show=a.show,ia(S,a.show),ns(n==2?v.facets[1].scale:v.scale,null,null),Bt())}),d!==!1&&Ve("setSeries",l,a),g&&zs("setSeries",i,l,a)}i.setSeries=mt;function na(l,a){Ee(F[l],a)}function la(l,a){l.fill=J(l.fill||null),l.dir=re(l.dir,-1),a=a??F.length,F.splice(a,0,l)}function ra(l){l==null?F.length=0:F.splice(l,1)}i.addBand=la,i.setBand=na,i.delBand=ra;function oa(l,a){w[l].alpha=a,$.show&&je[l]&&(je[l].style.opacity=a),pe&&ht[l]&&(ht[l].style.opacity=a)}let ls,Rs,Ps;const rs={focus:!0};function aa(l){if(l!=Ps){let a=l==null,d=Is.alpha!=1;w.forEach((g,v)=>{let S=a||v==0||v==l;g._focus=a?null:S,d&&oa(v,S?1:Is.alpha)}),Ps=l,d&&Bt()}}pe&&ks&&Qe(ur,te,l=>{$._lock||(Ht(l),Ps!=null&&mt(null,rs,!0,we.setSeries))});function vt(l,a,d){let g=E[a];d&&(l=l/le-(g.ori==1?Te:he));let v=se;g.ori==1&&(v=z,l=v-l),g.dir==-1&&(l=v-l);let S=g._min,T=g._max,k=l/v,M=S+(T-S)*k,C=g.distr;return C==3?gs(10,M):C==4?gc(M,g.asinh):M}function ca(l,a){let d=vt(l,R,a);return Ft(d,t[0],xe,De)}i.valToIdx=l=>Ft(l,t[0]),i.posToIdx=ca,i.posToVal=vt,i.valToPos=(l,a,d)=>E[a].ori==0?o(l,E[a],d?ke:se,d?Ie:0):u(l,E[a],d?$e:z,d?Ge:0);function ua(l){l(i),Bt()}i.batch=ua,i.setCursor=(l,a,d)=>{de=l.left,ge=l.top,Gt(null,a,d)};function qn(l,a){ve(Ms,cs,ze.left=l),ve(Ms,$s,ze.width=a)}function Zn(l,a){ve(Ms,Ys,ze.top=l),ve(Ms,Ws,ze.height=a)}let Fs=L.ori==0?qn:Zn,Cs=L.ori==1?qn:Zn;function fa(){if(pe&&B.live)for(let l=n==2?1:0;l<w.length;l++){if(l==0&&nt)continue;let a=B.values[l],d=0;for(let g in a)It[l][d++].firstChild.nodeValue=a[g]}}function Xi(l,a){l!=null&&(l.idxs?l.idxs.forEach((d,g)=>{ae[g]=d}):Sc(l.idx)||ae.fill(l.idx),B.idx=ae[0]);for(let d=0;d<w.length;d++)(d>0||n==1&&!nt)&&ha(d,ae[d]);pe&&B.live&&fa(),et=!1,a!==!1&&Ve("setLegend")}i.setLegend=Xi;function ha(l,a){let d=w[l],g=l==0&&H==2?ot:t[l],v;nt?v=d.values(i,l,a)??Nt:(v=d.value(i,a==null?null:g[a],l,a),v=v==null?Nt:{_:v}),B.values[l]=v}function Gt(l,a,d){Xn=de,Kn=ge,[de,ge]=$.move(i,de,ge),$.show&&(ni&&hs(ni,He(de),0,se,z),li&&hs(li,0,He(ge),se,z));let g,v=xe>De;ls=Z;let S=L.ori==0?se:z,T=L.ori==1?se:z;if(de<0||Ce==0||v){g=null;for(let k=0;k<w.length;k++)k>0&&je.length>1&&hs(je[k],-10,-10,se,z);ks&&mt(null,rs,!0,l==null&&we.setSeries),B.live&&(ae.fill(g),et=!0)}else{let k,M,C;n==1&&(k=L.ori==0?de:ge,M=vt(k,R),g=Ft(M,t[0],xe,De),C=X(t[0][g],L,S,0));for(let D=n==2?1:0;D<w.length;D++){let V=w[D],j=ae[D],Se=n==1?t[D][j]:t[D][1][j],q=$.dataIdx(i,D,g,M),ne=n==1?t[D][q]:t[D][1][q];et=et||ne!=Se||q!=j,ae[D]=q;let ie=vs(q==g?C:X(n==1?t[0][q]:t[D][0][q],L,S,0),1);if(D>0&&V.show){let ue=ne==null?-10:vs(K(ne,n==1?E[V.scale]:E[V.facets[1].scale],T,0),1);if(ks&&ue>=0&&n==1){let me=Re(ue-ge);if(me<ls){let be=Is.bias;if(be!=0){let Be=L.ori==1?de:ge,ye=vt(Be,V.scale),We=ne>=0?1:-1,at=ye>=0?1:-1;at==We&&(at==1?be==1?ne>=ye:ne<=ye:be==1?ne<=ye:ne>=ye)&&(ls=me,Rs=D)}else ls=me,Rs=D}}let _e,Xe;if(L.ori==0?(_e=ie,Xe=ue):(_e=ue,Xe=ie),et&&je.length>1){ac(je[D],$.points.fill(i,D),$.points.stroke(i,D));let me,be,Be,ye,We=!0,at=$.points.bbox;if(at!=null){We=!1;let Mt=at(i,D);Be=Mt.left,ye=Mt.top,me=Mt.width,be=Mt.height}else Be=_e,ye=Xe,me=be=$.points.size(i,D);cc(je[D],me,be,We),hs(je[D],Be,ye,se,z)}}}}if($.idx=g,$.left=de,$.top=ge,et&&(B.idx=g,Xi()),ze.show&&Dt)if(l!=null){let[k,M]=we.scales,[C,D]=we.match,[V,j]=l.cursor.sync.scales,Se=l.cursor.drag;if(Oe=Se._x,Me=Se._y,Oe||Me){let{left:q,top:ne,width:ie,height:ue}=l.select,_e=l.scales[k].ori,Xe=l.posToVal,me,be,Be,ye,We,at=k!=null&&C(k,V),Mt=M!=null&&D(M,j);at&&Oe?(_e==0?(me=q,be=ie):(me=ne,be=ue),Be=E[k],ye=X(Xe(me,V),Be,S,0),We=X(Xe(me+be,V),Be,S,0),Fs(it(ye,We),Re(We-ye))):Fs(0,S),Mt&&Me?(_e==1?(me=q,be=ie):(me=ne,be=ue),Be=E[M],ye=K(Xe(me,j),Be,T,0),We=K(Xe(me+be,j),Be,T,0),Cs(it(ye,We),Re(We-ye))):Cs(0,T)}else oi()}else{let k=Re(Xn-Yn),M=Re(Kn-jn);if(L.ori==1){let j=k;k=M,M=j}Oe=Ne.x&&k>=Ne.dist,Me=Ne.y&&M>=Ne.dist;let C=Ne.uni;C!=null?Oe&&Me&&(Oe=k>=C,Me=M>=C,!Oe&&!Me&&(M>k?Me=!0:Oe=!0)):Ne.x&&Ne.y&&(Oe||Me)&&(Oe=Me=!0);let D,V;Oe&&(L.ori==0?(D=ss,V=de):(D=is,V=ge),Fs(it(D,V),Re(V-D)),Me||Cs(0,T)),Me&&(L.ori==1?(D=ss,V=de):(D=is,V=ge),Cs(it(D,V),Re(V-D)),Oe||Fs(0,S)),!Oe&&!Me&&(Fs(0,0),Cs(0,0))}if(Ne._x=Oe,Ne._y=Me,l==null){if(d){if(cl!=null){let[k,M]=we.scales;we.values[0]=k!=null?vt(L.ori==0?de:ge,k):null,we.values[1]=M!=null?vt(L.ori==1?de:ge,M):null}zs(or,i,de,ge,se,z,g)}if(ks){let k=d&&we.setSeries,M=Is.prox;Ps==null?ls<=M&&mt(Rs,rs,!0,k):ls>M?mt(null,rs,!0,k):Rs!=Ps&&mt(Rs,rs,!0,k)}}a!==!1&&Ve("setCursor")}let Ot=null;Object.defineProperty(i,"rect",{get(){return Ot==null&&Ns(!1),Ot}});function Ns(l=!1){l?Ot=null:(Ot=y.getBoundingClientRect(),Ve("syncRect",Ot))}function Jn(l,a,d,g,v,S,T){$._lock||Dt&&l!=null&&l.movementX==0&&l.movementY==0||(Ki(l,a,d,g,v,S,T,!1,l!=null),l!=null?Gt(null,!0,!0):Gt(a,!0,!1))}function Ki(l,a,d,g,v,S,T,k,M){if(Ot==null&&Ns(!1),Ht(l),l!=null)d=l.clientX-Ot.left,g=l.clientY-Ot.top;else{if(d<0||g<0){de=-10,ge=-10;return}let[C,D]=we.scales,V=a.cursor.sync,[j,Se]=V.values,[q,ne]=V.scales,[ie,ue]=we.match,_e=a.axes[0].side%2==1,Xe=L.ori==0?se:z,me=L.ori==1?se:z,be=_e?S:v,Be=_e?v:S,ye=_e?g:d,We=_e?d:g;if(q!=null?d=ie(C,q)?c(j,E[C],Xe,0):-10:d=Xe*(ye/be),ne!=null?g=ue(D,ne)?c(Se,E[D],me,0):-10:g=me*(We/Be),L.ori==1){let at=d;d=g,g=at}}M&&((d<=1||d>=se-1)&&(d=qt(d,se)),(g<=1||g>=z-1)&&(g=qt(g,z))),k?(Yn=d,jn=g,[ss,is]=$.move(i,d,g)):(de=d,ge=g)}const Qn={width:0,height:0,left:0,top:0};function oi(){ri(Qn,!1)}let el,tl,sl,il;function nl(l,a,d,g,v,S,T){Dt=!0,Oe=Me=Ne._x=Ne._y=!1,Ki(l,a,d,g,v,S,T,!0,!1),l!=null&&(Qe(cn,fn,ll,!1),zs(ar,i,ss,is,se,z,null));let{left:k,top:M,width:C,height:D}=ze;el=k,tl=M,sl=C,il=D,oi()}function ll(l,a,d,g,v,S,T){Dt=Ne._x=Ne._y=!1,Ki(l,a,d,g,v,S,T,!1,!0);let{left:k,top:M,width:C,height:D}=ze,V=C>0||D>0,j=el!=k||tl!=M||sl!=C||il!=D;if(V&&j&&ri(ze),Ne.setScale&&V&&j){let Se=k,q=C,ne=M,ie=D;if(L.ori==1&&(Se=M,q=D,ne=k,ie=C),Oe&&ns(R,vt(Se,R),vt(Se+q,R)),Me)for(let ue in E){let _e=E[ue];ue!=R&&_e.from==null&&_e.min!=Z&&ns(ue,vt(ne+ie,ue),vt(ne,ue))}oi()}else $.lock&&($._lock=!$._lock,$._lock||Gt(null,!0,!1));l!=null&&(Ls(cn,fn),zs(cn,i,de,ge,se,z,null))}function pa(l,a,d,g,v,S,T){if($._lock)return;Ht(l);let k=Dt;if(Dt){let M=!0,C=!0,D=10,V,j;L.ori==0?(V=Oe,j=Me):(V=Me,j=Oe),V&&j&&(M=de<=D||de>=se-D,C=ge<=D||ge>=z-D),V&&M&&(de=de<ss?0:se),j&&C&&(ge=ge<is?0:z),Gt(null,!0,!0),Dt=!1}de=-10,ge=-10,Gt(null,!0,!0),k&&(Dt=k)}function rl(l,a,d,g,v,S,T){$._lock||(Ht(l),Ri(),oi(),l!=null&&zs(fr,i,de,ge,se,z,null))}function ol(){x.forEach(Cu),Mi(i.width,i.height,!0)}Kt(hi,fs,ol);const os={};os.mousedown=nl,os.mousemove=Jn,os.mouseup=ll,os.dblclick=rl,os.setSeries=(l,a,d,g)=>{let v=we.match[2];d=v(i,a,d),d!=-1&&mt(d,g,!0,!1)},$.show&&(Qe(ar,y,nl),Qe(or,y,Jn),Qe(cr,y,l=>{Ht(l),Ns(!1)}),Qe(ur,y,pa),Qe(fr,y,rl),On.add(i),i.syncRect=Ns);const ai=i.hooks=e.hooks||{};function Ve(l,a,d){l in ai&&ai[l].forEach(g=>{g.call(null,i,a,d)})}(e.plugins||[]).forEach(l=>{for(let a in l.hooks)ai[a]=(ai[a]||[]).concat(l.hooks[a])});const al=(l,a,d)=>d,we=Ee({key:null,setSeries:!1,filters:{pub:Tr,sub:Tr},scales:[R,w[1]?w[1].scale:null],match:[Ar,Ar,al],values:[null,null]},$.sync);we.match.length==2&&we.match.push(al),$.sync=we;const cl=we.key,qi=co(cl);function zs(l,a,d,g,v,S,T){we.filters.pub(l,a,d,g,v,S,T)&&qi.pub(l,a,d,g,v,S,T)}qi.sub(i);function da(l,a,d,g,v,S,T){we.filters.sub(l,a,d,g,v,S,T)&&os[l](null,a,d,g,v,S,T)}i.pub=da;function ga(){qi.unsub(i),On.delete(i),zt.clear(),gn(hi,fs,ol),p.remove(),te?.remove(),Ve("destroy")}i.destroy=ga;function Zi(){Ve("init",e,t),Hn(t||e.data,!1),Y[R]?Wi(R,Y[R]):Ri(),Oi=ze.show&&(ze.width>0||ze.height>0),rt=et=!0,Mi(e.width,e.height)}return w.forEach(zn),x.forEach(jo),s?s instanceof HTMLElement?(s.appendChild(p),Zi()):s(i,Zi):Zi(),i}ee.assign=Ee,ee.fmtNum=_n,ee.rangeNum=gi,ee.rangeLog=di,ee.rangeAsinh=mn,ee.orient=Qt,ee.pxRatio=le,ee.join=Ac,ee.fmtDate=yn,ee.tzDate=Cc,ee.sync=co;{ee.addGap=yu,ee.clipGaps=Ti;let e=ee.paths={points:vo};e.linear=So,e.stepped=Eu,e.bars=Tu,e.spline=Lu}var Lo={ru:{"hide-all":"\u0421\u043A\u0440\u044B\u0442\u044C \u0432\u0441\u0435","show-all":"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0432\u0441\u0435",sum:"\u0421\u0443\u043C\u043C\u0430",scale:"\u0428\u043A\u0430\u043B\u0430",series:"\u041B\u0438\u043D\u0438\u044F",weekend:"\u0412\u044B\u0445\u043E\u0434\u043D\u043E\u0439",nodata:"\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445"},en:{"hide-all":"Hide all","show-all":"Show all",sum:"Total",scale:"Scale",series:"Series",weekend:"Weekend",nodata:"No data"}},Io=(e="en")=>(typeof e!="string"&&(Lo.custom=e,e="custom"),t=>Lo[e][t]||t),Nu={size:["height","width"],clientSize:["clientHeight","clientWidth"],offsetSize:["offsetHeight","offsetWidth"],maxSize:["maxHeight","maxWidth"],before:["top","left"],marginBefore:["marginTop","marginLeft"],after:["bottom","right"],marginAfter:["marginBottom","marginRight"],scrollOffset:["pageYOffset","pageXOffset"],offset:["offsetY","offsetY"],offsetOpt:["yOffset","xOffset"]};function ko(e){return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}function zu(e,t,s="bottom",i={}){let n;t instanceof Element||t instanceof Range?n=ko(e.getBoundingClientRect()):n=t;const r=Object.assign({top:n.bottom||0,bottom:n.top||0,left:n.right||0,right:n.left||0},n),o={top:0,left:0,bottom:window.innerHeight,right:window.innerWidth};i.bound&&((i.bound instanceof Element||i.bound instanceof Range)&&(i.bound=ko(i.bound.getBoundingClientRect())),Object.assign(o,i.bound));const u=getComputedStyle(e),{primary:c,secondary:f}=Object.entries(Nu).reduce((N,[P,L])=>({primary:{...N.primary,[P]:L[s==="top"||s==="bottom"?0:1]},secondary:{...N.secondary,[P]:L[s==="top"||s==="bottom"?1:0]}}),{primary:{},secondary:{}});e.style.position="absolute",e.style.maxWidth="",e.style.maxHeight="";const p=i[c.offsetOpt]||0,m=parseInt(u[f.marginBefore],10),h=parseInt(u[f.marginAfter],10),b=m+h,_=o[f.after]-o[f.before]-b,y=parseInt(u[f.maxSize],10);(!y||_<y)&&(e.style[f.maxSize]=Pt(_));const A=parseInt(u[c.marginBefore],10)+parseInt(u[c.marginAfter],10),I=r[c.before]-o[c.before]-A,O=o[c.after]-r[c.after]-A-p;(s===c.before&&e[c.offsetSize]>I||s===c.after&&e[c.offsetSize]>O)&&(s=I>O?c.before:c.after);const w=s===c.before?I:O,x=parseInt(u[c.maxSize],10);(!x||w<x)&&(e.style[c.maxSize]=Pt(w));const E=window[c.scrollOffset],F=N=>Math.max(o[c.before],Math.min(N,o[c.after]-e[c.offsetSize]-A)),R=N=>Math.max(o[f.before],Math.min(N,o[f.after]-e[f.offsetSize]-b));s===c.before?(e.style[c.before]=E+F(r[c.before]-e[c.offsetSize]-A)-p+"px",e.style[c.after]="auto"):(e.style[c.before]=Pt(E+F(r[c.after])+p),e.style[c.after]="auto");const U=window[f.scrollOffset];return e.style[f.before]=Pt(U+R(r[f.before]-m)),e.style[f.after]="auto",e.dataset.side=s,{side:s,anchorRect:r,boundRect:o}}function ft(e,t){return typeof e=="object"?e[t]:e}function Vu(e){const t=document.createElement("span");return t.innerText=e,t.innerHTML}function Hu(e,t,s){const i=e.slice(0,ft(t.maxLines,s));return i.map(({value:n,name:r="unnamed",color:o,active:u,transformed:c,seriesIdx:f},p)=>{const m=`
<span class="yagr-tooltip__val">${n}</span>
    ${typeof c=="number"?`<span class="yagr-tooltip__tf">${c.toFixed(2)}</span>`:""}
`;return`
<div class="yagr-tooltip__item ${u?"_active":""}" data-series="${f}">
    ${t.showIndicies?`<span class="yagr-tooltip__idx">${e.length-p}</span>`:""}
    <span class="yagr-tooltip__mark" style="background-color: ${o}"></span>${Vu(r)}&nbsp;&nbsp;${m}
</div>`}).join("")+(e.length>i.length?`<div class="yagr-tooltip__item _more">+${e.length-i.length}</div>`:"")}function Rn(e){if(e.scales.length===0)return e.yagr.utils.i18n("nodata");const[t,s]=e.options.title?typeof e.options.title=="string"?[e.options.title,!1]:["",!0]:["",!1],i=e.scales.map(n=>{const r=ft(e.options.title,n.scale),o=e.scales.length>1?e.options.scales?`${ft(e.options.scales,n.scale)||""}`:`${e.yagr.utils.i18n("scale")}: ${n.scale}`:"";return`
<div class="__section" data-scale=${n.scale}>
    ${s&&r?`<div class="_section_title">${r}</div>`:""}
    ${o?`<div class="__section_scale">${o}</div>`:""}
    <div class="__section_body">${Hu(n.rows,e.options,n.scale)}</div>
    ${ft(e.options.sum,n.scale)?`
        <div class="__section_sum">
            ${e.yagr.utils.i18n("sum")}: ${n.sum}
        </div>
    `:""}
</div>`});return`${t?`<div class="__title">${t}</div>`:""}${i.join("")}`}var Uu=(e,t,s,i,n)=>{const r=Array.isArray(s.$c)?s.$c:t;let o=r[i];if(n&&o===n.value){const u=n.snapToValues??"closest",c=fi(r,s,i,u,n.value);o=r[c]}else if(o===null){const u=e.snapToValues??"closest",c=s.snapToValues??u,f=fi(r,s,i,c,null);o=r[f]}return o},Pn={maxLines:Yl,highlight:!0,sum:!1,render:Rn,pinable:!0,strategy:"pin",sort:void 0,showIndicies:!1,hideNoData:!1,className:"yagr-tooltip_default",xOffset:Wl,yOffset:$l,virtual:!1,showEmpty:!1,onUpdate:"reset"},Bu=class{constructor(e,t={}){this.handlers={init:[],mount:[],show:[],pin:[],unpin:[],hide:[],render:[],destroy:[],reset:[]},this.placement=zu,this.renderTooltipCloses=()=>{},this.skipNextMouseUp=!1,this.emit=(s,i)=>{this.handlers[s].forEach(n=>{n(this.tOverlay,{state:this.state,actions:{pin:this.pin,show:this.show,hide:this.hide,dispose:this.dispose,reset:this.reset},data:i,yagr:this.yagr,event:s})})},this.reset=()=>{if(this.opts.onUpdate==="none"){this.yagr.plugins.cursor?.pin(!1);return}this.state.visible&&this.hide(),this.state.pinned&&this.pin(!1),this.emit("reset")},this.show=()=>{const s=!this.state.visible;this.state.visible=!0,this.tOverlay.style.display="block",s&&this.emit("show")},this.hide=()=>{const s=this.state.visible;this.state.visible=!1,this.tOverlay.style.display="none",this.emit("hide"),s&&this.emit("show")},this.pin=(s,i)=>{this.state.pinned=s;const n=this.state.range||[];if(this.yagr.plugins.cursor?.pin(s&&(n[1]===null||n.length<2)),this.opts.virtual)return this.emit(s?"pin":"unpin");i&&this.placement(this.tOverlay,{left:i.x+this.bLeft,top:this.bTop+i.y-(this.opts.yOffset||0)},"right",{bound:this.bound,xOffset:this.opts.xOffset,yOffset:this.opts.yOffset});const r=this.tOverlay.querySelector("._tooltip-list");s?(this.state.visible||this.show(),this.tOverlay.classList.add("yagr-tooltip_pinned"),r&&r?.clientHeight&&(r.style.height=Pt(r.clientHeight)),this.opts.render===Rn&&(document.addEventListener("mousemove",this.checkFocus),document.addEventListener("mousedown",this.detectClickOutside))):(this.tOverlay.classList.remove("yagr-tooltip_pinned"),this.opts.render===Rn&&(document.removeEventListener("mousemove",this.checkFocus),document.removeEventListener("mousedown",this.detectClickOutside))),this.emit(s?"pin":"unpin")},this.checkFocus=s=>{const i=s.target;let n;i&&this.tOverlay.contains(i)&&i.classList.contains("yagr-tooltip__item")&&(n=i.dataset.series);const r=n?this.yagr.uplot.series[Number(n)]:null;n&&r?(this.state.focusedSeries=n,this.yagr.setFocus(r.id,!0)):this.state.focusedSeries&&(this.state.focusedSeries=null,this.yagr.setFocus(null,!0))},this.render=s=>{const i=this.yagr.uplot;let{left:n,top:r}=s;const{idx:o}=s,{opts:u,state:c}=this;if(u.show&&typeof u.show=="function"&&u.show(this.yagr)===!1){this.hide();return}(n<0||r<0)&&!c.pinned&&this.isNotInDrag&&this.hide(),r=Jl(r,0,i.bbox.top+i.bbox.height),n=Jl(n,0,i.bbox.left+i.bbox.width);const{data:f}=i;if(f===null||jt(o)||r===void 0)return;const p=f[0][o],m={},h={},b={};let _=i.series.length-1;for(;_>=1;){const w=i.series[_];if(!w.show){_-=1;continue}const x=w.scale||_t;b[x]=b[x]||[],b[x].push(_),_-=1}if(Object.entries(b).forEach(([w,x])=>{h[w]=h[w]||{rows:[]};const E=h[w],F=Number(i.posToVal(r,w).toFixed(2)),R=ft(u.value,w);for(const N of x){const P=i.data[N],L=i.series[N];let H=Uu(this.yagr.config.cursor,P,L,o,this.interpolation),X=H;typeof H=="string"&&(X=H,H=null),ft(u.sum,w)&&(m[w]=m[w]||0,m[w]+=H||0);const K=P[o],Y=L.$c&&L.$c[o]===this.stripValue?H:K;if(H===null&&u.hideNoData||L.showInTooltip===!1)continue;const oe=L.precision??ft(u.precision,w),W=L.formatter?L.formatter(X,L):R(X,oe),Pe={id:L.id,name:L.name,dataValue:L.$c[o],originalValue:H,value:W,y:Y,displayY:K,color:L.color,seriesIdx:N,rowIdx:E.rows.length?E.rows[E.rows.length-1].rowIdx+1:0};L.normalizedData&&(Pe.transformed=L.normalizedData[o]),L._transformed&&(Pe.transformed=P[o]),!(u.omitBy&&u.omitBy(Pe))&&E.rows.push(Pe)}if(ft(u.highlight,w)&&E.rows.length){const N=ft(u.tracking,w);let P=0;N==="area"?P=Ta(E,F,ft(u.stickToRanges,w)):N==="sticky"?P=La(E,F):typeof N=="function"&&(P=N(E,F,{x:i.posToVal(n,"x"),y:i.posToVal(r,w),idx:o,scale:w,series:this.yagr.series,serieIndicies:x,interpolation:this.interpolation})),P!==null&&(E.rows[P].active=!0)}const U=ft(u.sort,w);U&&E.rows.sort(U)}),Object.values(h).some(({rows:w})=>w.length>0)||u.showEmpty)this.onMouseEnter();else{this.hide();return}const I=this.over.getBoundingClientRect();this.bLeft=I.left,this.bTop=I.top,this.bWidth=I.width;const O={left:n+this.bLeft,top:this.bTop+r-(u.yOffset||0)};this.renderTooltipCloses=()=>{const w={scales:Object.entries(h).map(([E,F])=>({scale:E,rows:F.rows,sum:m[E]})),options:u,x:p};if(!Object.values(h).some(({rows:E})=>E.filter(({id:F})=>this.yagr.getSeriesById(F)?.show).length>0)&&!u.showEmpty){this.hide();return}u.virtual||(this.tOverlay.innerHTML=u.render({...w,state:c,yagr:this.yagr,defaultRender:Pn.render}),this.placement(this.tOverlay,O,"right",{bound:this.bound,xOffset:u.xOffset,yOffset:u.yOffset})),this.emit("render",{...w,anchor:O})},!c.pinned&&this.renderTooltipCloses()},this.initWithUplot=s=>{this.over=s.root.querySelector(".u-over"),this.over.addEventListener("mousedown",this.onMouseDown),this.over.addEventListener("mousemove",this.onMouseMove),this.over.addEventListener("mouseenter",this.onMouseEnter),this.over.addEventListener("mouseleave",this.onMouseLeave),document.addEventListener("mouseup",this.onMouseUp)},this.setSize=()=>{const s=this.over.getBoundingClientRect();this.bLeft=s.left,this.bTop=s.top},this.dispose=()=>{this.over.removeEventListener("mousedown",this.onMouseDown),this.over.removeEventListener("mousemove",this.onMouseMove),this.over.removeEventListener("mouseenter",this.onMouseEnter),this.over.removeEventListener("mouseleave",this.onMouseLeave),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.checkFocus),document.removeEventListener("mousedown",this.detectClickOutside),this.tOverlay.remove(),this.state.mounted=!1,this.emit("destroy")},this.updateOptions=s=>{Object.assign(this.opts,s),this.tOverlay.className=`yagr-tooltip ${this.opts.className||""}`},this.on=(s,i)=>{this.handlers[s].push(i)},this.off=(s,i)=>{this.handlers[s]=this.handlers[s].filter(n=>n!==i)},this.detectClickOutside=s=>{const i=s.target;if(i instanceof Element){const n=i&&this.tOverlay.contains(i),r=i&&this.over.contains(i);!n&&!r&&(this.pin(!1),this.hide())}},this.onMouseDown=s=>{this.state.range=[this.getCursorPosition(),null],this.state.pinned&&(this.pin(!1),this.hide(),this.render({left:s.clientX-this.bLeft,top:s.clientY-this.bTop,idx:this.yagr.uplot.posToIdx(s.clientX-this.bLeft)}),this.skipNextMouseUp=!0)},this.onMouseMove=()=>{this.state.range?.length&&(this.state.range[1]=this.getCursorPosition())},this.setCursorLeaved=s=>{const i=this.over.getBoundingClientRect(),n=s.clientX,r=this.state.range,o=r[0],c=n-i.left>o.clientX,f=this.yagr.config.timeline;let p;c?(r[1]={clientX:this.bWidth,value:this.yagr.uplot.posToVal(this.bWidth,"x"),idx:f.length-1},p=r[1]):(r[1]=r[0],r[0]={clientX:0,value:this.yagr.uplot.posToVal(0,"x"),idx:0},p=r[0]),this.yagr.uplot.setCursor({left:p.clientX,top:s.clientY-i.top})},this.onMouseUp=s=>{if(this.state.range===null)return;const[i]=this.state.range||[];let n;if(s.target===this.over?n=this.getCursorPosition():n=this.state.range[1],this.opts.strategy==="none")return;const r=i&&i.clientX===n?.clientX,o=i&&i.clientX!==n?.clientX,u=this.opts.strategy;(r&&!this.skipNextMouseUp&&u!=="drag"||o&&(u==="all"||u==="drag"))&&(this.pin(!this.state.pinned),this.show(),this.renderTooltipCloses()),this.state.range=null,this.skipNextMouseUp=!1},this.onMouseEnter=()=>{this.show()},this.onMouseLeave=s=>{const i=this.state.pinned;this.state.range?.[0]&&this.setCursorLeaved(s),!i&&this.isNotInDrag&&this.hide()},this.defaultTooltipValueFormatter=(s,i)=>{const n=this.yagr.config.processing||{};return typeof s=="string"?n.nullValues&&n.nullValues.hasOwnProperty(s)?n.nullValues[s]:"-":typeof s=="number"?s.toFixed(typeof i=="number"?i:typeof this.opts.precision=="number"?this.opts.precision:2):"-"},this.getCursorPosition=()=>{const s=this.yagr.uplot.cursor.left;return s===void 0?null:{clientX:s,value:this.yagr.uplot.posToVal(s,"x"),idx:this.yagr.uplot.posToIdx(s)}},this.yagr=e,this.over=e?.uplot?.over,this.opts={...Pn,strategy:t.pinable?"pin":Pn.strategy,tracking:e.config.chart.series?.type==="area"?"area":"sticky",value:this.defaultTooltipValueFormatter,...t},this.bound=this.opts.boundClassName&&document.querySelector(this.opts.boundClassName)||document.body,this.renderNode=this.opts.renderClassName&&document.querySelector(this.opts.renderClassName)||document.body,this.tOverlay=document.createElement("div"),this.tOverlay.id=`${e.id}_tooltip`,this.tOverlay.className=`yagr-tooltip ${this.opts.className||""}`,this.tOverlay.style.display="none",this.state={mounted:!1,pinned:!1,visible:!1,range:null,focusedSeries:null},this.bLeft=0,this.bTop=0,this.bWidth=0,this.opts.virtual?this.placement=()=>{}:(this.renderNode.appendChild(this.tOverlay),this.state.mounted=!0,this.emit("mount"))}get interpolation(){return this.yagr.config.processing?.interpolation}get stripValue(){return this.interpolation?this.interpolation.value:void 0}get isNotInDrag(){return this.opts.strategy==="none"||this.opts.strategy==="pin"?!0:!this.state.range?.[1]}};function Gu(e,t={}){const s=new Bu(e,t),i=()=>({hooks:{init:o=>{s.initWithUplot(o)},setSize:()=>{s.setSize()},setCursor:o=>{s.render(o.cursor)}}}),n=i();function r(o){const u=i();s.reset(),o.hooks.init.push(u.hooks.init),o.hooks.setSize.push(u.hooks.setSize),o.hooks.setCursor.push(u.hooks.setCursor)}return{state:s.state,pin:s.pin,show:s.show,hide:s.hide,uplot:n,display:s.render,updateOptions:s.updateOptions,on:s.on,off:s.off,tooltip:s,dispose:s.dispose,reInit:r,reset:s.reset}}var $u=Gu,xo=(e,t,s,i,n,r,o,u)=>{const{ctx:c}=e,f=Math.round(e.valToPos(t,Ae,!0)),p=Math.round(e.valToPos(s,u||_t,!0));if(c.beginPath(),c.arc(f,p,i*2,0,2*Math.PI),c.fillStyle=r,n){const m=c.lineWidth,h=c.strokeStyle;c.lineWidth=n,c.strokeStyle=o,c.stroke(),c.lineWidth=m,c.strokeStyle=h}c.fill(),c.closePath()};function Do(e,t,s,i){const{color:n,scale:r,spanGaps:o,count:u,pointsSize:c}=e.series[t];if(o&&u>1)return!1;let f=s,p;for(;f<=i;){const m=e.data[t][f];if(m===null){p=m,f++;continue}const h=f+1,b=e.data[t][h];jt(p)&&jt(b)&&xo(e,e.data[0][f],m,c??Hs/2,0,n,n,r||_t),p=m,f++}}function Wu(e,t){const{size:s=Hs,strokeWidth:i=2,strokeColor:n="#ffffff",show:r}=t.markers,u=t.chart?.series?.pointsSize||Hs;function c(p,m,h,b){const{scale:_,_focus:y,color:A,getFocusedColor:I,type:O}=p.series[m];let w=h;const x=O==="dots"?r?s:u:s;for(;w<=b;){const E=p.data[m][w];E!==null&&xo(p,p.data[0][w],E,x,i,(y||y===null?A:I(e,m))||A,n,_||_t),w++}}const f=(p,m)=>{p===0||p===null||(m.type==="dots"||t.markers.show)&&(m.points=m.points||{},m.points.show=c)};return{opts:(p,m)=>{(t.markers.show||m.series.some(h=>h.type==="dots"))&&m.series.forEach((h,b)=>f(b,h))},hooks:{addSeries:(p,m)=>{const h=p.series[m];f(m,h)},setSeries:(p,m,h)=>{f(m,h)}}}}function Yu(e,t,s,i){const n=e.series[t],{type:r,interpolation:o}=n;let u;switch(r){case"column":{u=ee.paths.bars&&ee.paths.bars({size:[Rl,Pl],...e.series[t].renderOptions||{}});break}case"dots":{u=()=>null;break}case"line":case"area":default:switch(o){case"smooth":u=ee.paths.spline&&ee.paths.spline();break;case"left":u=ee.paths.stepped&&ee.paths.stepped({align:1});break;case"right":{u=ee.paths.stepped&&ee.paths.stepped({align:-1});break}case"linear":default:u=ee.paths.linear&&ee.paths.linear();break}}return u?u(e,t,s,i):null}function St(e,t,s,i){if(e[s]!==void 0)return e[s];const n=t.config.chart.series;return n&&s in n?n[s]:i}function Fn(e,t,s){const i=St(t,e,"type","line"),n={...t,type:i,show:t.show??!0,name:t.name||`${e.utils.i18n("series")} ${s+1}`,color:t.color?e.utils.colors.parse(t.color):e.utils.theme.DEFAULT_LINE_COLOR,id:(t.id===void 0?t.name:String(t.id))||Kl(),$c:t.data,scale:t.scale||_t,count:0,sum:0,avg:0,getFocusedColor:Ea};n.points=n.points||{};const r=jl(e,"color");return n.type==="area"&&(n.lineColor=e.utils.colors.parse(St(t,e,"lineColor",Vl)),n.lineWidth=St(t,e,"lineWidth",Hl),n.fill=r,n.stroke=jl(e,"lineColor"),n.width=n.lineWidth,n.points.show=Do,n.interpolation=St(t,e,"interpolation","linear"),n.spanGaps=St(t,e,"spanGaps",!1)),n.type==="line"&&(n.width=St(t,e,"width",nn),n.width=n.width||nn,n.stroke=r,n.points.show=Do,n.interpolation=St(t,e,"interpolation","linear"),n.spanGaps=St(t,e,"spanGaps",!1)),n.type==="column"&&(n.stroke=r,n.fill=r,n.points.show=!1,n.width=n.width??0,n.renderOptions=St(n,e,"renderOptions")),n.type==="dots"&&(n.stroke=()=>n.color,n.fill=r,n.width=2,n.pointsSize=St(n,e,"pointsSize",Hs)),n.paths=Yu,n}var Oo=(e,t)=>{e.$c=t.$c??e.$c,e.show=t.show??e.show,e.data=t.data??e.data,e.width=t.width??e.width,e.pointsSize=t.pointsSize??e.pointsSize,e.color=t.color??e.color,e.lineColor=t.lineColor??e.lineColor,e.lineWidth=t.lineWidth??e.lineWidth,e.stroke=t.stroke??e.stroke,e.getFocusedColor=t.getFocusedColor??e.getFocusedColor,e.formatter=t.formatter??e.formatter,e.paths=t.paths??e.paths},Es={Series:"series",Axes:"axes"},ju={Distr:{Linear:1,Ordinal:2,Logarithmic:3,ArcSinh:4}},es={Side:{Top:0,Right:1,Bottom:2,Left:3},Align:{Right:0,Left:1}},Mo=(e,t)=>{const s=e.range;if(typeof s=="function")return(n,r,o)=>s(n,r,o,t);if(e.normalize)return[0,e.normalizeBase||100];if(e.range==="auto")return;let i;switch(e.range){case void 0:case"nice":{i=Ku;break}case"offset":{i=Xu;break}default:throw new Error(`Unknown scale range type ${e.range}`)}return(n,r,o)=>{let{min:u,max:c}=i(r,o,e,t);const f=e.minRange||vl;if(Math.abs(c-u)<f&&(u>=0?c+=f:(c+=f/2,u-=f/2)),u=typeof e.min=="number"?e.min:u,c=typeof e.max=="number"?e.max:c,e.type==="logarithmic"){const p=typeof e.min=="number";u<=0?u=en:p||(u=Math.min(u,en))}return(u>=c||c<=u)&&(typeof e.max=="number"?u=c-(ki(c-c*.1,!1)||1):c=u+(ki(u+u*.1,!1)||1)),[u,c]}};function Xu(e,t,s){const i=e>=0&&s.stacking,n=t<=0&&s.stacking;return{min:i?0:Math.round(e-Math.abs(e)*(s.offset||Qi)),max:n?0:Math.round(t+Math.abs(t)*(s.offset||Qi))}}function Ku(e,t,s){const i=e>=0&&s.stacking,r=t<=0&&s.stacking?0:typeof s.max=="number"?s.max:t,o=i?0:typeof s.min=="number"?s.min:e;if(o===r)return o>=0?{min:o,max:o+2}:{min:o-1,max:o+1};const u=r-o,c=ki(u,!1),f=ki(c/(ml-1),!0);let p=Math.ceil(r/f)*f;p=isNaN(p)?100:p;let m=(i?Math.min(0,o):Math.floor(o/f)*f)||0;return m===p&&(m-=1,p+=1),{min:m,max:p}}function ki(e,t){const s=Math.floor(Math.log10(e)),i=e/10**s;return(t?i<1.5?1:i<3?2:i<7?5:10:i<=1?1:i<=2?2:i<=5?5:10)*10**s}function qu(e,t,s){const i=s.scales?{...s.scales}:{};return Object.keys(s.scales).length||(i.y={}),Object.entries(i).forEach(([n,r])=>{t[n]=t[n]||{};const o=t[n];if(n===Ae)return;const u=typeof r.min=="number"?r.min:null,c=typeof r.max=="number"?r.max:null;if(c!==null&&u!==null){if(c<=u)throw new Error("Invalid scale config. .max should be > .min");o.range=[u,c]}const f=r.type==="logarithmic";if(f){o.distr=ju.Distr.Logarithmic,o.range=Mo(r,s);return}if(e.isEmpty){o.range=[u===null?f?1:0:u,c===null?100:c];return}o.range=Mo(r,s)}),t.x||(t.x={time:!0}),t}var Zu={right:es.Side.Right,top:es.Side.Top,bottom:es.Side.Bottom,left:es.Side.Left},Ju={left:es.Align.Right,right:es.Align.Left,top:void 0,bottom:void 0},Qu=(e,t)=>({side:e?Zu[e]:es.Side.Left,align:t||(e?Ju[e]:void 0)}),Ro=(e,t="")=>s=>{if(jt(s))return t;if(s===0)return"0";const i=Math.abs(s),n=e==="auto"?2:e,[r,o]=Ia(i),u=s/r;return(e==="auto"?String(u).replace(/\.(\d{5,})/,c=>c.slice(0,6)):ka(u,n))+o},ef=e=>{const t=e.precision,s=Ro(typeof t=="number"?t:t||"auto","");return function(n,r){return r.map(s)}},tf=ee.fmtDate("{DD}.{MM}.{YYYY}"),sf=ee.fmtDate("{HH}:{mm}:{ss}"),nf=ee.fmtDate("{mm}:{ss}"),lf=ee.fmtDate("{mm}:{ss}.{fff}"),rf=ee.fmtDate("{YYYY}");function Po(e,t){let s=tf;const i=Math.ceil(e/t);return i<=Tt?s=lf:i<=$t?s=nf:i<=Ke?s=sf:i>=Wt&&(s=rf),n=>s(new Date(n))}var of=e=>{const t=e.chart.timeMultiplier||Us;return(s,i)=>{const r=(i[i.length-1]-i[0])/t,o=Po(r,i.length);return i.map(u=>o(u/t))}};function af(e){return(t,s,i,n)=>{if(e<=2)return[i,n];const o=Math.abs(n-i)/(e-1);let u=o;const c=[];for(;i+u<n;)c.push(i+u),u+=o;return[i,...c,n]}}function xi(e,t){const s=t.utils.theme,i=t.config,n={splits:e.splitsCount?af(e.splitsCount):e.splits,show:typeof e.show>"u"?!0:e.show,label:e.label||void 0,labelSize:e.labelSize||kl,labelFont:e.labelFont||tn,font:e.font||sn,stroke:e.stroke||(()=>s.AXIS_STROKE),ticks:e.ticks?{...s.Y_AXIS_TICKS,...e.ticks}:s.Y_AXIS_TICKS,grid:i.grid||e.grid||s.GRID};return e.scale===Ae?Object.assign(n,{getFormatter:Po,gap:e.gap??xl,size:Zl(e.size)||(()=>Dl),values:e.values||of(i),ticks:e.ticks?{...s.X_AXIS_TICKS,...e.ticks}:s.X_AXIS_TICKS,scale:Ae,space:e.space||(()=>Ol),incrs:e.incrs||(()=>Ml.map(r=>r*(i.chart.timeMultiplier||Us))),side:2,stroke:e.stroke||(()=>s.AXIS_STROKE)}):(Object.assign(n,{gap:e.gap??El,size:Zl(e.size)||Il,values:e.values||ef(e),scale:e.scale||_t,getFormatter:()=>Ro(typeof e.precision=="number"?e.precision:e.precision||"auto",""),...Qu(e.side||"left",e.align)}),e.space&&(n.space=e.space),n)}function cf(e){const t=[!1,!0];return Object.values(e).forEach(s=>{["align","side","size","label","labelFont","labelGap","labelSize"].some(n=>s[n]!==void 0)&&(t[1]=!0)}),t}function Fo(e){let t,s;return e=e.replace(/(\d+)px/,(i,n)=>Pt(t=Math.round((s=Number(n))*window.devicePixelRatio))),[e,t,s]}function Co(e,t,s){const i=xi({...s,font:t.font},e);i.ticks={...t.ticks,...i.ticks},i.grid={...t.grid,...i.grid},i.border={...t.border,...i.border},i.splits=i.splits||t.splits,s.font&&s.font!==t.font?.[0]&&(i.font=Fo(s.font)),s.labelFont&&s.labelFont!==t.labelFont?.[0]&&(i.labelFont=Fo(s.labelFont)),Object.assign(t,i),e.plugins.plotLines?.update(s.plotLines,s.scale)}function uf(e,t){const s=[];Object.entries(t.axes).forEach(([r,o])=>{s.push(xi({...o,scale:r},e))});const i=Ae,n=_t;return t.axes[i]||s.push(xi({scale:i},e)),s.find(({scale:r})=>r!==i)||s.push(xi({scale:n},e)),s}function ff(e){let t=!1,s=!1;return e.axes?e.axes.forEach(i=>{i.scale!==Ae&&((i.side===void 0||i.side===3)&&(t=!0),i.side===1&&(s=!0))}):t=!0,t&&!s?Fl:s&&!t?Cl:Nl}var hf=0,pf={[Es.Series]:0,[Es.Axes]:1,plotLines:2};function Cn(e,t){return e.some(s=>Bs(s,t))}var df={"012":"draw",102:"draw",201:"drawClear",210:"drawClear",120:"drawAxes","021":"drawSeries"};function gf(e){let t=[];return function(s){const i=s.config.chart.appearance?.drawOrder,n=(i?i.map(f=>pf[f]):[0,1,2]).join(""),r=df[n]||"drawClear";function o(f){const{ctx:p}=f,{height:m,top:h,width:b,left:_}=f.bbox,y=f.data[0];for(const A of t){if(!A.scale)continue;if(e.render){e.render(f,A);continue}p.save(),p.fillStyle=s.utils.colors.parse(A.color);const{scale:I,value:O}=A;if(Array.isArray(O)){const[w,x]=O.map(U=>{if(Math.abs(U)!==1/0){if(I===Ae){if(U<y[0])return y[0];if(U>y[y.length-1])return y[y.length-1]}else{const P=f.scales[I];if(P.min!==void 0&&U<P.min)return P.min;if(P.max!==void 0&&U>P.max)return P.max}return U}const N=U>0?I===Ae?f.width:0:I===Ae?0:f.height;return f.posToVal(N,I)}),E=f.valToPos(w,I,!0),F=f.valToPos(x,I,!0),R=A.accent;I===Ae?(p.fillRect(E,h,F-E,m),R&&(p.fillStyle=R.color,p.fillRect(E,h-R.space,F-E,R.space))):(p.fillRect(_,E,b,F-E),R&&(p.fillStyle=R.color,p.fillRect(b+_,E,R.space,F-E)))}else{const w=f.valToPos(O,I,!0),x=A;if(p.beginPath(),I===Ae){const E=f.data[0][f.data[0].length-1],F=f.valToPos(E,I,!0);if(w-F>hf)continue;p.moveTo(w,h),p.lineTo(w,m+h)}else p.moveTo(_,w),p.lineTo(b+_,w);p.lineWidth=x.width||tt,p.strokeStyle=x.color||"#000",x.dash&&p.setLineDash(x.dash),p.closePath(),p.stroke()}p.restore()}}const u=r==="drawSeries"?(f,p)=>{p===f.series.length-1&&o(f)}:o,c={get:()=>t,clear:f=>{t=f?t.filter(p=>p.scale!==f):[]},remove:f=>{t=t.filter(p=>!Cn(f,p))},add:(f,p)=>{for(const m of f)t.push(p?{scale:p,...m}:m)},update:(f,p)=>{if(!f||f.length===0){c.clear(p);return}const m=f.filter(b=>!Cn(t,b)),h=t.filter(b=>!Cn(f,b));m.length&&c.add(m,p),h.length&&c.remove(h)},uplot:{opts:()=>{const f=s.config;t=[],Object.entries(f.axes).forEach(([p,m])=>{m.plotLines&&m.plotLines.forEach(h=>{t.push({...h,scale:p})})})},hooks:{[r]:u}}};return c}}function Di(e,t){for(const s of e||[])if(s===t)return;e?.push(t)}var mf=class{initMixin(){this._uHooks.onDraw=()=>{if(this.state.stage==="listen")return;this.state.stage="listen",this.execHooks("stage",{chart:this,stage:this.state.stage});const e=performance.now()-this._startTime;this._meta.renderTime=e,this.execHooks("load",{chart:this,meta:this._meta})},this._uHooks.ready=()=>{const e=performance.now()-this._startTime;this._meta.initTime=e,this.execHooks("inited",{chart:this,meta:{initTime:e}})},this._uHooks.drawClear=e=>{const{ctx:t}=e;t.save(),t.fillStyle=this.utils.theme.BACKGROUND,t.fillRect(tt,tt,e.width*tt-2*tt,e.height*tt-2*tt),t.restore()},this._uHooks.setSelect=e=>{const{left:t,width:s}=e.select,[i,n]=[e.posToVal(t,Ae),e.posToVal(t+s,Ae)],{timeMultiplier:r=Us}=this.config.chart||{};this.execHooks("onSelect",{from:Math.ceil(i/r),to:Math.ceil(n/r),chart:this}),e.setSelect({width:0,height:0,top:0,left:0},!1)}}createUplotOptions(e=!1){const{config:t}=this,s=[];let i=this.plugins?.tooltip;if(t.tooltip&&t.tooltip.show!==!1&&(i?i.updateOptions(t.tooltip):i=$u(this,t.tooltip),s.push(i.uplot),this.plugins.tooltip=i),e)this.plugins.plotLines&&s.push(this.plugins.plotLines.uplot);else{const p=gf(this.config.plotLines||{})(this);this.plugins.plotLines=p,s.push(p.uplot)}Object.entries(t.plugins).forEach(([p,m])=>{const h=m(this);s.push(h.uplot),Object.assign(this.plugins,{[p]:h})});const n=t.chart,r={width:this.root.clientWidth,height:this.clientHeight,title:t.title?.text,plugins:s,focus:{alpha:gl},series:[{id:Ji,$c:t.timeline,scale:Ae,count:t.timeline.length}],ms:n.timeMultiplier||Us,hooks:t.hooks||{}};if(this.state.isEmptyDataSet=t.timeline.length===0||t.series.length===0||t.series.every(({data:p})=>p.length===0),r.cursor=r.cursor||{},r.cursor.points=r.cursor.points||{},r.cursor.drag=r.cursor.drag||{dist:n.select?.minWidth||Bl,x:r.cursor.y??!0,y:r.cursor.y??!1,setScale:n.select?.zoom??!0},this.utils.sync&&(r.cursor.sync=r.cursor.sync||{key:this.utils.sync.key}),t.cursor){const p=Ra(this,t.cursor);this.plugins.cursor=p,s.push(p.uplot)}const o=t.series||[],u=r.series;for(let p=o.length-1;p>=0;p--){const m=Fn(this,o[p]||{},p),h=u.push(m);this.state.y2uIdx[m.id||p]=h-1}const c=Wu(this,t);return s.push(c),r.series=u,(!t.scales||Object.keys(t.scales).length===0)&&(t.scales={x:{},y:{}}),r.scales=r.scales||{},r.scales=qu(this,r.scales,t),r.axes=r.axes||[],r.axes.push(...uf(this,t)),r.hooks=t.hooks||{},r.hooks.draw=r.hooks.draw||[],r.hooks.ready=r.hooks.ready||[],r.hooks.drawClear=r.hooks.drawClear||[],r.hooks.setSelect=r.hooks.setSelect||[],Di(r.hooks.draw,this._uHooks.onDraw),Di(r.hooks.ready,this._uHooks.ready),Di(r.hooks.drawClear,this._uHooks.drawClear),Di(r.hooks.setSelect,this._uHooks.setSelect),r.drawOrder=n.appearance?.drawOrder?n.appearance?.drawOrder.filter(p=>p===Es.Series||p===Es.Axes):[Es.Series,Es.Axes],r.legend={show:!1},r.padding=t.chart.size?.padding||ff(r),this.plugins.legend?.preInit(this,this.config.legend,r),r.height=this.clientHeight,this.options=r,r}},vf=class{transformSeries(){const e=performance.now(),t=[],s=this.config,i=s.timeline;let n=s.processing||!1,r=this.config.series.map(({data:f})=>f);n&&n.interpolation&&(r=xa(r,i,n),n=!1);const o=!!(n&&n.nullValues),u=n&&n.nullValues||{},c={};for(let f=0;f<r.length;f++){let p=[];const m=f+1,h=r[f],b=this.options.series.length-m,_=this.options.series[b],y=_.scale||_t,A=this.config.scales[y]||{},I=A.stacking,O=_.stackGroup||0;let w=!0;I&&!c[y]&&(this.options.focus=this.options.focus||{alpha:1.1},this.options.focus.alpha=1.1,c[y]=[]),I&&!c[y][O]&&(c[y][O]=new Array(i.length).fill(0)),_.count=0;for(let x=0;x<h.length;x++){let E=h[x];if(o&&u[String(E)]&&(E=null),_.transform&&(_._transformed=!0,E=_.transform(E,r,x)),A.transform&&(_._transformed=!0,E=A.transform(E,r,x)),E===null)if(_.type==="line"||_.type==="dots"){p.push(null);continue}else E=I?0:null;if(w=!1,A.normalize){const R=Aa(this.options.series,x,y);E=R&&(E??0)/R*(A.normalizeBase||100),_.normalizedData=_.normalizedData||[],_.normalizedData[x]=E}A.stacking&&(_.show===!1&&(E=0),E=c[y][O][x]+=E??0),A.type==="logarithmic"&&E===0&&(E=1),_.sum=(_.sum||0)+(E||0),typeof _.$c[x]=="number"&&(_.count+=1),p.push(E)}_.avg=(_.sum||0)/_.count,_.empty=w,_.postProcess&&(p=_.postProcess(p,f,this)),t.unshift(p)}return t.unshift(this.config.timeline),this.series=t,this.execHooks("processed",{chart:this,meta:{processTime:performance.now()-e}}),this.series}};function _f(e,t,s){e.utils.i18n=Io(s),t.redrawLegend=!0}function Sf(e,t,s){e.utils.theme.setTheme(t);const n=["light","light-hc","dark","dark-hc"].map(r=>`yagr_theme_${r}`);e.root.classList.remove(...n),e.root.classList.add("yagr_theme_"+t),s.redraw=[!1,!0]}function yf(e,t,s){const{x:i,...n}=s;if(i){const r=e.uplot.axes.find(({scale:o})=>o===Ae);r&&Co(e,r,{scale:Ae,...i})}Object.entries(n).forEach(([r,o])=>{const u=e.uplot.axes.find(({scale:c})=>c===r);u&&Co(e,u,{scale:r,...o})}),t.redraw=cf(s)}function wf(e,t,s){const i=t===null?null:e.state.y2uIdx[t];e.plugins.cursor?.focus(i,s),e.uplot.setSeries(i,{focus:s})}function bf(e,t,s,i,n){const r=t===null?null:e.state.y2uIdx[t];(t===null?e.config.series:[e.config.series.find(({id:c})=>c===t)]).forEach(c=>{c&&(c.show=s)}),n.fns.push(()=>{e.uplot.setSeries(r,{show:s})}),e.options.series=e.uplot.series;let u=!1;if(r){const c=e.uplot.series[r];c.show=s;const f=c.scale||_t,p=e.config.scales[f];u=!!(p&&p.stacking)}else u=e.options.series.reduce((c,f)=>{const{scale:p}=f;return f.show=s,!!(p&&e.config.scales[p]?.stacking||c)},!1);u&&(n.recalc=!0,n.fns.push(()=>{e.uplot.setData(e.series,!0),i&&e.plugins.legend?.update()}))}function Ef(e,t,s){let i=!1,n=!1;Object.entries(t).forEach(([u,c])=>{const f=e.config.scales[u];if(f){const{stacking:p}=f,{stacking:m}=c;p!==m&&(i=!0),(c.normalize!==f.normalize||c.normalizeBase!==f.normalizeBase)&&(n=!0)}});const r=Object.entries(t).every(([u,c])=>{const f=e.config.scales[u],{min:p,max:m,...h}=f,{min:b,max:_,...y}=c;return!(Bs(y,h)===!1)&&(p!==b||m!==_)}),o=Object.keys(t).includes(Ae);if(r&&!o)return Object.entries(t).forEach(([u,c])=>{s.fns.push(()=>{e.uplot.setScale(u,{min:c.min,max:c.max})})});(i||n)&&(s.reinit=!0),e.config.scales=t,s.reinit=!0}function Tf(e,t){return function(i,n){const r=ql(e,i),o=ql(t,i);return n?!n(r,o):r!==o}}function Af(e,t){if(e.length!==t?.length)return!0;const s=new Map,i=new Map;return e.forEach(n=>{s.set(n.id,n)}),t.forEach(n=>{i.set(n.id,n)}),!!(t.some(({id:n})=>!s.has(n))||e.some(({id:n})=>!i.has(n)))}function Lf(e,t,s,i=!1){if(i){e.config={...e.config,...s},t.reinit=!0;return}const n=Tf(e.config,s);s.title&&n("title")&&e.setTitle(s.title),s.chart?.appearance?.theme&&n("chart.appearance.theme")&&e.setTheme(s.chart?.appearance?.theme),s.chart?.appearance?.locale&&n("chart.appearance.locale")&&e.setLocale(s.chart?.appearance?.locale),s.axes&&n("axes",Bs)&&e.setAxes(s.axes),s.scales&&n("scales",Bs)&&e.setScales(s.scales),!!s.series&&Af(e.config.series,s.series)&&(t.redrawLegend=!0),(s.series||s.timeline)&&e.setSeries(s.timeline??e.config.timeline,s.series??e.config.series,{incremental:!1}),s.tooltip&&n("tooltip")&&e.plugins.tooltip?.updateOptions(s.tooltip),s.legend&&n("legend")&&(t.reinit=!0),e.plugins.tooltip?.reset(),t.reopt=!0,e.config={...e.config,...s}}function If(e,t,s,i={incremental:!0,splice:!1}){let n=[],r=[],o=null,u=!1,c=!1,f;if(["number","string"].includes(typeof t)?(u=!1,f=!1,r=[s],o=t):typeof t[0]=="number"?(n=t,r=s,u=!!i.incremental,f=!i.incremental):(r=t,f=!0),this.isEmpty&&r.some(({data:p})=>p?.length)){e.reinit=!0;return}if(f===!1){let p=!1;if(u&&this.config.timeline.push(...n),r.forEach(m=>{let h=typeof o=="number"?this.config.series[0]:this.config.series.find(({id:_})=>_===m.id||_===o),b=h?.id;if(typeof o=="number"&&this.state.y2uIdx[o]&&(h=this.config.series[o],b=o),h&&b){const{data:_,...y}=m,A=this.state.y2uIdx[b];(h.type==="dots"||m.type==="dots"||this.config.chart.series?.type==="dots")&&(e.reinit=!0),u?h.data=_?h.data.concat(_):h.data:_?.length&&(h.data=_,c=!0);const I=Fn(this,Object.assign(h,y),A),O=this.options.series[A],w=this.uplot.series[A];w.show!==I.show&&e.fns.push(()=>{this.uplot.setSeries(A,{show:I.show})}),(w._focus===null||w._focus!==I.focus)&&e.fns.push(()=>{this.uplot.setSeries(A,{focus:I.focus})}),w.color!==I.color&&(p=!0),I.scale&&this.config.scales[I.scale]?.stacking&&(c=!0),Oo(O,I),Oo(w,I)}else e.fns.push(()=>{const _=Fn(this,m,this.config.series.length);this.state.y2uIdx[_.id]=this.uplot.series.length,this.uplot.addSeries(_,this.config.series.length)}),this.config.series.push(m)}),p&&e.fns.push(()=>{this.plugins.cursor?.updatePoints()}),i.splice){const m=r[0].data.length;this.config.series.forEach(h=>{h.data.splice(0,m)}),this.config.timeline.splice(0,n.length)}}else this.config.timeline=n,this.config.series=r,e.reinit=!0;e.reinit||(this._batch.fns.push(()=>this.plugins?.tooltip?.reset()),(c||n.length)&&(e.recalc=!0,e.fns.push(()=>{this.uplot.setData(this.series)})))}var kf=class{setLocale(e){this.batch(t=>_f(this,t,e))}setTitle(e){this.batch(t=>{this.config.title=e,this.initTitle(),t.redraw=[!0,!0]})}setTheme(e){this.batch(t=>Sf(this,e,t))}setAxes(e){this.batch(t=>yf(this,t,e))}setSeries(e,t,s={incremental:!0,splice:!1}){this.batch(i=>If.call(this,i,e,t,s))}setFocus(e,t){this.batch(()=>wf(this,e,t))}setVisible(e,t,s=!0){this.batch(i=>bf(this,e,t,s,i))}setScales(e){this.batch(t=>Ef(this,e,t))}setConfig(e,t=!1){this.batch(s=>Lf(this,s,e,t))}};function xf(e,t){const s=[];t.forEach(i=>{Object.getOwnPropertyNames(i.prototype).forEach(n=>{Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(i.prototype,n)||Object.create(null))}),i.prototype.initMixin&&s.push(i.prototype.initMixin)}),e.prototype.initMixins=function(){s.forEach(i=>i.call(this))}}var Df=class{initMixin(){this._batch={active:!1,fns:[]}}batch(e){if(this._batch.active)return e(this._batch);if(this._batch.active=!0,e(this._batch),this._batch.reinit)return this.fullUpdate();this._batch.redrawLegend&&this.plugins.legend?.redraw(),this._batch.reopt&&this.createUplotOptions(!0),this._batch.recalc&&this.inStage("processing",()=>{this.transformSeries()}).inStage("listen"),this._batch.fns.length&&this.uplot.batch(()=>this._batch.fns.forEach(t=>t(this._batch))),this._batch.redraw&&this.uplot&&this.redraw(...this._batch.redraw),this._batch={active:!1,fns:[]}}fullUpdate(){let e,t;this.inStage("dispose",()=>{if(this.uplot){const s=this.uplot.cursor;e=s.left,t=s.top,this.uplot.destroy()}this.plugins.legend?.destroy()}).inStage("config",()=>{this.plugins.legend=new ir,this._batch={active:!1,fns:[]},this.createUplotOptions(!0),this.options=this.config.editUplotOptions?this.config.editUplotOptions(this.options):this.options}).inStage("processing",()=>{this.transformSeries()}).inStage("uplot",()=>{this.uplot=new ee(this.options,this.series,this.initRender),e&&t&&e>0&&t>0&&this.uplot.setCursor({left:e,top:t}),this.state.subscribed||this.unsubscribe()}).inStage("listen")}},No=class{constructor(e,t){this.plugins={},this._meta={},this._uHooks={},this.init=()=>{this.config.chart.size?.adaptive&&!this.resizeOb&&(this.resizeOb=new ResizeObserver(Da(this.onResize,this.config.chart.size.resizeDebounceMs||100)),this.resizeOb.observe(this.root)),this.config.hooks.dispose||(this.config.hooks.dispose=[]),this.unsubscribe(),this.config.hooks.dispose.push(this.trackMouse())},this.execHooks=(i,...n)=>{const r=this.config.hooks[i];if(Array.isArray(r))for(const o of r)o&&typeof o=="function"&&o(...n)},this.initRender=(i,n)=>{const r=this.config.legend?.position;this.root.firstChild?!r||r==="bottom"?this.root.insertBefore(i.root,this.root.firstChild):this.root.appendChild(i.root):!r||r==="bottom"?this.root.appendChild(i.root):this.root.insertBefore(i.root,this.root.firstChild),this.config.legend?.show&&(this.plugins.legend?.init(i),this.reflow(!1)),this.initTitle(),n()},this.onResize=i=>{const[n]=i;this._cache.height===n.contentRect.height&&this._cache.width===n.contentRect.width||(this.plugins.tooltip?.reset(),this.reflow(),this.execHooks("resize",{entries:i,chart:this}))},this.initMixins(),this._startTime=performance.now(),this.state={isEmptyDataSet:!1,isMouseOver:!1,stage:"config",y2uIdx:{},subscribed:!1};const s=Object.assign({title:{},data:[],axes:{},series:[],scales:{},hooks:{},settings:{},chart:{},cursor:{},plugins:{},legend:{show:!1},tooltip:{show:!0},grid:null,markers:{}},t);this.config=s,this.inStage("config",()=>{this.id=e.id||Kl(),this.root=e,this.root.classList.add("yagr"),this.root.id||(this.root.id=this.id);const i=new ui,n=this.config.cursor.sync,r=this.config.chart;r.series||={type:"line"},r.size||={adaptive:!0},r.appearance||={locale:"en"},r.select||={},this.utils={colors:i,i18n:Io(s.chart.appearance?.locale||"en"),theme:new Gl(i)},i.setContext(e),n&&(this.utils.sync=ee.sync(typeof n=="string"?n:_l)),!r.size.adaptive&&r.size.width&&r.size.height&&(e.style.width=Pt(r.size.width),e.style.height=Pt(r.size.height)),this.plugins.legend=new ir,this.setTheme(r.appearance.theme||"light"),this.createUplotOptions(),this._cache={height:this.options.height,width:this.options.width},s.editUplotOptions&&(this.options=s.editUplotOptions(this.options))}).inStage("processing",()=>{this.transformSeries()}).inStage("uplot",()=>{this.uplot=new ee(this.options,this.series,this.initRender),this.canvas=e.querySelector("canvas"),this.init();const i=performance.now()-this._startTime;this._meta.processTime=i}).inStage("render")}get isEmpty(){return this.state.isEmptyDataSet}redraw(e=!0,t=!0){this.uplot.redraw(e,t)}getSeriesById(e){return this.uplot.series[this.state.y2uIdx[e]]}dispose(){this.resizeOb&&this.resizeOb.unobserve(this.root),this.unsubscribe(),this.plugins?.tooltip?.dispose(),this.plugins?.legend?.destroy(),this.uplot.destroy(),this._uHooks={},this.execHooks("dispose",{chart:this})}toDataUrl(){return this.canvas.toDataURL("img/png")}subscribe(){this.state.subscribed||(this.utils.sync?.sub(this.uplot),this.state.subscribed=!0)}unsubscribe(){this.utils.sync?.unsub(this.uplot),this.state.subscribed=!1}inStage(e,t){this.state.stage,this.execHooks("stage",{chart:this,stage:e});try{t&&t()}catch(s){console.error(s),this.onError(s)}return this}initTitle(){if(this.config.title&&this.config.title.fontSize){const e=this.config.title.fontSize,t=this.root.querySelector(".u-title");t.setAttribute("style",`font-size:${e}px;line-height:${e}px;`),t.innerHTML=this.config.title.text}}onError(e){return this.execHooks("error",{stage:this.state.stage,error:e,chart:this}),e}trackMouse(){const e=()=>{this.state.isMouseOver=!0},t=()=>{this.state.isMouseOver=!1};return this.root.addEventListener("mouseover",e),this.root.addEventListener("mouseleave",t),()=>{this.root.removeEventListener("mouseover",e),this.root.removeEventListener("mouseleave",t)}}get clientHeight(){const t=this.config.title.text?(this.config.title.fontSize||Sl)+8:0;return this.root.clientHeight-t-(this.plugins.legend?.state.totalSpace||0)}reflow(e=!0){const t=this.root.clientWidth,s=this.clientHeight;this._cache.width=t,this.options.width=t,this._cache.height=s,this.options.height=s,e&&this.uplot.setSize({width:this.options.width,height:this.options.height}),e&&this.uplot.redraw()}};xf(No,[mf,vf,kf,Df]);var zo=No,Of=dl;typeof window<"u"&&Object.assign(window,{Yagr:zo});var Mf=zo;export{Mf as default,Of as defaults};
//# sourceMappingURL=yagr.esm.min.js.map
