/**
* Copyright (c) 2024, Yandex LLC
* All rights reserved. (MIT Licensed)
*
* Yagr@4.3.0
* High-performance HTML5 canvas chart renderer based on uPlot
* https://github.com/gravity-ui/yagr
*/

"use strict";(function(Ls,ht){var ss=typeof exports=="object";if(typeof define=="function"&&define.amd)define([],ht);else if(typeof module=="object"&&module.exports)module.exports=ht();else{var ti=ht(),Ci=ss?exports:Ls;for(var si in ti)Ci[si]=ti[si]}})(typeof self<"u"?self:this,()=>{var Ls={},ht={exports:Ls},ss=Object.defineProperty,ti=Object.getOwnPropertyDescriptor,Ci=Object.getOwnPropertyNames,si=Object.prototype.hasOwnProperty,Gn=(e,t)=>{for(var s in t)ss(e,s,{get:t[s],enumerable:!0})},jo=(e,t,s,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Ci(t))!si.call(e,n)&&n!==s&&ss(e,n,{get:()=>t[n],enumerable:!(i=ti(t,n))||i.enumerable});return e},Xo=e=>jo(ss({},"__esModule",{value:!0}),e),$n={};Gn($n,{default:()=>cf,defaults:()=>af}),ht.exports=Xo($n);var Wn={};Gn(Wn,{AXIS_LABEL_FONT:()=>Hi,AXIS_VALUES_FONT:()=>Ui,BARS_DRAW_FACTOR:()=>ul,BARS_DRAW_MAX:()=>fl,CURSOR_STYLE:()=>Gi,DARK_DEFAULT_LINE_COLOR:()=>Jn,DAY:()=>Ke,DECADE:()=>Ko,DEFAULT_AXIS_FONT_SIZE:()=>Qn,DEFAULT_CANVAS_PIXEL_RATIO:()=>Qe,DEFAULT_FOCUS_ALPHA:()=>Yn,DEFAULT_LOGARITHMIC_MIN_SCALE_VALUE:()=>Vi,DEFAULT_MAX_TICKS:()=>jn,DEFAULT_POINT_SIZE:()=>xs,DEFAULT_SCALE_MIN_RANGE:()=>Xn,DEFAULT_SYNC_KEY:()=>Kn,DEFAULT_TITLE_FONT_SIZE:()=>qn,DEFAULT_X_SCALE:()=>Te,DEFAULT_X_SERIE_NAME:()=>Ni,DEFAULT_Y_AXIS_LABEL_PADDING:()=>il,DEFAULT_Y_AXIS_OFFSET:()=>zi,DEFAULT_Y_AXIS_PADDING:()=>sl,DEFAULT_Y_AXIS_SIZE:()=>tl,DEFAULT_Y_SCALE:()=>pt,HOUR:()=>It,LIGHT_DEFAULT_LINE_COLOR:()=>Zn,MARKER_DIAMETER:()=>_l,MINUTE:()=>zt,MIN_SELECTION_WIDTH:()=>Sl,PADDING_BOTH:()=>dl,PADDING_LEFT:()=>hl,PADDING_RIGHT:()=>pl,SECOND:()=>wt,SERIE_AREA_BORDER_COLOR:()=>ml,SERIE_AREA_BORDER_WIDTH:()=>vl,SERIE_COLOR:()=>gl,SERIE_LINE_WIDTH:()=>Bi,TIME_MULTIPLIER:()=>Is,TOOLTIP_DEFAULT_MAX_LINES:()=>El,TOOLTIP_X_OFFSET:()=>bl,TOOLTIP_Y_OFFSET:()=>wl,TYPES_ORDER:()=>qo,X_AXIS_INCRS:()=>cl,X_AXIS_SIZE:()=>ol,X_AXIS_SPACE:()=>al,X_AXIS_TICK_GAP:()=>rl,YEAR:()=>Vt,Y_AXIS_LABEL_SIZE:()=>ll,Y_AXIS_SIZE:()=>nl,Y_AXIS_TICK_GAP:()=>el,default:()=>yl});var Ni="date",Te="x",pt="y",Yn=.3,Qe=typeof window>"u"?1:window.devicePixelRatio,jn=5,zi=.05,Xn=.01,Vi=.001,xs=Qe>=2?4:2,Kn="sync",qn=14,Zn="#222222",Jn="#eeeeee",Qn=11,Hi="normal 11px Lucida Grande, Arial, Helvetica, sans-serif",Ui="11px Lucida Grande, Arial, Helvetica, sans-serif",el=6,tl=12,sl=12,il=2,nl=(e,t,s)=>{if(!t)return tl;const i=t.reduce((c,f)=>c.length>f.length?c:f),{ctx:n}=e;n.save();const r=e.axes[s];n.font=r.font?r.font[0]:Ui;const{width:o}=n.measureText(i);n.restore();let u=0;if(r.label){u=r.labelSize||Qn,n.font=r.labelFont?r.labelFont[0]:Hi;const{fontBoundingBoxAscent:c}=n.measureText(r.label);u=c,n.restore()}return u?o/Qe+u/Qe+il:o/Qe+sl},ll=11,wt=1e3,zt=wt*60,It=zt*60,Ke=It*24,Vt=Ke*365,Ko=Vt*10,rl=6,ol=32,al=80,cl=[1,10,50,100,200,500,wt,wt*2,wt*5,wt*10,wt*15,wt*30,zt,zt*5,zt*10,zt*30,It,It*2,It*3,It*4,It*6,It*12,Ke,Ke*2,Ke*3,Ke*5,Ke*10,Ke*15,Ke*30,Ke*60,Ke*120,Ke*180,Vt,Vt*2,Vt*5,Vt*10],qo=["dots","line","area","column"],ul=.5,fl=100,hl=[14,14,0,4],pl=[14,4,0,14],dl=[14,4,0,4],gl="rgba(0, 0, 0, 1)",Bi=2,ml="rgba(0, 0, 0, 0.2)",vl=1,_l=8,Gi="1px solid #ffa0a0",Sl=15,Zo=.68,Jo=-.6,yl=class{constructor(e,t="light"){this.setTheme(t),this.colors=e}setTheme(e){this.theme=e}get GRID(){return{show:!0,stroke:()=>this.colors.parse("--yagr-grid"),width:1}}get X_AXIS_TICKS(){return{size:8,...this.GRID}}get Y_AXIS_TICKS(){return{size:6,...this.GRID}}get AXIS_STROKE(){return this.colors.parse("--yagr-axis-stroke")}get BACKGROUND(){return this.colors.parse("--yagr-background")}get SHIFT(){return this.theme?.startsWith("light")?Zo:Jo}get DEFAULT_LINE_COLOR(){return this.theme?.startsWith("light")?Zn:Jn}},wl=24,bl=24,El=10,Is=1,Qo=[0,0,0,.6],ii=class{static parseRgba(e){const t=e.match(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,?\s*(\d+\.?\d*)?\s*\)/);return t?[t[1],t[2],t[3],t[4]||1].map(Number):null}parse(e="000"){const t=e.startsWith("var(--");let s=e,i=!0,n;const r=this.context,o=r.style.color;return t||e.startsWith("--")?(i=!1,n=t?e.slice(4,-1):e):!e.startsWith("#")&&!e.startsWith("rgb")&&(r.style.color=e,n="color",i=!1),s=i?s:getComputedStyle(r).getPropertyValue(n),r.style.color=o,s}setContext(e){this.context=e}rgba(e){return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}toRgba(e,t){return ii.parseRgba(this.parse(e))||t}shade([e,t,s,i],n){const r=n<0,o=r?0:255*n,u=r?1+n:1-n,c=Math.round(e*u+o),f=Math.round(t*u+o),p=Math.round(s*u+o);return"rgba("+c+","+f+","+p+","+i+")"}},ea=(e,t)=>{const s=e.utils.theme.SHIFT,i=e.uplot.series[t],n=ii.parseRgba(i.color)||Qo;return e.utils.colors.shade(n,s)},Tl=(e,t)=>(s,i)=>{const n=s.series[i];return n._focus===!1?n.getFocusedColor(e,i):n[t]},ta=(e,t,s=!0)=>{const i=t>=0;let n=-1/0,r=null,o=1/0,u=null;const c=[];let f=null;for(let p=e.rows.length-1;p>=0;p--){const m=e.rows[p],{displayY:h,rowIdx:b}=m;let _;h!==null&&(h>n&&(n=h,r=m.rowIdx),h<o&&(o=h,u=m.rowIdx)),h===null||(i?h<0:h>=0)?_=null:i?_=t>h?null:h-t:_=t<h?null:Math.abs(h-t);const y=f===null?1/0:c[f],A=_===null?y:Math.min(y,_);(_!==null&&y===_||A!==y)&&(f=b)}return f===null&&s?t>=n?r:t<=o?u:null:f},sa=(e,t,s)=>{let i=0,n=0;for(;n<e.length;){const r=e.length-n-1,o=e[r],u=o.$c;if(n+=1,o.scale!==s||o.show===!1)continue;const c=u[t];i+=typeof c=="number"?c:0}return i},ia=(e,t)=>{let s,i,n=0;for(;!i&&n<e.rows.length;){const r=e.rows[n].displayY;r!==null&&(s=n,i=Math.abs(r-(t||0))),n+=1}if(!i||s===void 0)return null;for(n=s+1;n<e.rows.length;n++){const r=e.rows[n].displayY;if(r===null)continue;const o=Math.abs(r-t);i>o&&(i=o,s=n)}return s},na=e=>e>=1e18?[1e18,"E"]:e>=1e15?[1e15,"P"]:e>=1e12?[1e12,"T"]:e>=1e9?[1e9,"G"]:e>=1e6?[1e6,"M"]:e>=1e3?[1e3,"K"]:[1,""];function la(e,t){if(t===0)return parseInt(e);if(Number.isInteger(e))return e+"."+"0".repeat(t);const[s,i]=e.toString().split(".");return i.length>=t?`${s}.${i.slice(0,t)}`:`${s}.${i}${"0".repeat(t-i.length)}`}function ni(e,t,s,i="closest",n=null){let r=s,o=s;const u=t.snapToValues??i;if(u===!1)return s;if(u==="left"||u==="closest"){for(let c=s-1;c>=0;c--)if(e[c]!==n){r=c;break}}if(u==="right"||u==="closest"){for(let c=s+1;c<e.length;c++)if(e[c]!==n){o=c;break}}return u==="left"?r:u==="right"?o:o-s>s-r?r:o}var Al=(e,t,s,i,n,r,o,u="linear")=>{let c=null;const f=e[r];switch(u){case"linear":{if(t===null||s===null)return null;c=t+(f-i)*(s-t)/(n-i),(isNaN(c)||Math.abs(c)===1/0)&&(c=null);break}case"previous":{c=t;break}case"next":{c=s;break}case"left":{c=o[o.length-1]===e.length-1||s===null?null:t;break}case"right":{c=o[0]===0?null:s;break}case"closest":{const p=Math.abs(i-e[r]),m=Math.abs(n-e[r]);c=p<m?t:s;break}default:c=u}return c},Ll=()=>Math.random().toString(36).substr(2,9).replace(/^\d+/,""),ra=(e,t,s)=>{const i=[],n=s.nullValues||{},r=s.interpolation;for(let o=0;o<e.length;o++){const u=e[o],c=[];let f=[],p=null,m=null,h,b;for(let _=0;_<u.length;_++){let y=u[_];if(r&&y===r.value){f.push(_);continue}if(n[y]&&(y=null),f.length){m=y,b=t[_];for(const A of f)c[A]=Al(t,p,m,h||t[0],b||t[t.length-1],A,f,r&&r.type);f=[]}p=y,h=t[_],c.push(y)}if(m=null,f.length)for(const _ of f)c.push(Al(t,p,m,h||t[0],b||t[t.length-1],_,f,r&&r.type));i.push(c)}return i};function oa(e,t=300){let s;return(...i)=>{clearTimeout(s),s=setTimeout(()=>e(...i),t)}}var kt=e=>e+"px",Ht=(e,t={},s)=>{const i=document.createElement(e);return Object.keys(t).forEach(n=>{const r=t[n];i.setAttribute(n,typeof r=="object"?Object.entries(r).map(([o,u])=>`${o}:${u}`).join(";"):r)}),s&&(typeof s=="string"?i.innerHTML=s:i.appendChild(s)),i};function xl(e,t){return t.split(".").reduce((s,i)=>Object.getOwnPropertyDescriptor(s,i)?.value??{},e)}function ks(e,t){if(typeof e!=typeof t)return!1;if((typeof e=="function"||typeof t=="function")&&(e=e.toString(),t=t.toString()),typeof e!="object"||Ut(e)||Ut(t))return e===t;const s=e,i=t,n=Object.keys(s),r=Object.keys(i);if(n.length!==r.length)return!1;for(const o of n)if(!i.hasOwnProperty(o)||!ks(s[o],i[o]))return!1;return!0}function Il(e){return typeof e=="function"||typeof e>"u"?e:()=>e}function Ut(e){return e==null}function kl(e,t,s){return e>=t&&e<=s?e:e<t?t:s}var aa=50;function Ol(e,t,s){if(s||=t.querySelector("span"),!s)return;t.style.background=`${e.color}`,s.style.background=e.color||gl;const i=ii.parseRgba(e.color)||[256,256,256,0];t.style.boxShadow=`0px 0px 0px 1px rgba(${i[0]}, ${i[1]}, ${i[2]}, 0.5)`}function ca(e,t){const s=e.series[t],i=Ht("span"),n=Ht("div",{class:"yagr-point","data-idx":String(t)},s.empty?void 0:i);return s.empty?(n.style.display="none",n):(Ol(s,n,i),n)}function Dl(e,t){return t===void 0?Array.from(e.querySelectorAll(".yagr-point")):[e.querySelector(`.yagr-point[data-idx="${t}"]`)]}function ua(e,t){const i=e.config.processing||{},n=!!i.interpolation,r=i.interpolation?.value,o=t.snapToValues===!1?!1:t.snapToValues||"closest",u=n?i.interpolation?.snapToValues??"closest":!1;let c={};const f=(p,m,h)=>{const b=p.series[m];if(b.scale===Te)return h;const _=b.$c||p.data[m],y=_[h];return n&&y===r?ni(_,b,h,u,r):y===null?ni(_,b,h,o,null):h};return{showPoints:p=>{const m=e.uplot.over;if(!m)return;Dl(m,p).forEach(b=>{b.style.visibility="visible"})},hidePoints:p=>{const m=e.uplot.over;if(!m)return;Dl(m,p).forEach(b=>{b.style.visibility="hidden"})},pin:p=>{const m=e.root.querySelector(".u-over");if(m)if(p){const h=document.createElement("div");h.classList.add("yagr-points-holder"),m.querySelectorAll(".yagr-point").forEach(b=>{const _=b.cloneNode(!0);h.appendChild(_);const y=_.dataset.idx;y&&(c[y]=_)}),m.appendChild(h)}else c={},m.querySelector(".yagr-points-holder")?.remove()},updatePoints:()=>{e.root.querySelectorAll(".yagr-point").forEach(p=>{const m=Number(p.dataset.idx);if(isNaN(m))return;const h=e.uplot.series[m];Ol(h,p)})},focus:(p,m)=>{Object.entries(c).forEach(([h,b])=>{if(p===null){b.style.display=m?"block":"none";return}b.style.display=h===String(p)&&m?"block":"none"})},uplot:{opts:(p,m)=>{m.cursor=m.cursor||{};const h=m.series.filter(y=>y.empty).length,b=m.series.length-1,_=t?.maxMarkers??aa;m.cursor.points={show:b-h<=_?ca:!1,size:(y,A)=>{const x=y.series[A];return(x.cursorOptions?x.cursorOptions.markersSize:t?.markersSize)||_l}},m.cursor.dataIdx=f},hooks:{...t.hideMarkers&&{setCursor:p=>{const m=p.cursor.idx;if(!Ut(m))for(let h=1;h<p.series.length;h++){const b=p.series[h].$c[m];t.hideMarkers(b,h)?e.plugins.cursor?.hidePoints(h):e.plugins.cursor?.showPoints(h)}}},init:p=>{const m=p.root.querySelector(".u-cursor-x");m&&(t.x&&t.x.visible===!1&&(m.style.display="none"),m.style.borderRight=t.x&&t.x.style||Gi);const h=p.root.querySelector(".u-cursor-y");h&&(t.y&&t.y.visible!==!1?h.style.borderBottom=t.y.style||Gi:h.style.display="none")}}}}}var Ml=e=>e.preventDefault(),Os="null",fa=18,ha=20,pa=48,da=12,ga=.3,$i=e=>e.some(({show:t,id:s})=>s!==Ni&&t),Pl=(e,t)=>t.length>3&&e($i(t)?"hide-all":"show-all"),ma=e=>e.length>3&&Os||void 0,Rl=class{constructor(){this.pagesCount=0,this.state={page:0,pages:1,pageSize:0,rowsPerPage:1,paginated:!1,requiredSpace:0,totalSpace:0},this.itemsHtml="",this.preInit=(e,t,s)=>{this.yagr=e,this.options=Object.assign({show:!1,position:"bottom",fontSize:da,maxLegendSpace:ga,className:void 0,behaviour:"basic"},t||{}),this.calc(s)},this.init=e=>{this.options.show&&(this.uplot=e,e.root.querySelector(".u-legend")?.remove(),this.render())},this.update=()=>{this.yagr.root.querySelectorAll("[data-serie-id]").forEach(t=>{const s=t.getAttribute("data-serie-id");if(!s||s===Os)return;const i=this.uplot?.series[this.yagr.state.y2uIdx[s]]?.show;t.classList[i?"remove":"add"]("yagr-legend__item_hidden")})},this.measureLegend=e=>{const t=this.yagr.root,s=Ht("div",{class:"yagr-legend",style:{visibility:"hidden"}},e);t.appendChild(s);const n=s.childNodes[0].getBoundingClientRect();return s.remove(),n},this.nextPage=()=>{const{state:e}=this;this.state.page+=1,this.items&&(this.items.style.transform=`translate(0, ${-1*e.page*e.pageSize}px)`,this.renderPagination())},this.prevPage=()=>{const{state:e}=this;this.state.page-=1,this.items&&(this.items.style.transform=`translate(0, ${-1*e.page*e.pageSize}px)`,this.renderPagination())}}redraw(){this.options.show&&this.render()}destroy(){this._onDestroy&&this._onDestroy(),this.legendEl?.remove()}applyHandlers(){const{yagr:e,uplot:t}=this;if(!t)return()=>{};const s=e.root.querySelectorAll("[data-serie-id]"),i=[],o={basic:p=>()=>{const m=p.getAttribute("data-serie-id"),h=[];if(m===Os){const _=!$i(t.series);for(let y=1;y<t.series.length;y++)h.push([t.series[y],_])}else{const _=t.series.find(({id:y})=>y===m);if(!_)return;h.push([_,!_.show])}h.forEach(([_,y])=>{if(_.show===y)return;const A=e.root.querySelector(`[data-serie-id="${_.id}"]`);e.setVisible(_.id,y,!1),A?.classList[y?"remove":"add"]("yagr-legend__item_hidden")});const b=e.root.querySelector(".yagr-legend__all-series");if(b){const _=Pl(this.yagr.utils.i18n,t.series);b.innerHTML=_||""}},extended:p=>{const m=(y,A)=>{const x=e.root.querySelector(`[data-serie-id="${y}"]`);e.setVisible(y,A,!1),x?.classList[A?"remove":"add"]("yagr-legend__item_hidden")},h=y=>{m(y.id,!y.show)},b=y=>{this.state.startSerieRange=y;const A=t.series.filter(D=>D.id!==y.id),x=!$i(A)&&y.show!==!1;t.series.forEach(D=>{const w=y.id===D.id?!0:x;m(D.id,w)})},_=y=>{this.state.startSerieRange||(this.state.startSerieRange=t.series[1]);const A=[];t.series.forEach((x,D)=>{x.id===y.id&&A.push(D),x.id===this.state.startSerieRange?.id&&A.push(D)}),t.series.forEach((x,D)=>{const w=D>=A[0]&&D<=A[1];m(x.id,w)})};return y=>{const A=p.getAttribute("data-serie-id"),x=t.series.find(({id:D})=>D===A);x&&(y.preventDefault(),y.ctrlKey||y.metaKey?h(x):y.shiftKey?_(x):b(x))}}},u=p=>()=>{const m=p.getAttribute("data-serie-id");if(p.classList.contains("yagr-legend__item_hidden")||m===Os)return;const h=this.yagr.uplot.series.find(({id:b})=>b===m);h&&e.setFocus(h.id,!0)},c=()=>{e.setFocus(null,!0)};s.forEach(p=>{const m=o[this.options.behaviour||"basic"](p),h=u(p);p.addEventListener("click",m),p.addEventListener("mouseenter",h),p.addEventListener("mouseleave",c),p.addEventListener("mousedown",Ml),i.push(()=>{p.removeEventListener("click",m),p.removeEventListener("mouseenter",h),p.removeEventListener("mouseleave",c),p.removeEventListener("mousedown",Ml)})});const f=()=>i.forEach(p=>p());return this._onDestroy=f,f}render(){let e=!1;const{uplot:t,options:s}=this;if(!t)return;let i=this.yagr.root.querySelector(".yagr-legend");if(i?e=!0:i=Ht("div",{class:`yagr-legend yagr-legend__${this.options.position} ${s?.className||""}`}),!!i){if(e||(s.position==="top"?t.root.before(i):t.root?.after(i)),this.legendEl=i,(!this.itemsHtml||e)&&this.calc(this.yagr.options),i.innerHTML=`<div class="yagr-legend__container" style="height: ${this.state.requiredSpace}px">${this.itemsHtml}</div>`,this.items=i.querySelector(".yagr-legend__items"),this.container=i.querySelector(".yagr-legend__container"),this.state.paginated){const n=this.renderPagination();this.container?.after(n)}else this.items.style.justifyContent="center";this.applyHandlers()}}renderPagination(){const{state:e}=this;let t=this.yagr.root.querySelector(".yagr-legend__pagination");if(t){const o=t.querySelector(".yagr-legend__icon-down"),u=t.querySelector(".yagr-legend__icon-up");o.removeEventListener("click",this.nextPage),u.removeEventListener("click",this.prevPage)}else t=Ht("div",{class:"yagr-legend__pagination"});const s=e.page===0?"yagr-legend__icon-up_disabled":"",i=e.page===e.pages-1?"yagr-legend__icon-down_disabled":"";t.innerHTML=`<span class="yagr-legend__icon-up ${s}"></span>
<span class="yagr-legend__pagination-text">${e.page+1}/${e.pages}</span>
<span class="yagr-legend__icon-down ${i}"></span>`;const n=t.querySelector(".yagr-legend__icon-down"),r=t.querySelector(".yagr-legend__icon-up");return i||n.addEventListener("click",this.nextPage),s||r.addEventListener("click",this.prevPage),t}createIconLineElement(e){return Ht("span",{class:`yagr-legend__icon yagr-legend__icon_${e.type}`,style:{"background-color":e.color}})}createSerieNameElement(e){const t=Ht("span");return t.innerText=e.name||"unnamed",t}renderItems(e){const t=Pl(this.yagr.utils.i18n,e.series),s=this.options.behaviour!=="extended"&&ma(e.series),i=s?[s]:[];for(let r=1;r<e.series.length;r++)i.push(e.series[r]);return`<div class="yagr-legend__items">${i.map(r=>{let o,u,c=" ";if(r===Os)o=t,u=s,c=" yagr-legend__all-series ";else{u=r.id;const p=this.createIconLineElement(r),m=this.createSerieNameElement(r);o=`${p.outerHTML}${m.outerHTML}`}const f=typeof r=="string"?!0:r.show!==!1;return`<div class="yagr-legend__item${c}${f?"":"yagr-legend__item_hidden"}" data-serie-id="${u}">${o}</div>`}).join("")}</div>`}calc(e){if(!this.options.show)return;const t=e.height-this.VERTICAL_PADDING,s=this.renderItems(e),{height:i}=this.measureLegend(s),n=this.options.fontSize+2,r=t*this.options.maxLegendSpace,o=Math.floor(r/n),u=o-1,c=Math.min(u*n,r),f=Math.min(o*n,r),p=i>c&&c>0,m=Math.min(p?f:c,i),h=Math.ceil(i/c),b=p?this.VERTICAL_PADDING+fa:this.VERTICAL_PADDING;this.state.requiredSpace=m,this.state.totalSpace=m+b,this.state.paginated=p,this.state.page=this.state.page||0,this.state.pages=h,this.state.pageSize=c,this.state.rowsPerPage=o,this.itemsHtml=s}get VERTICAL_PADDING(){return this.options.position==="bottom"?ha:pa}},va=!0,Ae="u-",_a="uplot",Sa=Ae+"hz",ya=Ae+"vt",wa=Ae+"title",ba=Ae+"wrap",Ea=Ae+"under",Ta=Ae+"over",Aa=Ae+"axis",Bt=Ae+"off",La=Ae+"select",xa=Ae+"cursor-x",Ia=Ae+"cursor-y",ka=Ae+"cursor-pt",Oa=Ae+"legend",Da=Ae+"live",Ma=Ae+"inline",Pa=Ae+"series",Ra=Ae+"marker",Fl=Ae+"label",Fa=Ae+"value",Ds="width",Ms="height",Ps="top",Cl="bottom",is="left",Wi="right",Yi="#000",Nl=Yi+"0",zl="mousemove",Vl="mousedown",ji="mouseup",Hl="mouseenter",Ul="mouseleave",Bl="dblclick",Ca="resize",Na="scroll",Gl="change",li="dppxchange",Xi="--",ns=typeof window<"u",Ki=ns?document:null,ls=ns?window:null,za=ns?navigator:null,ne,ri;function qi(){let e=devicePixelRatio;ne!=e&&(ne=e,ri&&Qi(Gl,ri,qi),ri=matchMedia(`(min-resolution: ${ne-.001}dppx) and (max-resolution: ${ne+.001}dppx)`),Gt(Gl,ri,qi),ls.dispatchEvent(new CustomEvent(li)))}function qe(e,t){if(t!=null){let s=e.classList;!s.contains(t)&&s.add(t)}}function Zi(e,t){let s=e.classList;s.contains(t)&&s.remove(t)}function ve(e,t,s){e.style[t]=s+"px"}function nt(e,t,s,i){let n=Ki.createElement(e);return t!=null&&qe(n,t),s?.insertBefore(n,i),n}function et(e,t){return nt("div",e,t)}var $l=new WeakMap;function rs(e,t,s,i,n){let r="translate("+t+"px,"+s+"px)",o=$l.get(e);r!=o&&(e.style.transform=r,$l.set(e,r),t<0||s<0||t>i||s>n?qe(e,Bt):Zi(e,Bt))}var Wl=new WeakMap;function Va(e,t,s){let i=t+s,n=Wl.get(e);i!=n&&(Wl.set(e,i),e.style.background=t,e.style.borderColor=s)}var Yl=new WeakMap;function Ha(e,t,s,i){let n=t+""+s,r=Yl.get(e);n!=r&&(Yl.set(e,n),e.style.height=s+"px",e.style.width=t+"px",e.style.marginLeft=i?-t/2+"px":0,e.style.marginTop=i?-s/2+"px":0)}var Ji={passive:!0},jl={...Ji,capture:!0};function Gt(e,t,s,i){t.addEventListener(e,s,i?jl:Ji)}function Qi(e,t,s,i){t.removeEventListener(e,s,i?jl:Ji)}ns&&qi();function Ot(e,t,s,i){let n;s=s||0,i=i||t.length-1;let r=i<=2147483647;for(;i-s>1;)n=r?s+i>>1:Je((s+i)/2),t[n]<e?s=n:i=n;return e-t[s]<=t[i]-e?s:i}function os(e,t,s,i){for(let n=i==1?t:s;n>=t&&n<=s;n+=i)if(e[n]!=null)return n;return-1}function Ua(e,t,s,i){let n=q,r=-q;if(i==1)n=e[t],r=e[s];else if(i==-1)n=e[s],r=e[t];else for(let o=t;o<=s;o++){let u=e[o];u!=null&&(u<n&&(n=u),u>r&&(r=u))}return[n,r]}function Ba(e,t,s){let i=q,n=-q;for(let r=t;r<=s;r++){let o=e[r];o!=null&&o>0&&(o<i&&(i=o),o>n&&(n=o))}return[i==q?1:i,n==-q?10:n]}function oi(e,t,s,i){let n=ql(e),r=ql(t),o=s==10?bt:Zl;e==t&&(n==-1?(e*=s,t/=s):(e/=s,t*=s));let u=n==1?Je:as,c=r==1?as:Je,f=u(o(xe(e))),p=c(o(xe(t))),m=cs(s,f),h=cs(s,p);return s==10&&(f<0&&(m=fe(m,-f)),p<0&&(h=fe(h,-p))),i||s==2?(e=m*n,t=h*r):(e=ir(e,m),t=fs(t,h)),[e,t]}function en(e,t,s,i){let n=oi(e,t,s,i);return e==0&&(n[0]=0),t==0&&(n[1]=0),n}var tn=.1,Xl={mode:3,pad:tn},Rs={pad:0,soft:null,mode:0},Ga={min:Rs,max:Rs};function ai(e,t,s,i){return fi(s)?Kl(e,t,s):(Rs.pad=s,Rs.soft=i?0:null,Rs.mode=i?3:0,Kl(e,t,Ga))}function le(e,t){return e??t}function $a(e,t,s){for(t=le(t,0),s=le(s,e.length-1);t<=s;){if(e[t]!=null)return!0;t++}return!1}function Kl(e,t,s){let i=s.min,n=s.max,r=le(i.pad,0),o=le(n.pad,0),u=le(i.hard,-q),c=le(n.hard,q),f=le(i.soft,q),p=le(n.soft,-q),m=le(i.mode,0),h=le(n.mode,0),b=t-e,_=bt(b),y=Fe(xe(e),xe(t)),A=bt(y),x=xe(A-_);(b<1e-9||x>10)&&(b=0,(e==0||t==0)&&(b=1e-9,m==2&&f!=q&&(r=0),h==2&&p!=-q&&(o=0)));let D=b||y||1e3,w=bt(D),k=cs(10,Je(w)),E=D*(b==0?e==0?.1:1:r),F=fe(ir(e-E,k/10),9),P=e>=f&&(m==1||m==3&&F<=f||m==2&&F>=f)?f:q,U=Fe(u,F<P&&e>=P?P:tt(P,F)),N=D*(b==0?t==0?.1:1:o),R=fe(fs(t+N,k/10),9),L=t<=p&&(h==1||h==3&&R>=p||h==2&&R<=p)?p:-q,H=tt(c,R>L&&t<=L?L:Fe(L,R));return U==H&&U==0&&(H=100),[U,H]}var Wa=new Intl.NumberFormat(ns?za.language:"en-US"),sn=e=>Wa.format(e),Ze=Math,ci=Ze.PI,xe=Ze.abs,Je=Ze.floor,Re=Ze.round,as=Ze.ceil,tt=Ze.min,Fe=Ze.max,cs=Ze.pow,ql=Ze.sign,bt=Ze.log10,Zl=Ze.log2,Ya=(e,t=1)=>Ze.sinh(e)*t,nn=(e,t=1)=>Ze.asinh(e/t),q=1/0;function Jl(e){return(bt((e^e>>31)-(e>>31))|0)+1}function ui(e,t,s){return tt(Fe(e,t),s)}function Z(e){return typeof e=="function"?e:()=>e}var ja=()=>{},Ql=e=>e,er=(e,t)=>t,Xa=e=>null,tr=e=>!0,sr=(e,t)=>e==t,us=e=>fe(e,14);function $t(e,t){return us(fe(us(e/t))*t)}function fs(e,t){return us(as(us(e/t))*t)}function ir(e,t){return us(Je(us(e/t))*t)}function fe(e,t=0){if(Ka(e))return e;let s=10**t,i=e*s*(1+Number.EPSILON);return Re(i)/s}var hs=new Map;function nr(e){return((""+e).split(".")[1]||"").length}function Fs(e,t,s,i){let n=[],r=i.map(nr);for(let o=t;o<s;o++){let u=xe(o),c=fe(cs(e,o),u);for(let f=0;f<i.length;f++){let p=i[f]*c,m=(p>=0&&o>=0?0:u)+(o>=r[f]?0:r[f]),h=fe(p,m);n.push(h),hs.set(h,m)}}return n}var Cs={},lr=[],ps=[null,null],Dt=Array.isArray,Ka=Number.isInteger,qa=e=>e===void 0;function rr(e){return typeof e=="string"}function fi(e){let t=!1;if(e!=null){let s=e.constructor;t=s==null||s==Object}return t}function or(e){return e!=null&&typeof e=="object"}var Za=Object.getPrototypeOf(Uint8Array);function Wt(e,t=fi){let s;if(Dt(e)){let i=e.find(n=>n!=null);if(Dt(i)||t(i)){s=Array(e.length);for(let n=0;n<e.length;n++)s[n]=Wt(e[n],t)}else s=e.slice()}else if(e instanceof Za)s=e.slice();else if(t(e)){s={};for(let i in e)s[i]=Wt(e[i],t)}else s=e;return s}function we(e){let t=arguments;for(let s=1;s<t.length;s++){let i=t[s];for(let n in i)fi(e[n])?we(e[n],Wt(i[n])):e[n]=Wt(i[n])}return e}var Ja=0,Qa=1,ec=2;function tc(e,t,s){for(let i=0,n,r=-1;i<t.length;i++){let o=t[i];if(o>r){for(n=o-1;n>=0&&e[n]==null;)e[n--]=null;for(n=o+1;n<s&&e[n]==null;)e[r=n++]=null}}}function sc(e,t){if(lc(e)){let o=e[0].slice();for(let u=1;u<e.length;u++)o.push(...e[u].slice(1));return rc(o[0])||(o=nc(o)),o}let s=new Set;for(let o=0;o<e.length;o++){let c=e[o][0],f=c.length;for(let p=0;p<f;p++)s.add(c[p])}let i=[Array.from(s).sort((o,u)=>o-u)],n=i[0].length,r=new Map;for(let o=0;o<n;o++)r.set(i[0][o],o);for(let o=0;o<e.length;o++){let u=e[o],c=u[0];for(let f=1;f<u.length;f++){let p=u[f],m=Array(n).fill(void 0),h=t?t[o][f]:Qa,b=[];for(let _=0;_<p.length;_++){let y=p[_],A=r.get(c[_]);y===null?h!=Ja&&(m[A]=y,h==ec&&b.push(A)):m[A]=y}tc(m,b,n),i.push(m)}}return i}var ic=typeof queueMicrotask>"u"?e=>Promise.resolve().then(e):queueMicrotask;function nc(e){let t=e[0],s=t.length,i=Array(s);for(let r=0;r<i.length;r++)i[r]=r;i.sort((r,o)=>t[r]-t[o]);let n=[];for(let r=0;r<e.length;r++){let o=e[r],u=Array(s);for(let c=0;c<s;c++)u[c]=o[i[c]];n.push(u)}return n}function lc(e){let t=e[0][0],s=t.length;for(let i=1;i<e.length;i++){let n=e[i][0];if(n.length!=s)return!1;if(n!=t){for(let r=0;r<s;r++)if(n[r]!=t[r])return!1}}return!0}function rc(e,t=100){const s=e.length;if(s<=1)return!0;let i=0,n=s-1;for(;i<=n&&e[i]==null;)i++;for(;n>=i&&e[n]==null;)n--;if(n<=i)return!0;const r=Fe(1,Je((n-i+1)/t));for(let o=e[i],u=i+r;u<=n;u+=r){const c=e[u];if(c!=null){if(c<=o)return!1;o=c}}return!0}var ar=["January","February","March","April","May","June","July","August","September","October","November","December"],cr=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function ur(e){return e.slice(0,3)}var oc=cr.map(ur),ac=ar.map(ur),cc={MMMM:ar,MMM:ac,WWWW:cr,WWW:oc};function Ns(e){return(e<10?"0":"")+e}function uc(e){return(e<10?"00":e<100?"0":"")+e}var fc={YYYY:e=>e.getFullYear(),YY:e=>(e.getFullYear()+"").slice(2),MMMM:(e,t)=>t.MMMM[e.getMonth()],MMM:(e,t)=>t.MMM[e.getMonth()],MM:e=>Ns(e.getMonth()+1),M:e=>e.getMonth()+1,DD:e=>Ns(e.getDate()),D:e=>e.getDate(),WWWW:(e,t)=>t.WWWW[e.getDay()],WWW:(e,t)=>t.WWW[e.getDay()],HH:e=>Ns(e.getHours()),H:e=>e.getHours(),h:e=>{let t=e.getHours();return t==0?12:t>12?t-12:t},AA:e=>e.getHours()>=12?"PM":"AM",aa:e=>e.getHours()>=12?"pm":"am",a:e=>e.getHours()>=12?"p":"a",mm:e=>Ns(e.getMinutes()),m:e=>e.getMinutes(),ss:e=>Ns(e.getSeconds()),s:e=>e.getSeconds(),fff:e=>uc(e.getMilliseconds())};function ln(e,t){t=t||cc;let s=[],i=/\{([a-z]+)\}|[^{]+/gi,n;for(;n=i.exec(e);)s.push(n[0][0]=="{"?fc[n[1]]:n[0]);return r=>{let o="";for(let u=0;u<s.length;u++)o+=typeof s[u]=="string"?s[u]:s[u](r,t);return o}}var hc=new Intl.DateTimeFormat().resolvedOptions().timeZone;function pc(e,t){let s;return t=="UTC"||t=="Etc/UTC"?s=new Date(+e+e.getTimezoneOffset()*6e4):t==hc?s=e:(s=new Date(e.toLocaleString("en-US",{timeZone:t})),s.setMilliseconds(e.getMilliseconds())),s}var fr=e=>e%1==0,hi=[1,2,2.5,5],dc=Fs(10,-16,0,hi),hr=Fs(10,0,16,hi),gc=hr.filter(fr),mc=dc.concat(hr),rn=`
`,pr="{YYYY}",dr=rn+pr,gr="{M}/{D}",zs=rn+gr,pi=zs+"/{YY}",mr="{aa}",vc="{h}:{mm}",ds=vc+mr,vr=rn+ds,_r=":{ss}",oe=null;function Sr(e){let t=e*1e3,s=t*60,i=s*60,n=i*24,r=n*30,o=n*365,c=(e==1?Fs(10,0,3,hi).filter(fr):Fs(10,-3,0,hi)).concat([t,t*5,t*10,t*15,t*30,s,s*5,s*10,s*15,s*30,i,i*2,i*3,i*4,i*6,i*8,i*12,n,n*2,n*3,n*4,n*5,n*6,n*7,n*8,n*9,n*10,n*15,r,r*2,r*3,r*4,r*6,o,o*2,o*5,o*10,o*25,o*50,o*100]);const f=[[o,pr,oe,oe,oe,oe,oe,oe,1],[n*28,"{MMM}",dr,oe,oe,oe,oe,oe,1],[n,gr,dr,oe,oe,oe,oe,oe,1],[i,"{h}"+mr,pi,oe,zs,oe,oe,oe,1],[s,ds,pi,oe,zs,oe,oe,oe,1],[t,_r,pi+" "+ds,oe,zs+" "+ds,oe,vr,oe,1],[e,_r+".{fff}",pi+" "+ds,oe,zs+" "+ds,oe,vr,oe,1]];function p(m){return(h,b,_,y,A,x)=>{let D=[],w=A>=o,k=A>=r&&A<o,E=m(_),F=fe(E*e,3),P=on(E.getFullYear(),w?0:E.getMonth(),k||w?1:E.getDate()),U=fe(P*e,3);if(k||w){let N=k?A/r:0,R=w?A/o:0,L=F==U?F:fe(on(P.getFullYear()+R,P.getMonth()+N,1)*e,3),H=new Date(Re(L/e)),X=H.getFullYear(),K=H.getMonth();for(let Y=0;L<=y;Y++){let ae=on(X+R*Y,K+N*Y,1),W=ae-m(fe(ae*e,3));L=fe((+ae+W)*e,3),L<=y&&D.push(L)}}else{let N=A>=n?n:A,R=Je(_)-Je(F),L=U+R+fs(F-U,N);D.push(L);let H=m(L),X=H.getHours()+H.getMinutes()/s+H.getSeconds()/i,K=A/i,Y=h.axes[b]._space,ae=x/Y;for(;L=fe(L+A,e==1?0:3),!(L>y);)if(K>1){let W=Je(fe(X+K,6))%24,Q=m(L).getHours()-W;Q>1&&(Q=-1),L-=Q*i,X=(X+K)%24;let ce=D[D.length-1];fe((L-ce)/A,3)*ae>=.7&&D.push(L)}else D.push(L)}return D}}return[c,f,p]}var[_c,Sc,yc]=Sr(1),[wc,bc,Ec]=Sr(.001);Fs(2,-53,53,[1]);function yr(e,t){return e.map(s=>s.map((i,n)=>n==0||n==8||i==null?i:t(n==1||s[8]==0?i:s[1]+i)))}function wr(e,t){return(s,i,n,r,o)=>{let u=t.find(_=>o>=_[0])||t[t.length-1],c,f,p,m,h,b;return i.map(_=>{let y=e(_),A=y.getFullYear(),x=y.getMonth(),D=y.getDate(),w=y.getHours(),k=y.getMinutes(),E=y.getSeconds(),F=A!=c&&u[2]||x!=f&&u[3]||D!=p&&u[4]||w!=m&&u[5]||k!=h&&u[6]||E!=b&&u[7]||u[1];return c=A,f=x,p=D,m=w,h=k,b=E,F(y)})}}function Tc(e,t){let s=ln(t);return(i,n,r,o,u)=>n.map(c=>s(e(c)))}function on(e,t,s){return new Date(e,t,s)}function br(e,t){return t(e)}var Ac="{YYYY}-{MM}-{DD} {h}:{mm}{aa}";function Er(e,t){return(s,i,n,r)=>r==null?Xi:t(e(i))}function Lc(e,t){let s=e.series[t];return s.width?s.stroke(e,t):s.points.width?s.points.stroke(e,t):null}function xc(e,t){return e.series[t].fill(e,t)}var Ic={show:!0,live:!0,isolate:!1,mount:ja,markers:{show:!0,width:2,stroke:Lc,fill:xc,dash:"solid"},idx:null,idxs:null,values:[]};function kc(e,t){let s=e.cursor.points,i=et(),n=s.size(e,t);ve(i,Ds,n),ve(i,Ms,n);let r=n/-2;ve(i,"marginLeft",r),ve(i,"marginTop",r);let o=s.width(e,t,n);return o&&ve(i,"borderWidth",o),i}function Oc(e,t){let s=e.series[t].points;return s._fill||s._stroke}function Dc(e,t){let s=e.series[t].points;return s._stroke||s._fill}function Mc(e,t){return e.series[t].points.size}function Pc(e,t,s){return s}var an=[0,0];function Rc(e,t,s){return an[0]=t,an[1]=s,an}function di(e,t,s,i=!0){return n=>{n.button==0&&(!i||n.target==t)&&s(n)}}function cn(e,t,s,i=!0){return n=>{(!i||n.target==t)&&s(n)}}var Fc={show:!0,x:!0,y:!0,lock:!1,move:Rc,points:{show:kc,size:Mc,width:0,stroke:Dc,fill:Oc},bind:{mousedown:di,mouseup:di,click:di,dblclick:di,mousemove:cn,mouseleave:cn,mouseenter:cn},drag:{setScale:!0,x:!0,y:!1,dist:0,uni:null,click:(e,t)=>{t.stopPropagation(),t.stopImmediatePropagation()},_x:!1,_y:!1},focus:{prox:-1,bias:0},left:-10,top:-10,idx:null,dataIdx:Pc,idxs:null,event:null},Tr={show:!0,stroke:"rgba(0,0,0,0.07)",width:2},un=we({},Tr,{filter:er}),Ar=we({},un,{size:10}),Lr=we({},Tr,{show:!1}),fn='12px system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',xr="bold "+fn,Ir=1.5,kr={show:!0,scale:"x",stroke:Yi,space:50,gap:5,size:50,labelGap:0,labelSize:30,labelFont:xr,side:2,grid:un,ticks:Ar,border:Lr,font:fn,lineGap:Ir,rotate:0},Cc="Value",Nc="Time",Or={show:!0,scale:"x",auto:!1,sorted:1,min:q,max:-q,idxs:[]};function zc(e,t,s,i,n){return t.map(r=>r==null?"":sn(r))}function Vc(e,t,s,i,n,r,o){let u=[],c=hs.get(n)||0;s=o?s:fe(fs(s,n),c);for(let f=s;f<=i;f=fe(f+n,c))u.push(Object.is(f,-0)?0:f);return u}function hn(e,t,s,i,n,r,o){const u=[],c=e.scales[e.axes[t].scale].log,f=c==10?bt:Zl,p=Je(f(s));n=cs(c,p),c==10&&p<0&&(n=fe(n,-p));let m=s;do u.push(m),m=m+n,c==10&&(m=fe(m,hs.get(n))),m>=n*c&&(n=m);while(m<=i);return u}function Hc(e,t,s,i,n,r,o){let c=e.scales[e.axes[t].scale].asinh,f=i>c?hn(e,t,Fe(c,s),i,n):[c],p=i>=0&&s<=0?[0]:[];return(s<-c?hn(e,t,Fe(c,-i),-s,n):[c]).reverse().map(h=>-h).concat(p,f)}var Dr=/./,Uc=/[12357]/,Bc=/[125]/,Mr=/1/,pn=(e,t,s,i)=>e.map((n,r)=>t==4&&n==0||r%i==0&&s.test(n.toExponential()[n<0?1:0])?n:null);function Gc(e,t,s,i,n){let r=e.axes[s],o=r.scale,u=e.scales[o],c=e.valToPos,f=r._space,p=c(10,o),m=c(9,o)-p>=f?Dr:c(7,o)-p>=f?Uc:c(5,o)-p>=f?Bc:Mr;if(m==Mr){let h=xe(c(1,o)-p);if(h<f)return pn(t.slice().reverse(),u.distr,m,as(f/h)).reverse()}return pn(t,u.distr,m,1)}function $c(e,t,s,i,n){let r=e.axes[s],o=r.scale,u=r._space,c=e.valToPos,f=xe(c(1,o)-c(2,o));return f<u?pn(t.slice().reverse(),3,Dr,as(u/f)).reverse():t}function Wc(e,t,s,i){return i==null?Xi:t==null?"":sn(t)}var Pr={show:!0,scale:"y",stroke:Yi,space:30,gap:5,size:50,labelGap:0,labelSize:30,labelFont:xr,side:3,grid:un,ticks:Ar,border:Lr,font:fn,lineGap:Ir,rotate:0};function Yc(e,t){let s=3+(e||1)*2;return fe(s*t,3)}function jc(e,t){let{scale:s,idxs:i}=e.series[0],n=e._data[0],r=e.valToPos(n[i[0]],s,!0),o=e.valToPos(n[i[1]],s,!0),u=xe(o-r),c=e.series[t],f=u/(c.points.space*ne);return i[1]-i[0]<=f}var Rr={scale:null,auto:!0,sorted:0,min:q,max:-q},Fr=(e,t,s,i,n)=>n,Cr={show:!0,auto:!0,sorted:0,gaps:Fr,alpha:1,facets:[we({},Rr,{scale:"x"}),we({},Rr,{scale:"y"})]},Nr={scale:"y",auto:!0,sorted:0,show:!0,spanGaps:!1,gaps:Fr,alpha:1,points:{show:jc,filter:null},values:null,min:q,max:-q,idxs:[],path:null,clip:null};function Xc(e,t,s,i,n){return s/10}var zr={time:va,auto:!0,distr:1,log:10,asinh:1,min:null,max:null,dir:1,ori:0},Kc=we({},zr,{time:!1,ori:1}),Vr={};function Hr(e,t){let s=Vr[e];return s||(s={key:e,plots:[],sub(i){s.plots.push(i)},unsub(i){s.plots=s.plots.filter(n=>n!=i)},pub(i,n,r,o,u,c,f){for(let p=0;p<s.plots.length;p++)s.plots[p]!=n&&s.plots[p].pub(i,n,r,o,u,c,f)}},e!=null&&(Vr[e]=s)),s}var Yt=1,gi=2;function jt(e,t,s){const i=e.mode,n=e.series[t],r=i==2?e._data[t]:e._data,o=e.scales,u=e.bbox;let c=r[0],f=i==2?r[1]:r[t],p=i==2?o[n.facets[0].scale]:o[e.series[0].scale],m=i==2?o[n.facets[1].scale]:o[n.scale],h=u.left,b=u.top,_=u.width,y=u.height,A=e.valToPosH,x=e.valToPosV;return p.ori==0?s(n,c,f,p,m,A,x,h,b,_,y,_i,gs,yi,Gr,Wr):s(n,c,f,p,m,x,A,b,h,y,_,Si,ms,gn,$r,Yr)}function mi(e,t){let s=0,i=0,n=le(e.bands,lr);for(let r=0;r<n.length;r++){let o=n[r];o.series[0]==t?s=o.dir:o.series[1]==t&&(o.dir==1?i|=1:i|=2)}return[s,i==1?-1:i==2?1:i==3?2:0]}function qc(e,t,s,i,n){let r=e.mode,o=e.series[t],u=r==2?o.facets[1].scale:o.scale,c=e.scales[u];return n==-1?c.min:n==1?c.max:c.distr==3?c.dir==1?c.min:c.max:0}function Et(e,t,s,i,n,r){return jt(e,t,(o,u,c,f,p,m,h,b,_,y,A)=>{let x=o.pxRound;const D=f.dir*(f.ori==0?1:-1),w=f.ori==0?gs:ms;let k,E;D==1?(k=s,E=i):(k=i,E=s);let F=x(m(u[k],f,y,b)),P=x(h(c[k],p,A,_)),U=x(m(u[E],f,y,b)),N=x(h(r==1?p.max:p.min,p,A,_)),R=new Path2D(n);return w(R,U,N),w(R,F,N),w(R,F,P),R})}function vi(e,t,s,i,n,r){let o=null;if(e.length>0){o=new Path2D;const u=t==0?yi:gn;let c=s;for(let m=0;m<e.length;m++){let h=e[m];if(h[1]>h[0]){let b=h[0]-c;b>0&&u(o,c,i,b,i+r),c=h[1]}}let f=s+n-c,p=10;f>0&&u(o,c,i-p/2,f,i+r+p)}return o}function Zc(e,t,s){let i=e[e.length-1];i&&i[0]==t?i[1]=s:e.push([t,s])}function dn(e,t,s,i,n,r,o){let u=[],c=e.length;for(let f=n==1?s:i;f>=s&&f<=i;f+=n)if(t[f]===null){let m=f,h=f;if(n==1)for(;++f<=i&&t[f]===null;)h=f;else for(;--f>=s&&t[f]===null;)h=f;let b=r(e[m]),_=h==m?b:r(e[h]),y=m-n;b=o<=0&&y>=0&&y<c?r(e[y]):b;let x=h+n;_=o>=0&&x>=0&&x<c?r(e[x]):_,_>=b&&u.push([b,_])}return u}function Ur(e){return e==0?Ql:e==1?Re:t=>$t(t,e)}function Br(e){let t=e==0?_i:Si,s=e==0?(n,r,o,u,c,f)=>{n.arcTo(r,o,u,c,f)}:(n,r,o,u,c,f)=>{n.arcTo(o,r,c,u,f)},i=e==0?(n,r,o,u,c)=>{n.rect(r,o,u,c)}:(n,r,o,u,c)=>{n.rect(o,r,c,u)};return(n,r,o,u,c,f=0,p=0)=>{f==0&&p==0?i(n,r,o,u,c):(f=tt(f,u/2,c/2),p=tt(p,u/2,c/2),t(n,r+f,o),s(n,r+u,o,r+u,o+c,f),s(n,r+u,o+c,r,o+c,p),s(n,r,o+c,r,o,p),s(n,r,o,r+u,o,f),n.closePath())}}var _i=(e,t,s)=>{e.moveTo(t,s)},Si=(e,t,s)=>{e.moveTo(s,t)},gs=(e,t,s)=>{e.lineTo(t,s)},ms=(e,t,s)=>{e.lineTo(s,t)},yi=Br(0),gn=Br(1),Gr=(e,t,s,i,n,r)=>{e.arc(t,s,i,n,r)},$r=(e,t,s,i,n,r)=>{e.arc(s,t,i,n,r)},Wr=(e,t,s,i,n,r,o)=>{e.bezierCurveTo(t,s,i,n,r,o)},Yr=(e,t,s,i,n,r,o)=>{e.bezierCurveTo(s,t,n,i,o,r)};function jr(e){return(t,s,i,n,r)=>jt(t,s,(o,u,c,f,p,m,h,b,_,y,A)=>{let{pxRound:x,points:D}=o,w,k;f.ori==0?(w=_i,k=Gr):(w=Si,k=$r);const E=fe(D.width*ne,3);let F=(D.size-D.width)/2*ne,P=fe(F*2,3),U=new Path2D,N=new Path2D,{left:R,top:L,width:H,height:X}=t.bbox;yi(N,R-P,L-P,H+P*2,X+P*2);const K=Y=>{if(c[Y]!=null){let ae=x(m(u[Y],f,y,b)),W=x(h(c[Y],p,A,_));w(U,ae+F,W),k(U,ae,W,F,0,ci*2)}};if(r)r.forEach(K);else for(let Y=i;Y<=n;Y++)K(Y);return{stroke:E>0?U:null,fill:U,clip:N,flags:Yt|gi}})}function Xr(e){return(t,s,i,n,r,o)=>{i!=n&&(r!=i&&o!=i&&e(t,s,i),r!=n&&o!=n&&e(t,s,n),e(t,s,o))}}var Jc=Xr(gs),Qc=Xr(ms);function Kr(e){const t=le(e?.alignGaps,0);return(s,i,n,r)=>jt(s,i,(o,u,c,f,p,m,h,b,_,y,A)=>{let x=o.pxRound,D=B=>x(m(B,f,y,b)),w=B=>x(h(B,p,A,_)),k,E;f.ori==0?(k=gs,E=Jc):(k=ms,E=Qc);const F=f.dir*(f.ori==0?1:-1),P={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:Yt},U=P.stroke;let N=q,R=-q,L,H,X,K=D(u[F==1?n:r]),Y=os(c,n,r,1*F),ae=os(c,n,r,-1*F),W=D(u[Y]),Ce=D(u[ae]),Ne=!1;for(let B=F==1?n:r;B>=n&&B<=r;B+=F){let pe=D(u[B]),G=c[B];pe==K?G!=null?(H=w(G),N==q&&(k(U,pe,H),L=H),N=tt(H,N),R=Fe(H,R)):G===null&&(Ne=!0):(N!=q&&(E(U,K,N,R,L,H),X=K),G!=null?(H=w(G),k(U,pe,H),N=R=L=H):(N=q,R=-q,G===null&&(Ne=!0)),K=pe)}N!=q&&N!=R&&X!=K&&E(U,K,N,R,L,H);let[Q,ce]=mi(s,i);if(o.fill!=null||Q!=0){let B=P.fill=new Path2D(U),pe=o.fillTo(s,i,o.min,o.max,Q),G=w(pe);k(B,Ce,G),k(B,W,G)}if(!o.spanGaps){let B=[];Ne&&B.push(...dn(u,c,n,r,F,D,t)),P.gaps=B=o.gaps(s,i,n,r,B),P.clip=vi(B,f.ori,b,_,y,A)}return ce!=0&&(P.band=ce==2?[Et(s,i,n,r,U,-1),Et(s,i,n,r,U,1)]:Et(s,i,n,r,U,ce)),P})}function eu(e){const t=le(e.align,1),s=le(e.ascDesc,!1),i=le(e.alignGaps,0),n=le(e.extend,!1);return(r,o,u,c)=>jt(r,o,(f,p,m,h,b,_,y,A,x,D,w)=>{let k=f.pxRound,{left:E,width:F}=r.bbox,P=Q=>k(_(Q,h,D,A)),U=Q=>k(y(Q,b,w,x)),N=h.ori==0?gs:ms;const R={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:Yt},L=R.stroke,H=h.dir*(h.ori==0?1:-1);u=os(m,u,c,1),c=os(m,u,c,-1);let X=U(m[H==1?u:c]),K=P(p[H==1?u:c]),Y=K,ae=K;n&&t==-1&&(ae=E,N(L,ae,X)),N(L,K,X);for(let Q=H==1?u:c;Q>=u&&Q<=c;Q+=H){let ce=m[Q];if(ce==null)continue;let B=P(p[Q]),pe=U(ce);t==1?N(L,B,X):N(L,Y,pe),N(L,B,pe),X=pe,Y=B}let W=Y;n&&t==1&&(W=E+F,N(L,W,X));let[Ce,Ne]=mi(r,o);if(f.fill!=null||Ce!=0){let Q=R.fill=new Path2D(L),ce=f.fillTo(r,o,f.min,f.max,Ce),B=U(ce);N(Q,W,B),N(Q,ae,B)}if(!f.spanGaps){let Q=[];Q.push(...dn(p,m,u,c,H,P,i));let ce=f.width*ne/2,B=s||t==1?ce:-ce,pe=s||t==-1?-ce:ce;Q.forEach(G=>{G[0]+=B,G[1]+=pe}),R.gaps=Q=f.gaps(r,o,u,c,Q),R.clip=vi(Q,h.ori,A,x,D,w)}return Ne!=0&&(R.band=Ne==2?[Et(r,o,u,c,L,-1),Et(r,o,u,c,L,1)]:Et(r,o,u,c,L,Ne)),R})}function tu(e){e=e||Cs;const t=le(e.size,[.6,q,1]),s=e.align||0,i=(e.gap||0)*ne;let n=e.radius;n=n==null?[0,0]:typeof n=="number"?[n,0]:n;const r=Z(n),o=1-t[0],u=le(t[1],q)*ne,c=le(t[2],1)*ne,f=le(e.disp,Cs),p=le(e.each,b=>{}),{fill:m,stroke:h}=f;return(b,_,y,A)=>jt(b,_,(x,D,w,k,E,F,P,U,N,R,L)=>{let H=x.pxRound,X,K;k.ori==0?[X,K]=r(b,_):[K,X]=r(b,_);const Y=k.dir*(k.ori==0?1:-1),ae=E.dir*(E.ori==1?1:-1);let W=k.ori==0?yi:gn,Ce=k.ori==0?p:(z,he,Le,Ie,Ge,ke,$e)=>{p(z,he,Le,Ge,Ie,$e,ke)},[Ne,Q]=mi(b,_),ce=E.distr==3?Ne==1?E.max:E.min:0,B=P(ce,E,L,N),pe,G,te=H(x.width*ne),Tt=!1,At=null,gt=null,Mt=null,Lt=null;m!=null&&(te==0||h!=null)&&(Tt=!0,At=m.values(b,_,y,A),gt=new Map,new Set(At).forEach(z=>{z!=null&&gt.set(z,new Path2D)}),te>0&&(Mt=h.values(b,_,y,A),Lt=new Map,new Set(Mt).forEach(z=>{z!=null&&Lt.set(z,new Path2D)})));let{x0:rt,size:Kt}=f,Ti=!0;if(rt!=null&&Kt!=null){D=rt.values(b,_,y,A),rt.unit==2&&(D=D.map(he=>b.posToVal(U+he*R,k.key,!0)));let z=Kt.values(b,_,y,A);Kt.unit==2?G=z[0]*R:G=F(z[0],k,R,U)-F(0,k,R,U),te>=G/2&&(te=0),G=H(ui(G-te,c,u)),pe=Y==1?-te/2:G+te/2}else{let z=R;if(D.length>1){let Le=null;for(let Ie=0,Ge=1/0;Ie<D.length;Ie++)if(w[Ie]!==void 0){if(Le!=null){let ke=xe(D[Ie]-D[Le]);ke<Ge&&(Ge=ke,z=xe(F(D[Ie],k,R,U)-F(D[Le],k,R,U)))}Le=Ie}}let he=z*o;G=z-he-i,te>=G/2&&(te=0),he+i<5&&(H=Ql),G=H(ui(z-he,c,u)-te-i),pe=(s==0?G/2:s==Y?0:G)-s*Y*i/2,G+te>z&&(Ti=!1)}const mt={stroke:null,fill:null,clip:null,band:null,gaps:null,flags:Yt|gi};let Vs;Q!=0&&(mt.band=new Path2D,Vs=H(P(Q==1?E.max:E.min,E,L,N)));const Hs=Tt?null:new Path2D,qt=mt.band;let{y0:st,y1:Us}=f,Pt=null;st!=null&&Us!=null&&(w=Us.values(b,_,y,A),Pt=st.values(b,_,y,A));let Zt=X*G,se=K*G;for(let z=Y==1?y:A;z>=y&&z<=A;z+=Y){let he=w[z];if(he===void 0)continue;let Le=k.distr!=2||f!=null?D[z]:z,Ie=F(Le,k,R,U),Ge=P(le(he,ce),E,L,N);Pt!=null&&he!=null&&(B=P(Pt[z],E,L,N));let ke=H(Ie-pe),$e=H(Fe(Ge,B)),Ye=H(tt(Ge,B)),ot=$e-Ye;if(he!=null){let vt=he<0?se:Zt,at=he<0?Zt:se;Tt?(te>0&&Mt[z]!=null&&W(Lt.get(Mt[z]),ke,Ye+Je(te/2),G,Fe(0,ot-te),vt,at),At[z]!=null&&W(gt.get(At[z]),ke,Ye+Je(te/2),G,Fe(0,ot-te),vt,at)):W(Hs,ke,Ye+Je(te/2),G,Fe(0,ot-te),vt,at),Ce(b,_,z,ke-te/2,Ye,G+te,ot)}Q!=0&&(he!=null||Ti)&&(ae*Q==1?($e=Ye,Ye=Vs):(Ye=$e,$e=Vs),ot=$e-Ye,W(qt,ke-te/2,Ye,G+te,Fe(0,ot),0,0))}return te>0?mt.stroke=Tt?Lt:Hs:Tt||(mt._fill=x.width==0?x._fill:x._stroke??x._fill,mt.width=0),mt.fill=Tt?gt:Hs,mt})}function su(e,t){const s=le(t?.alignGaps,0);return(i,n,r,o)=>jt(i,n,(u,c,f,p,m,h,b,_,y,A,x)=>{let D=u.pxRound,w=W=>D(h(W,p,A,_)),k=W=>D(b(W,m,x,y)),E,F,P;p.ori==0?(E=_i,P=gs,F=Wr):(E=Si,P=ms,F=Yr);const U=p.dir*(p.ori==0?1:-1);r=os(f,r,o,1),o=os(f,r,o,-1);let N=w(c[U==1?r:o]),R=N,L=[],H=[];for(let W=U==1?r:o;W>=r&&W<=o;W+=U)if(f[W]!=null){let Ne=c[W],Q=w(Ne);L.push(R=Q),H.push(k(f[W]))}const X={stroke:e(L,H,E,P,F,D),fill:null,clip:null,band:null,gaps:null,flags:Yt},K=X.stroke;let[Y,ae]=mi(i,n);if(u.fill!=null||Y!=0){let W=X.fill=new Path2D(K),Ce=u.fillTo(i,n,u.min,u.max,Y),Ne=k(Ce);P(W,R,Ne),P(W,N,Ne)}if(!u.spanGaps){let W=[];W.push(...dn(c,f,r,o,U,w,s)),X.gaps=W=u.gaps(i,n,r,o,W),X.clip=vi(W,p.ori,_,y,A,x)}return ae!=0&&(X.band=ae==2?[Et(i,n,r,o,K,-1),Et(i,n,r,o,K,1)]:Et(i,n,r,o,K,ae)),X})}function iu(e){return su(nu,e)}function nu(e,t,s,i,n,r){const o=e.length;if(o<2)return null;const u=new Path2D;if(s(u,e[0],t[0]),o==2)i(u,e[1],t[1]);else{let c=Array(o),f=Array(o-1),p=Array(o-1),m=Array(o-1);for(let h=0;h<o-1;h++)p[h]=t[h+1]-t[h],m[h]=e[h+1]-e[h],f[h]=p[h]/m[h];c[0]=f[0];for(let h=1;h<o-1;h++)f[h]===0||f[h-1]===0||f[h-1]>0!=f[h]>0?c[h]=0:(c[h]=3*(m[h-1]+m[h])/((2*m[h]+m[h-1])/f[h-1]+(m[h]+2*m[h-1])/f[h]),isFinite(c[h])||(c[h]=0));c[o-1]=f[o-2];for(let h=0;h<o-1;h++)n(u,e[h]+m[h]/3,t[h]+c[h]*m[h]/3,e[h+1]-m[h]/3,t[h+1]-c[h+1]*m[h]/3,e[h+1],t[h+1])}return u}var mn=new Set;function qr(){for(let e of mn)e.syncRect(!0)}ns&&(Gt(Ca,ls,qr),Gt(Na,ls,qr,!0),Gt(li,ls,()=>{ee.pxRatio=ne}));var lu=Kr(),ru=jr();function Zr(e,t,s,i){return(i?[e[0],e[1]].concat(e.slice(2)):[e[0]].concat(e.slice(1))).map((r,o)=>vn(r,o,t,s))}function ou(e,t){return e.map((s,i)=>i==0?null:we({},t,s))}function vn(e,t,s,i){return we({},t==0?s:i,e)}function Jr(e,t,s){return t==null?ps:[t,s]}var au=Jr;function cu(e,t,s){return t==null?ps:ai(t,s,tn,!0)}function Qr(e,t,s,i){return t==null?ps:oi(t,s,e.scales[i].log,!1)}var uu=Qr;function eo(e,t,s,i){return t==null?ps:en(t,s,e.scales[i].log,!1)}var fu=eo;function hu(e,t,s,i,n){let r=Fe(Jl(e),Jl(t)),o=t-e,u=Ot(n/i*o,s);do{let c=s[u],f=i*c/o;if(f>=n&&r+(c<5?hs.get(c):0)<=17)return[c,f]}while(++u<s.length);return[0,0]}function to(e){let t,s;return e=e.replace(/(\d+)px/,(i,n)=>(t=Re((s=+n)*ne))+"px"),[e,t,s]}function pu(e){e.show&&[e.font,e.labelFont].forEach(t=>{let s=fe(t[2]*ne,1);t[0]=t[0].replace(/[0-9.]+px/,s+"px"),t[1]=s})}function ee(e,t,s){const i={mode:le(e.mode,1)},n=i.mode;function r(l,a){return((a.distr==3?bt(l>0?l:a.clamp(i,l,a.min,a.max,a.key)):a.distr==4?nn(l,a.asinh):l)-a._min)/(a._max-a._min)}function o(l,a,d,g){let v=r(l,a);return g+d*(a.dir==-1?1-v:v)}function u(l,a,d,g){let v=r(l,a);return g+d*(a.dir==-1?v:1-v)}function c(l,a,d,g){return a.ori==0?o(l,a,d,g):u(l,a,d,g)}i.valToPosH=o,i.valToPosV=u;let f=!1;i.status=0;const p=i.root=et(_a);if(e.id!=null&&(p.id=e.id),qe(p,e.class),e.title){let l=et(wa,p);l.textContent=e.title}const m=nt("canvas"),h=i.ctx=m.getContext("2d"),b=et(ba,p);Gt("click",b,l=>{l.target===y&&(de!=Ss||ge!=ys)&&Ve.click(i,l)},!0);const _=i.under=et(Ea,b);b.appendChild(m);const y=i.over=et(Ta,b);e=Wt(e);const A=+le(e.pxAlign,1),x=Ur(A);(e.plugins||[]).forEach(l=>{l.opts&&(e=l.opts(i,e)||e)});const D=e.ms||.001,w=i.series=n==1?Zr(e.series||[],Or,Nr,!1):ou(e.series||[null],Cr),k=i.axes=Zr(e.axes||[],kr,Pr,!0),E=i.scales={},F=i.bands=e.bands||[];F.forEach(l=>{l.fill=Z(l.fill||null),l.dir=le(l.dir,-1)});const P=n==2?w[1].facets[0].scale:w[0].scale,U={axes:xf,series:bf},N=(e.drawOrder||["axes","series"]).map(l=>U[l]);function R(l){let a=E[l];if(a==null){let d=(e.scales||Cs)[l]||Cs;if(d.from!=null)R(d.from),E[l]=we({},E[d.from],d,{key:l});else{a=E[l]=we({},l==P?zr:Kc,d),a.key=l;let g=a.time,v=a.range,S=Dt(v);if((l!=P||n==2&&!g)&&(S&&(v[0]==null||v[1]==null)&&(v={min:v[0]==null?Xl:{mode:1,hard:v[0],soft:v[0]},max:v[1]==null?Xl:{mode:1,hard:v[1],soft:v[1]}},S=!1),!S&&fi(v))){let T=v;v=(I,M,C)=>M==null?ps:ai(M,C,T)}a.range=Z(v||(g?au:l==P?a.distr==3?uu:a.distr==4?fu:Jr:a.distr==3?Qr:a.distr==4?eo:cu)),a.auto=Z(S?!1:a.auto),a.clamp=Z(a.clamp||Xc),a._min=a._max=null}}}R("x"),R("y"),n==1&&w.forEach(l=>{R(l.scale)}),k.forEach(l=>{R(l.scale)});for(let l in e.scales)R(l);const L=E[P],H=L.distr;let X,K;L.ori==0?(qe(p,Sa),X=o,K=u):(qe(p,ya),X=u,K=o);const Y={};for(let l in E){let a=E[l];(a.min!=null||a.max!=null)&&(Y[l]={min:a.min,max:a.max},a.min=a.max=null)}const ae=e.tzDate||(l=>new Date(Re(l/D))),W=e.fmtDate||ln,Ce=D==1?yc(ae):Ec(ae),Ne=wr(ae,yr(D==1?Sc:bc,W)),Q=Er(ae,br(Ac,W)),ce=[],B=i.legend=we({},Ic,e.legend),pe=B.show,G=B.markers;B.idxs=ce,G.width=Z(G.width),G.dash=Z(G.dash),G.stroke=Z(G.stroke),G.fill=Z(G.fill);let te,Tt,At,gt=[],Mt=[],Lt,rt=!1,Kt={};if(B.live){const l=w[1]?w[1].values:null;rt=l!=null,Lt=rt?l(i,1,0):{_:0};for(let a in Lt)Kt[a]=Xi}if(pe)if(te=nt("table",Oa,p),At=nt("tbody",null,te),B.mount(i,te),rt){Tt=nt("thead",null,te,At);let l=nt("tr",null,Tt);nt("th",null,l);for(var Ti in Lt)nt("th",Fl,l).textContent=Ti}else qe(te,Ma),B.live&&qe(te,Da);const mt={show:!0},Vs={show:!1};function Hs(l,a){if(a==0&&(rt||!B.live||n==2))return ps;let d=[],g=nt("tr",Pa,At,At.childNodes[a]);qe(g,l.class),l.show||qe(g,Bt);let v=nt("th",null,g);if(G.show){let I=et(Ra,v);if(a>0){let M=G.width(i,a);M&&(I.style.border=M+"px "+G.dash(i,a)+" "+G.stroke(i,a)),I.style.background=G.fill(i,a)}}let S=et(Fl,v);S.textContent=l.label,a>0&&(G.show||(S.style.color=l.width>0?G.stroke(i,a):G.fill(i,a)),st("click",v,I=>{if($._lock)return;Jt(I);let M=w.indexOf(l);if((I.ctrlKey||I.metaKey)!=B.isolate){let C=w.some((O,V)=>V>0&&V!=M&&O.show);w.forEach((O,V)=>{V>0&&St(V,C?V==M?mt:Vs:mt,!0,be.setSeries)})}else St(M,{show:!l.show},!0,be.setSeries)},!1),Gs&&st(Hl,v,I=>{$._lock||(Jt(I),St(w.indexOf(l),Es,!0,be.setSeries))},!1));for(var T in Lt){let I=nt("td",Fa,g);I.textContent="--",d.push(I)}return[g,d]}const qt=new Map;function st(l,a,d,g=!0){const v=qt.get(a)||{},S=$.bind[l](i,a,d,g);S&&(Gt(l,a,v[l]=S),qt.set(a,v))}function Us(l,a,d){const g=qt.get(a)||{};for(let v in g)(l==null||v==l)&&(Qi(v,a,g[v]),delete g[v]);l==null&&qt.delete(a)}let Pt=0,Zt=0,se=0,z=0,he=0,Le=0,Ie=0,Ge=0,ke=0,$e=0;i.bbox={};let Ye=!1,ot=!1,vt=!1,at=!1,bn=!1,it=!1;function En(l,a,d){(d||l!=i.width||a!=i.height)&&mo(l,a),Ys(!1),vt=!0,ot=!0,$.left>=0&&(at=it=!0),es()}function mo(l,a){i.width=Pt=se=l,i.height=Zt=z=a,he=Le=0,df(),gf();let d=i.bbox;Ie=d.left=$t(he*ne,.5),Ge=d.top=$t(Le*ne,.5),ke=d.width=$t(se*ne,.5),$e=d.height=$t(z*ne,.5)}const ff=3;function hf(){let l=!1,a=0;for(;!l;){a++;let d=Af(a),g=Lf(a);l=a==ff||d&&g,l||(mo(i.width,i.height),ot=!0)}}function pf({width:l,height:a}){En(l,a)}i.setSize=pf;function df(){let l=!1,a=!1,d=!1,g=!1;k.forEach((v,S)=>{if(v.show&&v._show){let{side:T,_size:I}=v,M=T%2,C=v.label!=null?v.labelSize:0,O=I+C;O>0&&(M?(se-=O,T==3?(he+=O,g=!0):d=!0):(z-=O,T==0?(Le+=O,l=!0):a=!0))}}),Qt[0]=l,Qt[1]=d,Qt[2]=a,Qt[3]=g,se-=Rt[1]+Rt[3],he+=Rt[3],z-=Rt[2]+Rt[0],Le+=Rt[0]}function gf(){let l=he+se,a=Le+z,d=he,g=Le;function v(S,T){switch(S){case 1:return l+=T,l-T;case 2:return a+=T,a-T;case 3:return d-=T,d+T;case 0:return g-=T,g+T}}k.forEach((S,T)=>{if(S.show&&S._show){let I=S.side;S._pos=v(I,S._size),S.label!=null&&(S._lpos=v(I,S.labelSize))}})}const $=i.cursor=we({},Fc,{drag:{y:n==2}},e.cursor),Jt=l=>{$.event=l};$.idxs=ce,$._lock=!1;let _t=$.points;_t.show=Z(_t.show),_t.size=Z(_t.size),_t.stroke=Z(_t.stroke),_t.width=Z(_t.width),_t.fill=Z(_t.fill);const Bs=i.focus=we({},e.focus||{alpha:.3},$.focus),Gs=Bs.prox>=0;let je=[null];function mf(l,a){if(a>0){let d=$.points.show(i,a);if(d)return qe(d,ka),qe(d,l.class),rs(d,-10,-10,se,z),y.insertBefore(d,je[a]),d}}function vo(l,a){if(n==1||a>0){let d=n==1&&E[l.scale].time,g=l.value;l.value=d?rr(g)?Er(ae,br(g,W)):g||Q:g||Wc,l.label=l.label||(d?Nc:Cc)}if(a>0){l.width=l.width==null?1:l.width,l.paths=l.paths||lu||Xa,l.fillTo=Z(l.fillTo||qc),l.pxAlign=+le(l.pxAlign,A),l.pxRound=Ur(l.pxAlign),l.stroke=Z(l.stroke||null),l.fill=Z(l.fill||null),l._stroke=l._fill=l._paths=l._focus=null;let d=Yc(Fe(1,l.width),1),g=l.points=we({},{size:d,width:Fe(1,d*.2),stroke:l.stroke,space:d*2,paths:ru,_stroke:null,_fill:null},l.points);g.show=Z(g.show),g.filter=Z(g.filter),g.fill=Z(g.fill),g.stroke=Z(g.stroke),g.paths=Z(g.paths),g.pxAlign=l.pxAlign}if(pe){let d=Hs(l,a);gt.splice(a,0,d[0]),Mt.splice(a,0,d[1]),B.values.push(null)}if($.show){ce.splice(a,0,null);let d=mf(l,a);d&&je.splice(a,0,d)}Ue("addSeries",a)}function vf(l,a){a=a??w.length,l=n==1?vn(l,a,Or,Nr):vn(l,a,null,Cr),w.splice(a,0,l),vo(w[a],a)}i.addSeries=vf;function _f(l){if(w.splice(l,1),pe){B.values.splice(l,1),Mt.splice(l,1);let a=gt.splice(l,1)[0];Us(null,a.firstChild),a.remove()}$.show&&(ce.splice(l,1),je.length>1&&je.splice(l,1)[0].remove()),Ue("delSeries",l)}i.delSeries=_f;const Qt=[!1,!1,!1,!1];function Sf(l,a){if(l._show=l.show,l.show){let d=l.side%2,g=E[l.scale];g==null&&(l.scale=d?w[1].scale:P,g=E[l.scale]);let v=g.time;l.size=Z(l.size),l.space=Z(l.space),l.rotate=Z(l.rotate),Dt(l.incrs)&&l.incrs.forEach(T=>{!hs.has(T)&&hs.set(T,nr(T))}),l.incrs=Z(l.incrs||(g.distr==2?gc:v?D==1?_c:wc:mc)),l.splits=Z(l.splits||(v&&g.distr==1?Ce:g.distr==3?hn:g.distr==4?Hc:Vc)),l.stroke=Z(l.stroke),l.grid.stroke=Z(l.grid.stroke),l.ticks.stroke=Z(l.ticks.stroke),l.border.stroke=Z(l.border.stroke);let S=l.values;l.values=Dt(S)&&!Dt(S[0])?Z(S):v?Dt(S)?wr(ae,yr(S,W)):rr(S)?Tc(ae,S):S||Ne:S||zc,l.filter=Z(l.filter||(g.distr>=3&&g.log==10?Gc:g.distr==3&&g.log==2?$c:er)),l.font=to(l.font),l.labelFont=to(l.labelFont),l._size=l.size(i,null,a,0),l._space=l._rotate=l._incrs=l._found=l._splits=l._values=null,l._size>0&&(Qt[a]=!0,l._el=et(Aa,b))}}function $s(l,a,d,g){let[v,S,T,I]=d,M=a%2,C=0;return M==0&&(I||S)&&(C=a==0&&!v||a==2&&!T?Re(kr.size/3):0),M==1&&(v||T)&&(C=a==1&&!S||a==3&&!I?Re(Pr.size/2):0),C}const _o=i.padding=(e.padding||[$s,$s,$s,$s]).map(l=>Z(le(l,$s))),Rt=i._padding=_o.map((l,a)=>l(i,a,Qt,0));let ze,Oe=null,De=null;const Ai=n==1?w[0].idxs:null;let ct=null,Li=!1;function So(l,a){if(t=l==null?[]:Wt(l,or),n==2){ze=0;for(let d=1;d<w.length;d++)ze+=t[d][0].length;i.data=t=l}else if(t[0]==null&&(t[0]=[]),i.data=t.slice(),ct=t[0],ze=ct.length,H==2){t[0]=Array(ze);for(let d=0;d<ze;d++)t[0][d]=d}if(i._data=t,Ys(!0),Ue("setData"),H==2&&(vt=!0),a!==!1){let d=L;d.auto(i,Li)?Tn():ws(P,d.min,d.max),at=at||$.left>=0,it=!0,es()}}i.setData=So;function Tn(){Li=!0;let l,a;n==1&&(ze>0?(Oe=Ai[0]=0,De=Ai[1]=ze-1,l=t[0][Oe],a=t[0][De],H==2?(l=Oe,a=De):l==a&&(H==3?[l,a]=oi(l,l,L.log,!1):H==4?[l,a]=en(l,l,L.log,!1):L.time?a=l+Re(86400/D):[l,a]=ai(l,a,tn,!0))):(Oe=Ai[0]=l=null,De=Ai[1]=a=null)),ws(P,l,a)}let xi,_s,An,Ln,xn,In,kn,On,Dn,Ws;function yo(l,a,d,g,v,S){l??=Nl,d??=lr,g??="butt",v??=Nl,S??="round",l!=xi&&(h.strokeStyle=xi=l),v!=_s&&(h.fillStyle=_s=v),a!=An&&(h.lineWidth=An=a),S!=xn&&(h.lineJoin=xn=S),g!=In&&(h.lineCap=In=g),d!=Ln&&h.setLineDash(Ln=d)}function wo(l,a,d,g){a!=_s&&(h.fillStyle=_s=a),l!=kn&&(h.font=kn=l),d!=On&&(h.textAlign=On=d),g!=Dn&&(h.textBaseline=Dn=g)}function Mn(l,a,d,g,v=0){if(g.length>0&&l.auto(i,Li)&&(a==null||a.min==null)){let S=le(Oe,0),T=le(De,g.length-1),I=d.min==null?l.distr==3?Ba(g,S,T):Ua(g,S,T,v):[d.min,d.max];l.min=tt(l.min,d.min=I[0]),l.max=Fe(l.max,d.max=I[1])}}function yf(){let l=Wt(E,or);for(let g in l){let v=l[g],S=Y[g];if(S!=null&&S.min!=null)we(v,S),g==P&&Ys(!0);else if(g!=P||n==2)if(ze==0&&v.from==null){let T=v.range(i,null,null,g);v.min=T[0],v.max=T[1]}else v.min=q,v.max=-q}if(ze>0){w.forEach((g,v)=>{if(n==1){let S=g.scale,T=l[S],I=Y[S];if(v==0){let M=T.range(i,T.min,T.max,S);T.min=M[0],T.max=M[1],Oe=Ot(T.min,t[0]),De=Ot(T.max,t[0]),De-Oe>1&&(t[0][Oe]<T.min&&Oe++,t[0][De]>T.max&&De--),g.min=ct[Oe],g.max=ct[De]}else g.show&&g.auto&&Mn(T,I,g,t[v],g.sorted);g.idxs[0]=Oe,g.idxs[1]=De}else if(v>0&&g.show&&g.auto){let[S,T]=g.facets,I=S.scale,M=T.scale,[C,O]=t[v];Mn(l[I],Y[I],S,C,S.sorted),Mn(l[M],Y[M],T,O,T.sorted),g.min=T.min,g.max=T.max}});for(let g in l){let v=l[g],S=Y[g];if(v.from==null&&(S==null||S.min==null)){let T=v.range(i,v.min==q?null:v.min,v.max==-q?null:v.max,g);v.min=T[0],v.max=T[1]}}}for(let g in l){let v=l[g];if(v.from!=null){let S=l[v.from];if(S.min==null)v.min=v.max=null;else{let T=v.range(i,S.min,S.max,g);v.min=T[0],v.max=T[1]}}}let a={},d=!1;for(let g in l){let v=l[g],S=E[g];if(S.min!=v.min||S.max!=v.max){S.min=v.min,S.max=v.max;let T=S.distr;S._min=T==3?bt(S.min):T==4?nn(S.min,S.asinh):S.min,S._max=T==3?bt(S.max):T==4?nn(S.max,S.asinh):S.max,a[g]=d=!0}}if(d){w.forEach((g,v)=>{n==2?v>0&&a.y&&(g._paths=null):a[g.scale]&&(g._paths=null)});for(let g in a)vt=!0,Ue("setScale",g);$.show&&$.left>=0&&(at=it=!0)}for(let g in Y)Y[g]=null}function wf(l){let a=ui(Oe-1,0,ze-1),d=ui(De+1,0,ze-1);for(;l[a]==null&&a>0;)a--;for(;l[d]==null&&d<ze-1;)d++;return[a,d]}function bf(){ze>0&&(w.forEach((l,a)=>{if(a>0&&l.show&&(bo(a,!1),bo(a,!0),l._paths==null)){let d=n==2?[0,t[a][0].length-1]:wf(t[a]);l._paths=l.paths(i,a,d[0],d[1])}}),w.forEach((l,a)=>{if(a>0&&l.show){Ws!=l.alpha&&(h.globalAlpha=Ws=l.alpha),l._paths!=null&&Eo(a,!1);{let d=l._paths!=null?l._paths.gaps:null,g=l.points.show(i,a,Oe,De,d),v=l.points.filter(i,a,g,d);(g||v)&&(l.points._paths=l.points.paths(i,a,Oe,De,v),Eo(a,!0))}Ws!=1&&(h.globalAlpha=Ws=1),Ue("drawSeries",a)}}))}function bo(l,a){let d=a?w[l].points:w[l];d._stroke=d.stroke(i,l),d._fill=d.fill(i,l)}function Eo(l,a){let d=a?w[l].points:w[l],{stroke:g,fill:v,clip:S,flags:T,_stroke:I=d._stroke,_fill:M=d._fill,_width:C=d.width}=d._paths;C=fe(C*ne,3);let O=null,V=C%2/2;a&&M==null&&(M=C>0?"#fff":I);let j=d.pxAlign==1&&V>0;if(j&&h.translate(V,V),!a){let Se=Ie-C/2,J=Ge-C/2,re=ke+C,ie=$e+C;O=new Path2D,O.rect(Se,J,re,ie)}a?Pn(I,C,d.dash,d.cap,M,g,v,T,S):Ef(l,I,C,d.dash,d.cap,M,g,v,T,O,S),j&&h.translate(-V,-V)}function Ef(l,a,d,g,v,S,T,I,M,C,O){let V=!1;F.forEach((j,Se)=>{if(j.series[0]==l){let J=w[j.series[1]],re=t[j.series[1]],ie=(J._paths||Cs).band;Dt(ie)&&(ie=j.dir==1?ie[0]:ie[1]);let ue,_e=null;J.show&&ie&&$a(re,Oe,De)?(_e=j.fill(i,Se)||S,ue=J._paths.clip):ie=null,Pn(a,d,g,v,_e,T,I,M,C,O,ue,ie),V=!0}}),V||Pn(a,d,g,v,S,T,I,M,C,O)}const To=Yt|gi;function Pn(l,a,d,g,v,S,T,I,M,C,O,V){yo(l,a,d,g,v),(M||C||V)&&(h.save(),M&&h.clip(M),C&&h.clip(C)),V?(I&To)==To?(h.clip(V),O&&h.clip(O),ki(v,T),Ii(l,S,a)):I&gi?(ki(v,T),h.clip(V),Ii(l,S,a)):I&Yt&&(h.save(),h.clip(V),O&&h.clip(O),ki(v,T),h.restore(),Ii(l,S,a)):(ki(v,T),Ii(l,S,a)),(M||C||V)&&h.restore()}function Ii(l,a,d){d>0&&(a instanceof Map?a.forEach((g,v)=>{h.strokeStyle=xi=v,h.stroke(g)}):a!=null&&l&&h.stroke(a))}function ki(l,a){a instanceof Map?a.forEach((d,g)=>{h.fillStyle=_s=g,h.fill(d)}):a!=null&&l&&h.fill(a)}function Tf(l,a,d,g){let v=k[l],S;if(g<=0)S=[0,0];else{let T=v._space=v.space(i,l,a,d,g),I=v._incrs=v.incrs(i,l,a,d,g,T);S=hu(a,d,I,g,T)}return v._found=S}function Rn(l,a,d,g,v,S,T,I,M,C){let O=T%2/2;A==1&&h.translate(O,O),yo(I,T,M,C,I),h.beginPath();let V,j,Se,J,re=v+(g==0||g==3?-S:S);d==0?(j=v,J=re):(V=v,Se=re);for(let ie=0;ie<l.length;ie++)a[ie]!=null&&(d==0?V=Se=l[ie]:j=J=l[ie],h.moveTo(V,j),h.lineTo(Se,J));h.stroke(),A==1&&h.translate(-O,-O)}function Af(l){let a=!0;return k.forEach((d,g)=>{if(!d.show)return;let v=E[d.scale];if(v.min==null){d._show&&(a=!1,d._show=!1,Ys(!1));return}else d._show||(a=!1,d._show=!0,Ys(!1));let S=d.side,T=S%2,{min:I,max:M}=v,[C,O]=Tf(g,I,M,T==0?se:z);if(O==0)return;let V=v.distr==2,j=d._splits=d.splits(i,g,I,M,C,O,V),Se=v.distr==2?j.map(ue=>ct[ue]):j,J=v.distr==2?ct[j[1]]-ct[j[0]]:C,re=d._values=d.values(i,d.filter(i,Se,g,O,J),g,O,J);d._rotate=S==2?d.rotate(i,re,g,O):0;let ie=d._size;d._size=as(d.size(i,re,g,l)),ie!=null&&d._size!=ie&&(a=!1)}),a}function Lf(l){let a=!0;return _o.forEach((d,g)=>{let v=d(i,g,Qt,l);v!=Rt[g]&&(a=!1),Rt[g]=v}),a}function xf(){for(let l=0;l<k.length;l++){let a=k[l];if(!a.show||!a._show)continue;let d=a.side,g=d%2,v,S,T=a.stroke(i,l),I=d==0||d==3?-1:1;if(a.label){let ft=a.labelGap*I,xt=Re((a._lpos+ft)*ne);wo(a.labelFont[0],T,"center",d==2?Ps:Cl),h.save(),g==1?(v=S=0,h.translate(xt,Re(Ge+$e/2)),h.rotate((d==3?-ci:ci)/2)):(v=Re(Ie+ke/2),S=xt),h.fillText(a.label,v,S),h.restore()}let[M,C]=a._found;if(C==0)continue;let O=E[a.scale],V=g==0?ke:$e,j=g==0?Ie:Ge,Se=Re(a.gap*ne),J=a._splits,re=O.distr==2?J.map(ft=>ct[ft]):J,ie=O.distr==2?ct[J[1]]-ct[J[0]]:M,ue=a.ticks,_e=a.border,Xe=ue.show?Re(ue.size*ne):0,me=a._rotate*-ci/180,Ee=x(a._pos*ne),Be=(Xe+Se)*I,ye=Ee+Be;S=g==0?ye:0,v=g==1?ye:0;let We=a.font[0],ut=a.align==1?is:a.align==2?Wi:me>0?is:me<0?Wi:g==0?"center":d==3?Wi:is,Nt=me||g==1?"middle":d==2?Ps:Cl;wo(We,T,ut,Nt);let Go=a.font[1]*a.lineGap,Fi=J.map(ft=>x(c(ft,O,V,j))),$o=a._values;for(let ft=0;ft<$o.length;ft++){let xt=$o[ft];if(xt!=null){g==0?v=Fi[ft]:S=Fi[ft],xt=""+xt;let Wo=xt.indexOf(`
`)==-1?[xt]:xt.split(/\n/gm);for(let ei=0;ei<Wo.length;ei++){let Yo=Wo[ei];me?(h.save(),h.translate(v,S+ei*Go),h.rotate(me),h.fillText(Yo,0,0),h.restore()):h.fillText(Yo,v,S+ei*Go)}}}ue.show&&Rn(Fi,ue.filter(i,re,l,C,ie),g,d,Ee,Xe,fe(ue.width*ne,3),ue.stroke(i,l),ue.dash,ue.cap);let As=a.grid;As.show&&Rn(Fi,As.filter(i,re,l,C,ie),g,g==0?2:1,g==0?Ge:Ie,g==0?$e:ke,fe(As.width*ne,3),As.stroke(i,l),As.dash,As.cap),_e.show&&Rn([Ee],[1],g==0?1:0,g==0?1:2,g==1?Ge:Ie,g==1?$e:ke,fe(_e.width*ne,3),_e.stroke(i,l),_e.dash,_e.cap)}Ue("drawAxes")}function Ys(l){w.forEach((a,d)=>{d>0&&(a._paths=null,l&&(n==1?(a.min=null,a.max=null):a.facets.forEach(g=>{g.min=null,g.max=null})))})}let Fn=!1;function es(){Fn||(ic(If),Fn=!0)}function If(){Ye&&(yf(),Ye=!1),vt&&(hf(),vt=!1),ot&&(ve(_,is,he),ve(_,Ps,Le),ve(_,Ds,se),ve(_,Ms,z),ve(y,is,he),ve(y,Ps,Le),ve(y,Ds,se),ve(y,Ms,z),ve(b,Ds,Pt),ve(b,Ms,Zt),m.width=Re(Pt*ne),m.height=Re(Zt*ne),k.forEach(({_el:l,_show:a,_size:d,_pos:g,side:v})=>{if(l!=null)if(a){let S=v===3||v===0?d:0,T=v%2==1;ve(l,T?"left":"top",g-S),ve(l,T?"width":"height",d),ve(l,T?"top":"left",T?Le:he),ve(l,T?"height":"width",T?z:se),Zi(l,Bt)}else qe(l,Bt)}),xi=_s=An=xn=In=kn=On=Dn=Ln=null,Ws=1,Js(!0),Ue("setSize"),ot=!1),Pt>0&&Zt>0&&(h.clearRect(0,0,m.width,m.height),Ue("drawClear"),N.forEach(l=>l()),Ue("draw")),He.show&&bn&&(Mi(He),bn=!1),$.show&&at&&(ts(null,!0,!1),at=!1),B.show&&B.live&&it&&(Vn(),it=!1),f||(f=!0,i.status=1,Ue("ready")),Li=!1,Fn=!1}i.redraw=(l,a)=>{vt=a||!1,l!==!1?ws(P,L.min,L.max):es()};function Cn(l,a){let d=E[l];if(d.from==null){if(ze==0){let g=d.range(i,a.min,a.max,l);a.min=g[0],a.max=g[1]}if(a.min>a.max){let g=a.min;a.min=a.max,a.max=g}if(ze>1&&a.min!=null&&a.max!=null&&a.max-a.min<1e-16)return;l==P&&d.distr==2&&ze>0&&(a.min=Ot(a.min,t[0]),a.max=Ot(a.max,t[0]),a.min==a.max&&a.max++),Y[l]=a,Ye=!0,es()}}i.setScale=Cn;let Nn,zn,Oi,Di,Ao,Lo,Ss,ys,xo,Io,de,ge,Ft=!1;const Ve=$.drag;let Me=Ve.x,Pe=Ve.y;$.show&&($.x&&(Nn=et(xa,y)),$.y&&(zn=et(Ia,y)),L.ori==0?(Oi=Nn,Di=zn):(Oi=zn,Di=Nn),de=$.left,ge=$.top);const He=i.select=we({show:!0,over:!0,left:0,width:0,top:0,height:0},e.select),js=He.show?et(La,He.over?y:_):null;function Mi(l,a){if(He.show){for(let d in l)He[d]=l[d],d in Mo&&ve(js,d,l[d]);a!==!1&&Ue("setSelect")}}i.setSelect=Mi;function kf(l,a){let d=w[l],g=pe?gt[l]:null;d.show?g&&Zi(g,Bt):(g&&qe(g,Bt),je.length>1&&rs(je[l],-10,-10,se,z))}function ws(l,a,d){Cn(l,{min:a,max:d})}function St(l,a,d,g){a.focus!=null&&Rf(l),a.show!=null&&w.forEach((v,S)=>{S>0&&(l==S||l==null)&&(v.show=a.show,kf(S,a.show),ws(n==2?v.facets[1].scale:v.scale,null,null),es())}),d!==!1&&Ue("setSeries",l,a),g&&Qs("setSeries",i,l,a)}i.setSeries=St;function Of(l,a){we(F[l],a)}function Df(l,a){l.fill=Z(l.fill||null),l.dir=le(l.dir,-1),a=a??F.length,F.splice(a,0,l)}function Mf(l){l==null?F.length=0:F.splice(l,1)}i.addBand=Df,i.setBand=Of,i.delBand=Mf;function Pf(l,a){w[l].alpha=a,$.show&&je[l]&&(je[l].style.opacity=a),pe&&gt[l]&&(gt[l].style.opacity=a)}let bs,Xs,Ks;const Es={focus:!0};function Rf(l){if(l!=Ks){let a=l==null,d=Bs.alpha!=1;w.forEach((g,v)=>{let S=a||v==0||v==l;g._focus=a?null:S,d&&Pf(v,S?1:Bs.alpha)}),Ks=l,d&&es()}}pe&&Gs&&st(Ul,te,l=>{$._lock||(Jt(l),Ks!=null&&St(null,Es,!0,be.setSeries))});function yt(l,a,d){let g=E[a];d&&(l=l/ne-(g.ori==1?Le:he));let v=se;g.ori==1&&(v=z,l=v-l),g.dir==-1&&(l=v-l);let S=g._min,T=g._max,I=l/v,M=S+(T-S)*I,C=g.distr;return C==3?cs(10,M):C==4?Ya(M,g.asinh):M}function Ff(l,a){let d=yt(l,P,a);return Ot(d,t[0],Oe,De)}i.valToIdx=l=>Ot(l,t[0]),i.posToIdx=Ff,i.posToVal=yt,i.valToPos=(l,a,d)=>E[a].ori==0?o(l,E[a],d?ke:se,d?Ie:0):u(l,E[a],d?$e:z,d?Ge:0);function Cf(l){l(i),es()}i.batch=Cf,i.setCursor=(l,a,d)=>{de=l.left,ge=l.top,ts(null,a,d)};function ko(l,a){ve(js,is,He.left=l),ve(js,Ds,He.width=a)}function Oo(l,a){ve(js,Ps,He.top=l),ve(js,Ms,He.height=a)}let qs=L.ori==0?ko:Oo,Zs=L.ori==1?ko:Oo;function Nf(){if(pe&&B.live)for(let l=n==2?1:0;l<w.length;l++){if(l==0&&rt)continue;let a=B.values[l],d=0;for(let g in a)Mt[l][d++].firstChild.nodeValue=a[g]}}function Vn(l,a){l!=null&&(l.idxs?l.idxs.forEach((d,g)=>{ce[g]=d}):qa(l.idx)||ce.fill(l.idx),B.idx=ce[0]);for(let d=0;d<w.length;d++)(d>0||n==1&&!rt)&&zf(d,ce[d]);pe&&B.live&&Nf(),it=!1,a!==!1&&Ue("setLegend")}i.setLegend=Vn;function zf(l,a){let d=w[l],g=l==0&&H==2?ct:t[l],v;rt?v=d.values(i,l,a)??Kt:(v=d.value(i,a==null?null:g[a],l,a),v=v==null?Kt:{_:v}),B.values[l]=v}function ts(l,a,d){xo=de,Io=ge,[de,ge]=$.move(i,de,ge),$.show&&(Oi&&rs(Oi,Re(de),0,se,z),Di&&rs(Di,0,Re(ge),se,z));let g,v=Oe>De;bs=q;let S=L.ori==0?se:z,T=L.ori==1?se:z;if(de<0||ze==0||v){g=null;for(let I=0;I<w.length;I++)I>0&&je.length>1&&rs(je[I],-10,-10,se,z);Gs&&St(null,Es,!0,l==null&&be.setSeries),B.live&&(ce.fill(g),it=!0)}else{let I,M,C;n==1&&(I=L.ori==0?de:ge,M=yt(I,P),g=Ot(M,t[0],Oe,De),C=X(t[0][g],L,S,0));for(let O=n==2?1:0;O<w.length;O++){let V=w[O],j=ce[O],Se=n==1?t[O][j]:t[O][1][j],J=$.dataIdx(i,O,g,M),re=n==1?t[O][J]:t[O][1][J];it=it||re!=Se||J!=j,ce[O]=J;let ie=fs(J==g?C:X(n==1?t[0][J]:t[O][0][J],L,S,0),1);if(O>0&&V.show){let ue=re==null?-10:fs(K(re,n==1?E[V.scale]:E[V.facets[1].scale],T,0),1);if(Gs&&ue>=0&&n==1){let me=xe(ue-ge);if(me<bs){let Ee=Bs.bias;if(Ee!=0){let Be=L.ori==1?de:ge,ye=yt(Be,V.scale),We=re>=0?1:-1,ut=ye>=0?1:-1;ut==We&&(ut==1?Ee==1?re>=ye:re<=ye:Ee==1?re<=ye:re>=ye)&&(bs=me,Xs=O)}else bs=me,Xs=O}}let _e,Xe;if(L.ori==0?(_e=ie,Xe=ue):(_e=ue,Xe=ie),it&&je.length>1){Va(je[O],$.points.fill(i,O),$.points.stroke(i,O));let me,Ee,Be,ye,We=!0,ut=$.points.bbox;if(ut!=null){We=!1;let Nt=ut(i,O);Be=Nt.left,ye=Nt.top,me=Nt.width,Ee=Nt.height}else Be=_e,ye=Xe,me=Ee=$.points.size(i,O);Ha(je[O],me,Ee,We),rs(je[O],Be,ye,se,z)}}}}if($.idx=g,$.left=de,$.top=ge,it&&(B.idx=g,Vn()),He.show&&Ft)if(l!=null){let[I,M]=be.scales,[C,O]=be.match,[V,j]=l.cursor.sync.scales,Se=l.cursor.drag;if(Me=Se._x,Pe=Se._y,Me||Pe){let{left:J,top:re,width:ie,height:ue}=l.select,_e=l.scales[I].ori,Xe=l.posToVal,me,Ee,Be,ye,We,ut=I!=null&&C(I,V),Nt=M!=null&&O(M,j);ut&&Me?(_e==0?(me=J,Ee=ie):(me=re,Ee=ue),Be=E[I],ye=X(Xe(me,V),Be,S,0),We=X(Xe(me+Ee,V),Be,S,0),qs(tt(ye,We),xe(We-ye))):qs(0,S),Nt&&Pe?(_e==1?(me=J,Ee=ie):(me=re,Ee=ue),Be=E[M],ye=K(Xe(me,j),Be,T,0),We=K(Xe(me+Ee,j),Be,T,0),Zs(tt(ye,We),xe(We-ye))):Zs(0,T)}else Pi()}else{let I=xe(xo-Ao),M=xe(Io-Lo);if(L.ori==1){let j=I;I=M,M=j}Me=Ve.x&&I>=Ve.dist,Pe=Ve.y&&M>=Ve.dist;let C=Ve.uni;C!=null?Me&&Pe&&(Me=I>=C,Pe=M>=C,!Me&&!Pe&&(M>I?Pe=!0:Me=!0)):Ve.x&&Ve.y&&(Me||Pe)&&(Me=Pe=!0);let O,V;Me&&(L.ori==0?(O=Ss,V=de):(O=ys,V=ge),qs(tt(O,V),xe(V-O)),Pe||Zs(0,T)),Pe&&(L.ori==1?(O=Ss,V=de):(O=ys,V=ge),Zs(tt(O,V),xe(V-O)),Me||qs(0,S)),!Me&&!Pe&&(qs(0,0),Zs(0,0))}if(Ve._x=Me,Ve._y=Pe,l==null){if(d){if(Bo!=null){let[I,M]=be.scales;be.values[0]=I!=null?yt(L.ori==0?de:ge,I):null,be.values[1]=M!=null?yt(L.ori==1?de:ge,M):null}Qs(zl,i,de,ge,se,z,g)}if(Gs){let I=d&&be.setSeries,M=Bs.prox;Ks==null?bs<=M&&St(Xs,Es,!0,I):bs>M?St(null,Es,!0,I):Xs!=Ks&&St(Xs,Es,!0,I)}}a!==!1&&Ue("setCursor")}let Ct=null;Object.defineProperty(i,"rect",{get(){return Ct==null&&Js(!1),Ct}});function Js(l=!1){l?Ct=null:(Ct=y.getBoundingClientRect(),Ue("syncRect",Ct))}function Do(l,a,d,g,v,S,T){$._lock||Ft&&l!=null&&l.movementX==0&&l.movementY==0||(Hn(l,a,d,g,v,S,T,!1,l!=null),l!=null?ts(null,!0,!0):ts(a,!0,!1))}function Hn(l,a,d,g,v,S,T,I,M){if(Ct==null&&Js(!1),Jt(l),l!=null)d=l.clientX-Ct.left,g=l.clientY-Ct.top;else{if(d<0||g<0){de=-10,ge=-10;return}let[C,O]=be.scales,V=a.cursor.sync,[j,Se]=V.values,[J,re]=V.scales,[ie,ue]=be.match,_e=a.axes[0].side%2==1,Xe=L.ori==0?se:z,me=L.ori==1?se:z,Ee=_e?S:v,Be=_e?v:S,ye=_e?g:d,We=_e?d:g;if(J!=null?d=ie(C,J)?c(j,E[C],Xe,0):-10:d=Xe*(ye/Ee),re!=null?g=ue(O,re)?c(Se,E[O],me,0):-10:g=me*(We/Be),L.ori==1){let ut=d;d=g,g=ut}}M&&((d<=1||d>=se-1)&&(d=$t(d,se)),(g<=1||g>=z-1)&&(g=$t(g,z))),I?(Ao=d,Lo=g,[Ss,ys]=$.move(i,d,g)):(de=d,ge=g)}const Mo={width:0,height:0,left:0,top:0};function Pi(){Mi(Mo,!1)}let Po,Ro,Fo,Co;function No(l,a,d,g,v,S,T){Ft=!0,Me=Pe=Ve._x=Ve._y=!1,Hn(l,a,d,g,v,S,T,!0,!1),l!=null&&(st(ji,Ki,zo,!1),Qs(Vl,i,Ss,ys,se,z,null));let{left:I,top:M,width:C,height:O}=He;Po=I,Ro=M,Fo=C,Co=O,Pi()}function zo(l,a,d,g,v,S,T){Ft=Ve._x=Ve._y=!1,Hn(l,a,d,g,v,S,T,!1,!0);let{left:I,top:M,width:C,height:O}=He,V=C>0||O>0,j=Po!=I||Ro!=M||Fo!=C||Co!=O;if(V&&j&&Mi(He),Ve.setScale&&V&&j){let Se=I,J=C,re=M,ie=O;if(L.ori==1&&(Se=M,J=O,re=I,ie=C),Me&&ws(P,yt(Se,P),yt(Se+J,P)),Pe)for(let ue in E){let _e=E[ue];ue!=P&&_e.from==null&&_e.min!=q&&ws(ue,yt(re+ie,ue),yt(re,ue))}Pi()}else $.lock&&($._lock=!$._lock,$._lock||ts(null,!0,!1));l!=null&&(Us(ji,Ki),Qs(ji,i,de,ge,se,z,null))}function Vf(l,a,d,g,v,S,T){if($._lock)return;Jt(l);let I=Ft;if(Ft){let M=!0,C=!0,O=10,V,j;L.ori==0?(V=Me,j=Pe):(V=Pe,j=Me),V&&j&&(M=de<=O||de>=se-O,C=ge<=O||ge>=z-O),V&&M&&(de=de<Ss?0:se),j&&C&&(ge=ge<ys?0:z),ts(null,!0,!0),Ft=!1}de=-10,ge=-10,ts(null,!0,!0),I&&(Ft=I)}function Vo(l,a,d,g,v,S,T){$._lock||(Jt(l),Tn(),Pi(),l!=null&&Qs(Bl,i,de,ge,se,z,null))}function Ho(){k.forEach(pu),En(i.width,i.height,!0)}Gt(li,ls,Ho);const Ts={};Ts.mousedown=No,Ts.mousemove=Do,Ts.mouseup=zo,Ts.dblclick=Vo,Ts.setSeries=(l,a,d,g)=>{let v=be.match[2];d=v(i,a,d),d!=-1&&St(d,g,!0,!1)},$.show&&(st(Vl,y,No),st(zl,y,Do),st(Hl,y,l=>{Jt(l),Js(!1)}),st(Ul,y,Vf),st(Bl,y,Vo),mn.add(i),i.syncRect=Js);const Ri=i.hooks=e.hooks||{};function Ue(l,a,d){l in Ri&&Ri[l].forEach(g=>{g.call(null,i,a,d)})}(e.plugins||[]).forEach(l=>{for(let a in l.hooks)Ri[a]=(Ri[a]||[]).concat(l.hooks[a])});const Uo=(l,a,d)=>d,be=we({key:null,setSeries:!1,filters:{pub:tr,sub:tr},scales:[P,w[1]?w[1].scale:null],match:[sr,sr,Uo],values:[null,null]},$.sync);be.match.length==2&&be.match.push(Uo),$.sync=be;const Bo=be.key,Un=Hr(Bo);function Qs(l,a,d,g,v,S,T){be.filters.pub(l,a,d,g,v,S,T)&&Un.pub(l,a,d,g,v,S,T)}Un.sub(i);function Hf(l,a,d,g,v,S,T){be.filters.sub(l,a,d,g,v,S,T)&&Ts[l](null,a,d,g,v,S,T)}i.pub=Hf;function Uf(){Un.unsub(i),mn.delete(i),qt.clear(),Qi(li,ls,Ho),p.remove(),te?.remove(),Ue("destroy")}i.destroy=Uf;function Bn(){Ue("init",e,t),So(t||e.data,!1),Y[P]?Cn(P,Y[P]):Tn(),bn=He.show&&(He.width>0||He.height>0),at=it=!0,En(e.width,e.height)}return w.forEach(vo),k.forEach(Sf),s?s instanceof HTMLElement?(s.appendChild(p),Bn()):s(i,Bn):Bn(),i}ee.assign=we,ee.fmtNum=sn,ee.rangeNum=ai,ee.rangeLog=oi,ee.rangeAsinh=en,ee.orient=jt,ee.pxRatio=ne,ee.join=sc,ee.fmtDate=ln,ee.tzDate=pc,ee.sync=Hr;{ee.addGap=Zc,ee.clipGaps=vi;let e=ee.paths={points:jr};e.linear=Kr,e.stepped=eu,e.bars=tu,e.spline=iu}var so={ru:{"hide-all":"\u0421\u043A\u0440\u044B\u0442\u044C \u0432\u0441\u0435","show-all":"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0432\u0441\u0435",sum:"\u0421\u0443\u043C\u043C\u0430",scale:"\u0428\u043A\u0430\u043B\u0430",series:"\u041B\u0438\u043D\u0438\u044F",weekend:"\u0412\u044B\u0445\u043E\u0434\u043D\u043E\u0439",nodata:"\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445"},en:{"hide-all":"Hide all","show-all":"Show all",sum:"Total",scale:"Scale",series:"Series",weekend:"Weekend",nodata:"No data"}},io=(e="en")=>(typeof e!="string"&&(so.custom=e,e="custom"),t=>so[e][t]||t),du={size:["height","width"],clientSize:["clientHeight","clientWidth"],offsetSize:["offsetHeight","offsetWidth"],maxSize:["maxHeight","maxWidth"],before:["top","left"],marginBefore:["marginTop","marginLeft"],after:["bottom","right"],marginAfter:["marginBottom","marginRight"],scrollOffset:["pageYOffset","pageXOffset"],offset:["offsetY","offsetY"],offsetOpt:["yOffset","xOffset"]};function no(e){return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}function gu(e,t,s="bottom",i={}){let n;t instanceof Element||t instanceof Range?n=no(e.getBoundingClientRect()):n=t;const r=Object.assign({top:n.bottom||0,bottom:n.top||0,left:n.right||0,right:n.left||0},n),o={top:0,left:0,bottom:window.innerHeight,right:window.innerWidth};i.bound&&((i.bound instanceof Element||i.bound instanceof Range)&&(i.bound=no(i.bound.getBoundingClientRect())),Object.assign(o,i.bound));const u=getComputedStyle(e),{primary:c,secondary:f}=Object.entries(du).reduce((N,[R,L])=>({primary:{...N.primary,[R]:L[s==="top"||s==="bottom"?0:1]},secondary:{...N.secondary,[R]:L[s==="top"||s==="bottom"?1:0]}}),{primary:{},secondary:{}});e.style.position="absolute",e.style.maxWidth="",e.style.maxHeight="";const p=i[c.offsetOpt]||0,m=parseInt(u[f.marginBefore],10),h=parseInt(u[f.marginAfter],10),b=m+h,_=o[f.after]-o[f.before]-b,y=parseInt(u[f.maxSize],10);(!y||_<y)&&(e.style[f.maxSize]=kt(_));const A=parseInt(u[c.marginBefore],10)+parseInt(u[c.marginAfter],10),x=r[c.before]-o[c.before]-A,D=o[c.after]-r[c.after]-A-p;(s===c.before&&e[c.offsetSize]>x||s===c.after&&e[c.offsetSize]>D)&&(s=x>D?c.before:c.after);const w=s===c.before?x:D,k=parseInt(u[c.maxSize],10);(!k||w<k)&&(e.style[c.maxSize]=kt(w));const E=window[c.scrollOffset],F=N=>Math.max(o[c.before],Math.min(N,o[c.after]-e[c.offsetSize]-A)),P=N=>Math.max(o[f.before],Math.min(N,o[f.after]-e[f.offsetSize]-b));s===c.before?(e.style[c.before]=E+F(r[c.before]-e[c.offsetSize]-A)-p+"px",e.style[c.after]="auto"):(e.style[c.before]=kt(E+F(r[c.after])+p),e.style[c.after]="auto");const U=window[f.scrollOffset];return e.style[f.before]=kt(U+P(r[f.before]-m)),e.style[f.after]="auto",e.dataset.side=s,{side:s,anchorRect:r,boundRect:o}}function lt(e,t){return typeof e=="object"?e[t]:e}function mu(e){const t=document.createElement("span");return t.innerText=e,t.innerHTML}function vu(e,t,s){const i=e.slice(0,lt(t.maxLines,s));return i.map(({value:n,name:r="unnamed",color:o,active:u,transformed:c,seriesIdx:f},p)=>{const m=`
<span class="yagr-tooltip__val">${n}</span>
    ${typeof c=="number"?`<span class="yagr-tooltip__tf">${c.toFixed(2)}</span>`:""}
`;return`
<div class="yagr-tooltip__item ${u?"_active":""}" data-series="${f}">
    ${t.showIndicies?`<span class="yagr-tooltip__idx">${e.length-p}</span>`:""}
    <span class="yagr-tooltip__mark" style="background-color: ${o}"></span>${mu(r)}&nbsp;&nbsp;${m}
</div>`}).join("")+(e.length>i.length?`<div class="yagr-tooltip__item _more">+${e.length-i.length}</div>`:"")}function _n(e){if(e.scales.length===0)return e.yagr.utils.i18n("nodata");const[t,s]=e.options.title?typeof e.options.title=="string"?[e.options.title,!1]:["",!0]:["",!1],i=e.scales.map(n=>{const r=lt(e.options.title,n.scale),o=e.scales.length>1?e.options.scales?`${lt(e.options.scales,n.scale)||""}`:`${e.yagr.utils.i18n("scale")}: ${n.scale}`:"";return`
<div class="__section" data-scale=${n.scale}>
    ${s&&r?`<div class="_section_title">${r}</div>`:""}
    ${o?`<div class="__section_scale">${o}</div>`:""}
    <div class="__section_body">${vu(n.rows,e.options,n.scale)}</div>
    ${lt(e.options.sum,n.scale)?`
        <div class="__section_sum">
            ${e.yagr.utils.i18n("sum")}: ${n.sum}
        </div>
    `:""}
</div>`});return`${t?`<div class="__title">${t}</div>`:""}${i.join("")}`}var _u=(e,t,s,i,n)=>{const r=Array.isArray(s.$c)?s.$c:t;let o=r[i];if(n&&o===n.value){const u=n.snapToValues??"closest",c=ni(r,s,i,u,n.value);o=r[c]}else if(o===null){const u=e.snapToValues??"closest",c=s.snapToValues??u,f=ni(r,s,i,c,null);o=r[f]}return o},Sn={maxLines:El,highlight:!0,sum:!1,render:_n,pinable:!0,strategy:"pin",sort:void 0,showIndicies:!1,hideNoData:!1,className:"yagr-tooltip_default",xOffset:bl,yOffset:wl,virtual:!1,showEmpty:!1,onUpdate:"reset"},Su=class{constructor(e,t={}){this.handlers={init:[],mount:[],show:[],pin:[],unpin:[],hide:[],render:[],destroy:[],reset:[]},this.placement=gu,this.renderTooltipCloses=()=>{},this.skipNextMouseUp=!1,this.emit=(s,i)=>{this.handlers[s].forEach(n=>{n(this.tOverlay,{state:this.state,actions:{pin:this.pin,show:this.show,hide:this.hide,dispose:this.dispose,reset:this.reset},data:i,yagr:this.yagr,event:s})})},this.reset=()=>{if(this.opts.onUpdate==="none"){this.yagr.plugins.cursor?.pin(!1);return}this.state.visible&&this.hide(),this.state.pinned&&this.pin(!1),this.emit("reset")},this.show=()=>{const s=!this.state.visible;this.state.visible=!0,this.tOverlay.style.display="block",s&&this.emit("show")},this.hide=()=>{const s=this.state.visible;this.state.visible=!1,this.tOverlay.style.display="none",this.emit("hide"),s&&this.emit("show")},this.pin=(s,i)=>{this.state.pinned=s;const n=this.state.range||[];if(this.yagr.plugins.cursor?.pin(s&&(n[1]===null||n.length<2)),this.opts.virtual)return this.emit(s?"pin":"unpin");i&&this.placement(this.tOverlay,{left:i.x+this.bLeft,top:this.bTop+i.y-(this.opts.yOffset||0)},"right",{bound:this.bound,xOffset:this.opts.xOffset,yOffset:this.opts.yOffset});const r=this.tOverlay.querySelector("._tooltip-list");s?(this.state.visible||this.show(),this.tOverlay.classList.add("yagr-tooltip_pinned"),r&&r?.clientHeight&&(r.style.height=kt(r.clientHeight)),this.opts.render===_n&&(document.addEventListener("mousemove",this.checkFocus),document.addEventListener("mousedown",this.detectClickOutside))):(this.tOverlay.classList.remove("yagr-tooltip_pinned"),this.opts.render===_n&&(document.removeEventListener("mousemove",this.checkFocus),document.removeEventListener("mousedown",this.detectClickOutside))),this.emit(s?"pin":"unpin")},this.checkFocus=s=>{const i=s.target;let n;i&&this.tOverlay.contains(i)&&i.classList.contains("yagr-tooltip__item")&&(n=i.dataset.series);const r=n?this.yagr.uplot.series[Number(n)]:null;n&&r?(this.state.focusedSeries=n,this.yagr.setFocus(r.id,!0)):this.state.focusedSeries&&(this.state.focusedSeries=null,this.yagr.setFocus(null,!0))},this.render=s=>{const i=this.yagr.uplot;let{left:n,top:r}=s;const{idx:o}=s,{opts:u,state:c}=this;if(u.show&&typeof u.show=="function"&&u.show(this.yagr)===!1){this.hide();return}(n<0||r<0)&&!c.pinned&&this.isNotInDrag&&this.hide(),r=kl(r,0,i.bbox.top+i.bbox.height),n=kl(n,0,i.bbox.left+i.bbox.width);const{data:f}=i;if(f===null||Ut(o)||r===void 0)return;const p=f[0][o],m={},h={},b={};let _=i.series.length-1;for(;_>=1;){const w=i.series[_];if(!w.show){_-=1;continue}const k=w.scale||pt;b[k]=b[k]||[],b[k].push(_),_-=1}if(Object.entries(b).forEach(([w,k])=>{h[w]=h[w]||{rows:[]};const E=h[w],F=Number(i.posToVal(r,w).toFixed(2)),P=lt(u.value,w);for(const N of k){const R=i.data[N],L=i.series[N];let H=_u(this.yagr.config.cursor,R,L,o,this.interpolation),X=H;typeof H=="string"&&(X=H,H=null),lt(u.sum,w)&&(m[w]=m[w]||0,m[w]+=H||0);const K=R[o],Y=L.$c&&L.$c[o]===this.stripValue?H:K;if(H===null&&u.hideNoData||L.showInTooltip===!1)continue;const ae=L.precision??lt(u.precision,w),W=L.formatter?L.formatter(X,L):P(X,ae),Ce={id:L.id,name:L.name,dataValue:L.$c[o],originalValue:H,value:W,y:Y,displayY:K,color:L.color,seriesIdx:N,rowIdx:E.rows.length?E.rows[E.rows.length-1].rowIdx+1:0};L.normalizedData&&(Ce.transformed=L.normalizedData[o]),L._transformed&&(Ce.transformed=R[o]),!(u.omitBy&&u.omitBy(Ce))&&E.rows.push(Ce)}if(lt(u.highlight,w)&&E.rows.length){const N=lt(u.tracking,w);let R=0;N==="area"?R=ta(E,F,lt(u.stickToRanges,w)):N==="sticky"?R=ia(E,F):typeof N=="function"&&(R=N(E,F,{x:i.posToVal(n,"x"),y:i.posToVal(r,w),idx:o,scale:w,series:this.yagr.series,serieIndicies:k,interpolation:this.interpolation})),R!==null&&(E.rows[R].active=!0)}const U=lt(u.sort,w);U&&E.rows.sort(U)}),Object.values(h).some(({rows:w})=>w.length>0)||u.showEmpty)this.onMouseEnter();else{this.hide();return}const x=this.over.getBoundingClientRect();this.bLeft=x.left,this.bTop=x.top,this.bWidth=x.width;const D={left:n+this.bLeft,top:this.bTop+r-(u.yOffset||0)};this.renderTooltipCloses=()=>{const w={scales:Object.entries(h).map(([E,F])=>({scale:E,rows:F.rows,sum:m[E]})),options:u,x:p};if(!Object.values(h).some(({rows:E})=>E.filter(({id:F})=>this.yagr.getSeriesById(F)?.show).length>0)&&!u.showEmpty){this.hide();return}u.virtual||(this.tOverlay.innerHTML=u.render({...w,state:c,yagr:this.yagr,defaultRender:Sn.render}),this.placement(this.tOverlay,D,"right",{bound:this.bound,xOffset:u.xOffset,yOffset:u.yOffset})),this.emit("render",{...w,anchor:D})},!c.pinned&&this.renderTooltipCloses()},this.initWithUplot=s=>{this.over=s.root.querySelector(".u-over"),this.over.addEventListener("mousedown",this.onMouseDown),this.over.addEventListener("mousemove",this.onMouseMove),this.over.addEventListener("mouseenter",this.onMouseEnter),this.over.addEventListener("mouseleave",this.onMouseLeave),document.addEventListener("mouseup",this.onMouseUp)},this.setSize=()=>{const s=this.over.getBoundingClientRect();this.bLeft=s.left,this.bTop=s.top},this.dispose=()=>{this.over.removeEventListener("mousedown",this.onMouseDown),this.over.removeEventListener("mousemove",this.onMouseMove),this.over.removeEventListener("mouseenter",this.onMouseEnter),this.over.removeEventListener("mouseleave",this.onMouseLeave),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.checkFocus),document.removeEventListener("mousedown",this.detectClickOutside),this.tOverlay.remove(),this.state.mounted=!1,this.emit("destroy")},this.updateOptions=s=>{Object.assign(this.opts,s),this.tOverlay.className=`yagr-tooltip ${this.opts.className||""}`},this.on=(s,i)=>{this.handlers[s].push(i)},this.off=(s,i)=>{this.handlers[s]=this.handlers[s].filter(n=>n!==i)},this.detectClickOutside=s=>{const i=s.target;if(i instanceof Element){const n=i&&this.tOverlay.contains(i),r=i&&this.over.contains(i);!n&&!r&&(this.pin(!1),this.hide())}},this.onMouseDown=s=>{this.state.range=[this.getCursorPosition(),null],this.state.pinned&&(this.pin(!1),this.hide(),this.render({left:s.clientX-this.bLeft,top:s.clientY-this.bTop,idx:this.yagr.uplot.posToIdx(s.clientX-this.bLeft)}),this.skipNextMouseUp=!0)},this.onMouseMove=()=>{this.state.range?.length&&(this.state.range[1]=this.getCursorPosition())},this.setCursorLeaved=s=>{const i=this.over.getBoundingClientRect(),n=s.clientX,r=this.state.range,o=r[0],c=n-i.left>o.clientX,f=this.yagr.config.timeline;let p;c?(r[1]={clientX:this.bWidth,value:this.yagr.uplot.posToVal(this.bWidth,"x"),idx:f.length-1},p=r[1]):(r[1]=r[0],r[0]={clientX:0,value:this.yagr.uplot.posToVal(0,"x"),idx:0},p=r[0]),this.yagr.uplot.setCursor({left:p.clientX,top:s.clientY-i.top})},this.onMouseUp=s=>{if(this.state.range===null)return;const[i]=this.state.range||[];let n;if(s.target===this.over?n=this.getCursorPosition():n=this.state.range[1],this.opts.strategy==="none")return;const r=i&&i.clientX===n?.clientX,o=i&&i.clientX!==n?.clientX,u=this.opts.strategy;(r&&!this.skipNextMouseUp&&u!=="drag"||o&&(u==="all"||u==="drag"))&&(this.pin(!this.state.pinned),this.show(),this.renderTooltipCloses()),this.state.range=null,this.skipNextMouseUp=!1},this.onMouseEnter=()=>{this.show()},this.onMouseLeave=s=>{const i=this.state.pinned;this.state.range?.[0]&&this.setCursorLeaved(s),!i&&this.isNotInDrag&&this.hide()},this.defaultTooltipValueFormatter=(s,i)=>{const n=this.yagr.config.processing||{};return typeof s=="string"?n.nullValues&&n.nullValues.hasOwnProperty(s)?n.nullValues[s]:"-":typeof s=="number"?s.toFixed(typeof i=="number"?i:typeof this.opts.precision=="number"?this.opts.precision:2):"-"},this.getCursorPosition=()=>{const s=this.yagr.uplot.cursor.left;return s===void 0?null:{clientX:s,value:this.yagr.uplot.posToVal(s,"x"),idx:this.yagr.uplot.posToIdx(s)}},this.yagr=e,this.over=e?.uplot?.over,this.opts={...Sn,strategy:t.pinable?"pin":Sn.strategy,tracking:e.config.chart.series?.type==="area"?"area":"sticky",value:this.defaultTooltipValueFormatter,...t},this.bound=this.opts.boundClassName&&document.querySelector(this.opts.boundClassName)||document.body,this.renderNode=this.opts.renderClassName&&document.querySelector(this.opts.renderClassName)||document.body,this.tOverlay=document.createElement("div"),this.tOverlay.id=`${e.id}_tooltip`,this.tOverlay.className=`yagr-tooltip ${this.opts.className||""}`,this.tOverlay.style.display="none",this.state={mounted:!1,pinned:!1,visible:!1,range:null,focusedSeries:null},this.bLeft=0,this.bTop=0,this.bWidth=0,this.opts.virtual?this.placement=()=>{}:(this.renderNode.appendChild(this.tOverlay),this.state.mounted=!0,this.emit("mount"))}get interpolation(){return this.yagr.config.processing?.interpolation}get stripValue(){return this.interpolation?this.interpolation.value:void 0}get isNotInDrag(){return this.opts.strategy==="none"||this.opts.strategy==="pin"?!0:!this.state.range?.[1]}};function yu(e,t={}){const s=new Su(e,t),i=()=>({hooks:{init:o=>{s.initWithUplot(o)},setSize:()=>{s.setSize()},setCursor:o=>{s.render(o.cursor)}}}),n=i();function r(o){const u=i();s.reset(),o.hooks.init.push(u.hooks.init),o.hooks.setSize.push(u.hooks.setSize),o.hooks.setCursor.push(u.hooks.setCursor)}return{state:s.state,pin:s.pin,show:s.show,hide:s.hide,uplot:n,display:s.render,updateOptions:s.updateOptions,on:s.on,off:s.off,tooltip:s,dispose:s.dispose,reInit:r,reset:s.reset}}var wu=yu,lo=(e,t,s,i,n,r,o,u)=>{const{ctx:c}=e,f=Math.round(e.valToPos(t,Te,!0)),p=Math.round(e.valToPos(s,u||pt,!0));if(c.beginPath(),c.arc(f,p,i*2,0,2*Math.PI),c.fillStyle=r,n){const m=c.lineWidth,h=c.strokeStyle;c.lineWidth=n,c.strokeStyle=o,c.stroke(),c.lineWidth=m,c.strokeStyle=h}c.fill(),c.closePath()};function ro(e,t,s,i){const{color:n,scale:r,spanGaps:o,count:u,pointsSize:c}=e.series[t];if(o&&u>1)return!1;let f=s,p;for(;f<=i;){const m=e.data[t][f];if(m===null){p=m,f++;continue}const h=f+1,b=e.data[t][h];Ut(p)&&Ut(b)&&lo(e,e.data[0][f],m,c??xs/2,0,n,n,r||pt),p=m,f++}}function bu(e,t){const{size:s=xs,strokeWidth:i=2,strokeColor:n="#ffffff",show:r}=t.markers,u=t.chart?.series?.pointsSize||xs;function c(p,m,h,b){const{scale:_,_focus:y,color:A,getFocusedColor:x,type:D}=p.series[m];let w=h;const k=D==="dots"?r?s:u:s;for(;w<=b;){const E=p.data[m][w];E!==null&&lo(p,p.data[0][w],E,k,i,(y||y===null?A:x(e,m))||A,n,_||pt),w++}}const f=(p,m)=>{p===0||p===null||(m.type==="dots"||t.markers.show)&&(m.points=m.points||{},m.points.show=c)};return{opts:(p,m)=>{(t.markers.show||m.series.some(h=>h.type==="dots"))&&m.series.forEach((h,b)=>f(b,h))},hooks:{addSeries:(p,m)=>{const h=p.series[m];f(m,h)},setSeries:(p,m,h)=>{f(m,h)}}}}function Eu(e,t,s,i){const n=e.series[t],{type:r,interpolation:o}=n;let u;switch(r){case"column":{u=ee.paths.bars&&ee.paths.bars({size:[ul,fl],...e.series[t].renderOptions||{}});break}case"dots":{u=()=>null;break}case"line":case"area":default:switch(o){case"smooth":u=ee.paths.spline&&ee.paths.spline();break;case"left":u=ee.paths.stepped&&ee.paths.stepped({align:1});break;case"right":{u=ee.paths.stepped&&ee.paths.stepped({align:-1});break}case"linear":default:u=ee.paths.linear&&ee.paths.linear();break}}return u?u(e,t,s,i):null}function dt(e,t,s,i){if(e[s]!==void 0)return e[s];const n=t.config.chart.series;return n&&s in n?n[s]:i}function yn(e,t,s){const i=dt(t,e,"type","line"),n={...t,type:i,show:t.show??!0,name:t.name||`${e.utils.i18n("series")} ${s+1}`,color:t.color?e.utils.colors.parse(t.color):e.utils.theme.DEFAULT_LINE_COLOR,id:(t.id===void 0?t.name:String(t.id))||Ll(),$c:t.data,scale:t.scale||pt,count:0,sum:0,avg:0,getFocusedColor:ea};n.points=n.points||{};const r=Tl(e,"color");return n.type==="area"&&(n.lineColor=e.utils.colors.parse(dt(t,e,"lineColor",ml)),n.lineWidth=dt(t,e,"lineWidth",vl),n.fill=r,n.stroke=Tl(e,"lineColor"),n.width=n.lineWidth,n.points.show=ro,n.interpolation=dt(t,e,"interpolation","linear"),n.spanGaps=dt(t,e,"spanGaps",!1)),n.type==="line"&&(n.width=dt(t,e,"width",Bi),n.width=n.width||Bi,n.stroke=r,n.points.show=ro,n.interpolation=dt(t,e,"interpolation","linear"),n.spanGaps=dt(t,e,"spanGaps",!1)),n.type==="column"&&(n.stroke=r,n.fill=r,n.points.show=!1,n.width=n.width??0,n.renderOptions=dt(n,e,"renderOptions")),n.type==="dots"&&(n.stroke=()=>n.color,n.fill=r,n.width=2,n.pointsSize=dt(n,e,"pointsSize",xs)),n.paths=Eu,n}var oo=(e,t)=>{e.$c=t.$c??e.$c,e.show=t.show??e.show,e.data=t.data??e.data,e.width=t.width??e.width,e.pointsSize=t.pointsSize??e.pointsSize,e.color=t.color??e.color,e.lineColor=t.lineColor??e.lineColor,e.lineWidth=t.lineWidth??e.lineWidth,e.stroke=t.stroke??e.stroke,e.getFocusedColor=t.getFocusedColor??e.getFocusedColor,e.formatter=t.formatter??e.formatter,e.paths=t.paths??e.paths},vs={Series:"series",Axes:"axes"},Tu={Distr:{Linear:1,Ordinal:2,Logarithmic:3,ArcSinh:4}},Xt={Side:{Top:0,Right:1,Bottom:2,Left:3},Align:{Right:0,Left:1}},ao=(e,t)=>{const s=e.range;if(typeof s=="function")return(n,r,o)=>s(n,r,o,t);if(e.normalize)return[0,e.normalizeBase||100];if(e.range==="auto")return;let i;switch(e.range){case void 0:case"nice":{i=Lu;break}case"offset":{i=Au;break}default:throw new Error(`Unknown scale range type ${e.range}`)}return(n,r,o)=>{let{min:u,max:c}=i(r,o,e,t);const f=e.minRange||Xn;if(Math.abs(c-u)<f&&(u>=0?c+=f:(c+=f/2,u-=f/2)),u=typeof e.min=="number"?e.min:u,c=typeof e.max=="number"?e.max:c,e.type==="logarithmic"){const p=typeof e.min=="number";u<=0?u=Vi:p||(u=Math.min(u,Vi))}return(u>=c||c<=u)&&(typeof e.max=="number"?u=c-(wi(c-c*.1,!1)||1):c=u+(wi(u+u*.1,!1)||1)),[u,c]}};function Au(e,t,s){const i=e>=0&&s.stacking,n=t<=0&&s.stacking;return{min:i?0:Math.round(e-Math.abs(e)*(s.offset||zi)),max:n?0:Math.round(t+Math.abs(t)*(s.offset||zi))}}function Lu(e,t,s){const i=e>=0&&s.stacking,r=t<=0&&s.stacking?0:typeof s.max=="number"?s.max:t,o=i?0:typeof s.min=="number"?s.min:e;if(o===r)return o>=0?{min:o,max:o+2}:{min:o-1,max:o+1};const u=r-o,c=wi(u,!1),f=wi(c/(jn-1),!0);let p=Math.ceil(r/f)*f;p=isNaN(p)?100:p;let m=(i?Math.min(0,o):Math.floor(o/f)*f)||0;return m===p&&(m-=1,p+=1),{min:m,max:p}}function wi(e,t){const s=Math.floor(Math.log10(e)),i=e/10**s;return(t?i<1.5?1:i<3?2:i<7?5:10:i<=1?1:i<=2?2:i<=5?5:10)*10**s}function xu(e,t,s){const i=s.scales?{...s.scales}:{};return Object.keys(s.scales).length||(i.y={}),Object.entries(i).forEach(([n,r])=>{t[n]=t[n]||{};const o=t[n];if(n===Te)return;const u=typeof r.min=="number"?r.min:null,c=typeof r.max=="number"?r.max:null;if(c!==null&&u!==null){if(c<=u)throw new Error("Invalid scale config. .max should be > .min");o.range=[u,c]}const f=r.type==="logarithmic";if(f){o.distr=Tu.Distr.Logarithmic,o.range=ao(r,s);return}if(e.isEmpty){o.range=[u===null?f?1:0:u,c===null?100:c];return}o.range=ao(r,s)}),t.x||(t.x={time:!0}),t}var Iu={right:Xt.Side.Right,top:Xt.Side.Top,bottom:Xt.Side.Bottom,left:Xt.Side.Left},ku={left:Xt.Align.Right,right:Xt.Align.Left,top:void 0,bottom:void 0},Ou=(e,t)=>({side:e?Iu[e]:Xt.Side.Left,align:t||(e?ku[e]:void 0)}),co=(e,t="")=>s=>{if(Ut(s))return t;if(s===0)return"0";const i=Math.abs(s),n=e==="auto"?2:e,[r,o]=na(i),u=s/r;return(e==="auto"?String(u).replace(/\.(\d{5,})/,c=>c.slice(0,6)):la(u,n))+o},Du=e=>{const t=e.precision,s=co(typeof t=="number"?t:t||"auto","");return function(n,r){return r.map(s)}},Mu=ee.fmtDate("{DD}.{MM}.{YYYY}"),Pu=ee.fmtDate("{HH}:{mm}:{ss}"),Ru=ee.fmtDate("{mm}:{ss}"),Fu=ee.fmtDate("{mm}:{ss}.{fff}"),Cu=ee.fmtDate("{YYYY}");function uo(e,t){let s=Mu;const i=Math.ceil(e/t);return i<=wt?s=Fu:i<=zt?s=Ru:i<=Ke?s=Pu:i>=Vt&&(s=Cu),n=>s(new Date(n))}var Nu=e=>{const t=e.chart.timeMultiplier||Is;return(s,i)=>{const r=(i[i.length-1]-i[0])/t,o=uo(r,i.length);return i.map(u=>o(u/t))}};function zu(e){return(t,s,i,n)=>{if(e<=2)return[i,n];const o=Math.abs(n-i)/(e-1);let u=o;const c=[];for(;i+u<n;)c.push(i+u),u+=o;return[i,...c,n]}}function bi(e,t){const s=t.utils.theme,i=t.config,n={splits:e.splitsCount?zu(e.splitsCount):e.splits,show:typeof e.show>"u"?!0:e.show,label:e.label||void 0,labelSize:e.labelSize||ll,labelFont:e.labelFont||Hi,font:e.font||Ui,stroke:e.stroke||(()=>s.AXIS_STROKE),ticks:e.ticks?{...s.Y_AXIS_TICKS,...e.ticks}:s.Y_AXIS_TICKS,grid:i.grid||e.grid||s.GRID};return e.scale===Te?Object.assign(n,{getFormatter:uo,gap:e.gap??rl,size:Il(e.size)||(()=>ol),values:e.values||Nu(i),ticks:e.ticks?{...s.X_AXIS_TICKS,...e.ticks}:s.X_AXIS_TICKS,scale:Te,space:e.space||(()=>al),incrs:e.incrs||(()=>cl.map(r=>r*(i.chart.timeMultiplier||Is))),side:2,stroke:e.stroke||(()=>s.AXIS_STROKE)}):(Object.assign(n,{gap:e.gap??el,size:Il(e.size)||nl,values:e.values||Du(e),scale:e.scale||pt,getFormatter:()=>co(typeof e.precision=="number"?e.precision:e.precision||"auto",""),...Ou(e.side||"left",e.align)}),e.space&&(n.space=e.space),n)}function Vu(e){const t=[!1,!0];return Object.values(e).forEach(s=>{["align","side","size","label","labelFont","labelGap","labelSize"].some(n=>s[n]!==void 0)&&(t[1]=!0)}),t}function fo(e){let t,s;return e=e.replace(/(\d+)px/,(i,n)=>kt(t=Math.round((s=Number(n))*window.devicePixelRatio))),[e,t,s]}function ho(e,t,s){const i=bi({...s,font:t.font},e);i.ticks={...t.ticks,...i.ticks},i.grid={...t.grid,...i.grid},i.border={...t.border,...i.border},i.splits=i.splits||t.splits,s.font&&s.font!==t.font?.[0]&&(i.font=fo(s.font)),s.labelFont&&s.labelFont!==t.labelFont?.[0]&&(i.labelFont=fo(s.labelFont)),Object.assign(t,i),e.plugins.plotLines?.update(s.plotLines,s.scale)}function Hu(e,t){const s=[];Object.entries(t.axes).forEach(([r,o])=>{s.push(bi({...o,scale:r},e))});const i=Te,n=pt;return t.axes[i]||s.push(bi({scale:i},e)),s.find(({scale:r})=>r!==i)||s.push(bi({scale:n},e)),s}function Uu(e){let t=!1,s=!1;return e.axes?e.axes.forEach(i=>{i.scale!==Te&&((i.side===void 0||i.side===3)&&(t=!0),i.side===1&&(s=!0))}):t=!0,t&&!s?hl:s&&!t?pl:dl}var Bu=0,Gu={[vs.Series]:0,[vs.Axes]:1,plotLines:2};function wn(e,t){return e.some(s=>ks(s,t))}var $u={"012":"draw",102:"draw",201:"drawClear",210:"drawClear",120:"drawAxes","021":"drawSeries"};function Wu(e){let t=[];return function(s){const i=s.config.chart.appearance?.drawOrder,n=(i?i.map(f=>Gu[f]):[0,1,2]).join(""),r=$u[n]||"drawClear";function o(f){const{ctx:p}=f,{height:m,top:h,width:b,left:_}=f.bbox,y=f.data[0];for(const A of t){if(!A.scale)continue;if(e.render){e.render(f,A);continue}p.save(),p.fillStyle=s.utils.colors.parse(A.color);const{scale:x,value:D}=A;if(Array.isArray(D)){const[w,k]=D.map(U=>{if(Math.abs(U)!==1/0){if(x===Te){if(U<y[0])return y[0];if(U>y[y.length-1])return y[y.length-1]}else{const R=f.scales[x];if(R.min!==void 0&&U<R.min)return R.min;if(R.max!==void 0&&U>R.max)return R.max}return U}const N=U>0?x===Te?f.width:0:x===Te?0:f.height;return f.posToVal(N,x)}),E=f.valToPos(w,x,!0),F=f.valToPos(k,x,!0),P=A.accent;x===Te?(p.fillRect(E,h,F-E,m),P&&(p.fillStyle=P.color,p.fillRect(E,h-P.space,F-E,P.space))):(p.fillRect(_,E,b,F-E),P&&(p.fillStyle=P.color,p.fillRect(b+_,E,P.space,F-E)))}else{const w=f.valToPos(D,x,!0),k=A;if(p.beginPath(),x===Te){const E=f.data[0][f.data[0].length-1],F=f.valToPos(E,x,!0);if(w-F>Bu)continue;p.moveTo(w,h),p.lineTo(w,m+h)}else p.moveTo(_,w),p.lineTo(b+_,w);p.lineWidth=k.width||Qe,p.strokeStyle=k.color||"#000",k.dash&&p.setLineDash(k.dash),p.closePath(),p.stroke()}p.restore()}}const u=r==="drawSeries"?(f,p)=>{p===f.series.length-1&&o(f)}:o,c={get:()=>t,clear:f=>{t=f?t.filter(p=>p.scale!==f):[]},remove:f=>{t=t.filter(p=>!wn(f,p))},add:(f,p)=>{for(const m of f)t.push(p?{scale:p,...m}:m)},update:(f,p)=>{if(!f||f.length===0){c.clear(p);return}const m=f.filter(b=>!wn(t,b)),h=t.filter(b=>!wn(f,b));m.length&&c.add(m,p),h.length&&c.remove(h)},uplot:{opts:()=>{const f=s.config;t=[],Object.entries(f.axes).forEach(([p,m])=>{m.plotLines&&m.plotLines.forEach(h=>{t.push({...h,scale:p})})})},hooks:{[r]:u}}};return c}}function Ei(e,t){for(const s of e||[])if(s===t)return;e?.push(t)}var Yu=class{initMixin(){this._uHooks.onDraw=()=>{if(this.state.stage==="listen")return;this.state.stage="listen",this.execHooks("stage",{chart:this,stage:this.state.stage});const e=performance.now()-this._startTime;this._meta.renderTime=e,this.execHooks("load",{chart:this,meta:this._meta})},this._uHooks.ready=()=>{const e=performance.now()-this._startTime;this._meta.initTime=e,this.execHooks("inited",{chart:this,meta:{initTime:e}})},this._uHooks.drawClear=e=>{const{ctx:t}=e;t.save(),t.fillStyle=this.utils.theme.BACKGROUND,t.fillRect(Qe,Qe,e.width*Qe-2*Qe,e.height*Qe-2*Qe),t.restore()},this._uHooks.setSelect=e=>{const{left:t,width:s}=e.select,[i,n]=[e.posToVal(t,Te),e.posToVal(t+s,Te)],{timeMultiplier:r=Is}=this.config.chart||{};this.execHooks("onSelect",{from:Math.ceil(i/r),to:Math.ceil(n/r),chart:this}),e.setSelect({width:0,height:0,top:0,left:0},!1)}}createUplotOptions(e=!1){const{config:t}=this,s=[];let i=this.plugins?.tooltip;if(t.tooltip&&t.tooltip.show!==!1&&(i?i.updateOptions(t.tooltip):i=wu(this,t.tooltip),s.push(i.uplot),this.plugins.tooltip=i),e)this.plugins.plotLines&&s.push(this.plugins.plotLines.uplot);else{const p=Wu(this.config.plotLines||{})(this);this.plugins.plotLines=p,s.push(p.uplot)}Object.entries(t.plugins).forEach(([p,m])=>{const h=m(this);s.push(h.uplot),Object.assign(this.plugins,{[p]:h})});const n=t.chart,r={width:this.root.clientWidth,height:this.clientHeight,title:t.title?.text,plugins:s,focus:{alpha:Yn},series:[{id:Ni,$c:t.timeline,scale:Te,count:t.timeline.length}],ms:n.timeMultiplier||Is,hooks:t.hooks||{}};if(this.state.isEmptyDataSet=t.timeline.length===0||t.series.length===0||t.series.every(({data:p})=>p.length===0),r.cursor=r.cursor||{},r.cursor.points=r.cursor.points||{},r.cursor.drag=r.cursor.drag||{dist:n.select?.minWidth||Sl,x:r.cursor.y??!0,y:r.cursor.y??!1,setScale:n.select?.zoom??!0},this.utils.sync&&(r.cursor.sync=r.cursor.sync||{key:this.utils.sync.key}),t.cursor){const p=ua(this,t.cursor);this.plugins.cursor=p,s.push(p.uplot)}const o=t.series||[],u=r.series;for(let p=o.length-1;p>=0;p--){const m=yn(this,o[p]||{},p),h=u.push(m);this.state.y2uIdx[m.id||p]=h-1}const c=bu(this,t);return s.push(c),r.series=u,(!t.scales||Object.keys(t.scales).length===0)&&(t.scales={x:{},y:{}}),r.scales=r.scales||{},r.scales=xu(this,r.scales,t),r.axes=r.axes||[],r.axes.push(...Hu(this,t)),r.hooks=t.hooks||{},r.hooks.draw=r.hooks.draw||[],r.hooks.ready=r.hooks.ready||[],r.hooks.drawClear=r.hooks.drawClear||[],r.hooks.setSelect=r.hooks.setSelect||[],Ei(r.hooks.draw,this._uHooks.onDraw),Ei(r.hooks.ready,this._uHooks.ready),Ei(r.hooks.drawClear,this._uHooks.drawClear),Ei(r.hooks.setSelect,this._uHooks.setSelect),r.drawOrder=n.appearance?.drawOrder?n.appearance?.drawOrder.filter(p=>p===vs.Series||p===vs.Axes):[vs.Series,vs.Axes],r.legend={show:!1},r.padding=t.chart.size?.padding||Uu(r),this.plugins.legend?.preInit(this,this.config.legend,r),r.height=this.clientHeight,this.options=r,r}},ju=class{transformSeries(){const e=performance.now(),t=[],s=this.config,i=s.timeline;let n=s.processing||!1,r=this.config.series.map(({data:f})=>f);n&&n.interpolation&&(r=ra(r,i,n),n=!1);const o=!!(n&&n.nullValues),u=n&&n.nullValues||{},c={};for(let f=0;f<r.length;f++){let p=[];const m=f+1,h=r[f],b=this.options.series.length-m,_=this.options.series[b],y=_.scale||pt,A=this.config.scales[y]||{},x=A.stacking,D=_.stackGroup||0;let w=!0;x&&!c[y]&&(this.options.focus=this.options.focus||{alpha:1.1},this.options.focus.alpha=1.1,c[y]=[]),x&&!c[y][D]&&(c[y][D]=new Array(i.length).fill(0)),_.count=0;for(let k=0;k<h.length;k++){let E=h[k];if(o&&u[String(E)]&&(E=null),_.transform&&(_._transformed=!0,E=_.transform(E,r,k)),A.transform&&(_._transformed=!0,E=A.transform(E,r,k)),E===null)if(_.type==="line"||_.type==="dots"){p.push(null);continue}else E=x?0:null;if(w=!1,A.normalize){const P=sa(this.options.series,k,y);E=P&&(E??0)/P*(A.normalizeBase||100),_.normalizedData=_.normalizedData||[],_.normalizedData[k]=E}A.stacking&&(_.show===!1&&(E=0),E=c[y][D][k]+=E??0),A.type==="logarithmic"&&E===0&&(E=1),_.sum=(_.sum||0)+(E||0),typeof _.$c[k]=="number"&&(_.count+=1),p.push(E)}_.avg=(_.sum||0)/_.count,_.empty=w,_.postProcess&&(p=_.postProcess(p,f,this)),t.unshift(p)}return t.unshift(this.config.timeline),this.series=t,this.execHooks("processed",{chart:this,meta:{processTime:performance.now()-e}}),this.series}};function Xu(e,t,s){e.utils.i18n=io(s),t.redrawLegend=!0}function Ku(e,t,s){e.utils.theme.setTheme(t);const n=["light","light-hc","dark","dark-hc"].map(r=>`yagr_theme_${r}`);e.root.classList.remove(...n),e.root.classList.add("yagr_theme_"+t),s.redraw=[!1,!0]}function qu(e,t,s){const{x:i,...n}=s;if(i){const r=e.uplot.axes.find(({scale:o})=>o===Te);r&&ho(e,r,{scale:Te,...i})}Object.entries(n).forEach(([r,o])=>{const u=e.uplot.axes.find(({scale:c})=>c===r);u&&ho(e,u,{scale:r,...o})}),t.redraw=Vu(s)}function Zu(e,t,s){const i=t===null?null:e.state.y2uIdx[t];e.plugins.cursor?.focus(i,s),e.uplot.setSeries(i,{focus:s})}function Ju(e,t,s,i,n){const r=t===null?null:e.state.y2uIdx[t];(t===null?e.config.series:[e.config.series.find(({id:c})=>c===t)]).forEach(c=>{c&&(c.show=s)}),n.fns.push(()=>{e.uplot.setSeries(r,{show:s})}),e.options.series=e.uplot.series;let u=!1;if(r){const c=e.uplot.series[r];c.show=s;const f=c.scale||pt,p=e.config.scales[f];u=!!(p&&p.stacking)}else u=e.options.series.reduce((c,f)=>{const{scale:p}=f;return f.show=s,!!(p&&e.config.scales[p]?.stacking||c)},!1);u&&(n.recalc=!0,n.fns.push(()=>{e.uplot.setData(e.series,!0),i&&e.plugins.legend?.update()}))}function Qu(e,t,s){let i=!1,n=!1;Object.entries(t).forEach(([u,c])=>{const f=e.config.scales[u];if(f){const{stacking:p}=f,{stacking:m}=c;p!==m&&(i=!0),(c.normalize!==f.normalize||c.normalizeBase!==f.normalizeBase)&&(n=!0)}});const r=Object.entries(t).every(([u,c])=>{const f=e.config.scales[u],{min:p,max:m,...h}=f,{min:b,max:_,...y}=c;return!(ks(y,h)===!1)&&(p!==b||m!==_)}),o=Object.keys(t).includes(Te);if(r&&!o)return Object.entries(t).forEach(([u,c])=>{s.fns.push(()=>{e.uplot.setScale(u,{min:c.min,max:c.max})})});(i||n)&&(s.reinit=!0),e.config.scales=t,s.reinit=!0}function ef(e,t){return function(i,n){const r=xl(e,i),o=xl(t,i);return n?!n(r,o):r!==o}}function tf(e,t){if(e.length!==t?.length)return!0;const s=new Map,i=new Map;return e.forEach(n=>{s.set(n.id,n)}),t.forEach(n=>{i.set(n.id,n)}),!!(t.some(({id:n})=>!s.has(n))||e.some(({id:n})=>!i.has(n)))}function sf(e,t,s,i=!1){if(i){e.config={...e.config,...s},t.reinit=!0;return}const n=ef(e.config,s);s.title&&n("title")&&e.setTitle(s.title),s.chart?.appearance?.theme&&n("chart.appearance.theme")&&e.setTheme(s.chart?.appearance?.theme),s.chart?.appearance?.locale&&n("chart.appearance.locale")&&e.setLocale(s.chart?.appearance?.locale),s.axes&&n("axes",ks)&&e.setAxes(s.axes),s.scales&&n("scales",ks)&&e.setScales(s.scales),!!s.series&&tf(e.config.series,s.series)&&(t.redrawLegend=!0),(s.series||s.timeline)&&e.setSeries(s.timeline??e.config.timeline,s.series??e.config.series,{incremental:!1}),s.tooltip&&n("tooltip")&&e.plugins.tooltip?.updateOptions(s.tooltip),s.legend&&n("legend")&&(t.reinit=!0),e.plugins.tooltip?.reset(),t.reopt=!0,e.config={...e.config,...s}}function nf(e,t,s,i={incremental:!0,splice:!1}){let n=[],r=[],o=null,u=!1,c=!1,f;if(["number","string"].includes(typeof t)?(u=!1,f=!1,r=[s],o=t):typeof t[0]=="number"?(n=t,r=s,u=!!i.incremental,f=!i.incremental):(r=t,f=!0),this.isEmpty&&r.some(({data:p})=>p?.length)){e.reinit=!0;return}if(f===!1){let p=!1;if(u&&this.config.timeline.push(...n),r.forEach(m=>{let h=typeof o=="number"?this.config.series[0]:this.config.series.find(({id:_})=>_===m.id||_===o),b=h?.id;if(typeof o=="number"&&this.state.y2uIdx[o]&&(h=this.config.series[o],b=o),h&&b){const{data:_,...y}=m,A=this.state.y2uIdx[b];(h.type==="dots"||m.type==="dots"||this.config.chart.series?.type==="dots")&&(e.reinit=!0),u?h.data=_?h.data.concat(_):h.data:_?.length&&(h.data=_,c=!0);const x=yn(this,Object.assign(h,y),A),D=this.options.series[A],w=this.uplot.series[A];w.show!==x.show&&e.fns.push(()=>{this.uplot.setSeries(A,{show:x.show})}),(w._focus===null||w._focus!==x.focus)&&e.fns.push(()=>{this.uplot.setSeries(A,{focus:x.focus})}),w.color!==x.color&&(p=!0),x.scale&&this.config.scales[x.scale]?.stacking&&(c=!0),oo(D,x),oo(w,x)}else e.fns.push(()=>{const _=yn(this,m,this.config.series.length);this.state.y2uIdx[_.id]=this.uplot.series.length,this.uplot.addSeries(_,this.config.series.length)}),this.config.series.push(m)}),p&&e.fns.push(()=>{this.plugins.cursor?.updatePoints()}),i.splice){const m=r[0].data.length;this.config.series.forEach(h=>{h.data.splice(0,m)}),this.config.timeline.splice(0,n.length)}}else this.config.timeline=n,this.config.series=r,e.reinit=!0;e.reinit||(this._batch.fns.push(()=>this.plugins?.tooltip?.reset()),(c||n.length)&&(e.recalc=!0,e.fns.push(()=>{this.uplot.setData(this.series)})))}var lf=class{setLocale(e){this.batch(t=>Xu(this,t,e))}setTitle(e){this.batch(t=>{this.config.title=e,this.initTitle(),t.redraw=[!0,!0]})}setTheme(e){this.batch(t=>Ku(this,e,t))}setAxes(e){this.batch(t=>qu(this,t,e))}setSeries(e,t,s={incremental:!0,splice:!1}){this.batch(i=>nf.call(this,i,e,t,s))}setFocus(e,t){this.batch(()=>Zu(this,e,t))}setVisible(e,t,s=!0){this.batch(i=>Ju(this,e,t,s,i))}setScales(e){this.batch(t=>Qu(this,e,t))}setConfig(e,t=!1){this.batch(s=>sf(this,s,e,t))}};function rf(e,t){const s=[];t.forEach(i=>{Object.getOwnPropertyNames(i.prototype).forEach(n=>{Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(i.prototype,n)||Object.create(null))}),i.prototype.initMixin&&s.push(i.prototype.initMixin)}),e.prototype.initMixins=function(){s.forEach(i=>i.call(this))}}var of=class{initMixin(){this._batch={active:!1,fns:[]}}batch(e){if(this._batch.active)return e(this._batch);if(this._batch.active=!0,e(this._batch),this._batch.reinit)return this.fullUpdate();this._batch.redrawLegend&&this.plugins.legend?.redraw(),this._batch.reopt&&this.createUplotOptions(!0),this._batch.recalc&&this.inStage("processing",()=>{this.transformSeries()}).inStage("listen"),this._batch.fns.length&&this.uplot.batch(()=>this._batch.fns.forEach(t=>t(this._batch))),this._batch.redraw&&this.uplot&&this.redraw(...this._batch.redraw),this._batch={active:!1,fns:[]}}fullUpdate(){let e,t;this.inStage("dispose",()=>{if(this.uplot){const s=this.uplot.cursor;e=s.left,t=s.top,this.uplot.destroy()}this.plugins.legend?.destroy()}).inStage("config",()=>{this.plugins.legend=new Rl,this._batch={active:!1,fns:[]},this.createUplotOptions(!0),this.options=this.config.editUplotOptions?this.config.editUplotOptions(this.options):this.options}).inStage("processing",()=>{this.transformSeries()}).inStage("uplot",()=>{this.uplot=new ee(this.options,this.series,this.initRender),e&&t&&e>0&&t>0&&this.uplot.setCursor({left:e,top:t}),this.state.subscribed||this.unsubscribe()}).inStage("listen")}},po=class{constructor(e,t){this.plugins={},this._meta={},this._uHooks={},this.init=()=>{this.config.chart.size?.adaptive&&!this.resizeOb&&(this.resizeOb=new ResizeObserver(oa(this.onResize,this.config.chart.size.resizeDebounceMs||100)),this.resizeOb.observe(this.root)),this.config.hooks.dispose||(this.config.hooks.dispose=[]),this.unsubscribe(),this.config.hooks.dispose.push(this.trackMouse())},this.execHooks=(i,...n)=>{const r=this.config.hooks[i];if(Array.isArray(r))for(const o of r)o&&typeof o=="function"&&o(...n)},this.initRender=(i,n)=>{const r=this.config.legend?.position;this.root.firstChild?!r||r==="bottom"?this.root.insertBefore(i.root,this.root.firstChild):this.root.appendChild(i.root):!r||r==="bottom"?this.root.appendChild(i.root):this.root.insertBefore(i.root,this.root.firstChild),this.config.legend?.show&&(this.plugins.legend?.init(i),this.reflow(!1)),this.initTitle(),n()},this.onResize=i=>{const[n]=i;this._cache.height===n.contentRect.height&&this._cache.width===n.contentRect.width||(this.plugins.tooltip?.reset(),this.reflow(),this.execHooks("resize",{entries:i,chart:this}))},this.initMixins(),this._startTime=performance.now(),this.state={isEmptyDataSet:!1,isMouseOver:!1,stage:"config",y2uIdx:{},subscribed:!1};const s=Object.assign({title:{},data:[],axes:{},series:[],scales:{},hooks:{},settings:{},chart:{},cursor:{},plugins:{},legend:{show:!1},tooltip:{show:!0},grid:null,markers:{}},t);this.config=s,this.inStage("config",()=>{this.id=e.id||Ll(),this.root=e,this.root.classList.add("yagr"),this.root.id||(this.root.id=this.id);const i=new ii,n=this.config.cursor.sync,r=this.config.chart;r.series||={type:"line"},r.size||={adaptive:!0},r.appearance||={locale:"en"},r.select||={},this.utils={colors:i,i18n:io(s.chart.appearance?.locale||"en"),theme:new yl(i)},i.setContext(e),n&&(this.utils.sync=ee.sync(typeof n=="string"?n:Kn)),!r.size.adaptive&&r.size.width&&r.size.height&&(e.style.width=kt(r.size.width),e.style.height=kt(r.size.height)),this.plugins.legend=new Rl,this.setTheme(r.appearance.theme||"light"),this.createUplotOptions(),this._cache={height:this.options.height,width:this.options.width},s.editUplotOptions&&(this.options=s.editUplotOptions(this.options))}).inStage("processing",()=>{this.transformSeries()}).inStage("uplot",()=>{this.uplot=new ee(this.options,this.series,this.initRender),this.canvas=e.querySelector("canvas"),this.init();const i=performance.now()-this._startTime;this._meta.processTime=i}).inStage("render")}get isEmpty(){return this.state.isEmptyDataSet}redraw(e=!0,t=!0){this.uplot.redraw(e,t)}getSeriesById(e){return this.uplot.series[this.state.y2uIdx[e]]}dispose(){this.resizeOb&&this.resizeOb.unobserve(this.root),this.unsubscribe(),this.plugins?.tooltip?.dispose(),this.plugins?.legend?.destroy(),this.uplot.destroy(),this._uHooks={},this.execHooks("dispose",{chart:this})}toDataUrl(){return this.canvas.toDataURL("img/png")}subscribe(){this.state.subscribed||(this.utils.sync?.sub(this.uplot),this.state.subscribed=!0)}unsubscribe(){this.utils.sync?.unsub(this.uplot),this.state.subscribed=!1}inStage(e,t){this.state.stage,this.execHooks("stage",{chart:this,stage:e});try{t&&t()}catch(s){console.error(s),this.onError(s)}return this}initTitle(){if(this.config.title&&this.config.title.fontSize){const e=this.config.title.fontSize,t=this.root.querySelector(".u-title");t.setAttribute("style",`font-size:${e}px;line-height:${e}px;`),t.innerHTML=this.config.title.text}}onError(e){return this.execHooks("error",{stage:this.state.stage,error:e,chart:this}),e}trackMouse(){const e=()=>{this.state.isMouseOver=!0},t=()=>{this.state.isMouseOver=!1};return this.root.addEventListener("mouseover",e),this.root.addEventListener("mouseleave",t),()=>{this.root.removeEventListener("mouseover",e),this.root.removeEventListener("mouseleave",t)}}get clientHeight(){const t=this.config.title.text?(this.config.title.fontSize||qn)+8:0;return this.root.clientHeight-t-(this.plugins.legend?.state.totalSpace||0)}reflow(e=!0){const t=this.root.clientWidth,s=this.clientHeight;this._cache.width=t,this.options.width=t,this._cache.height=s,this.options.height=s,e&&this.uplot.setSize({width:this.options.width,height:this.options.height}),e&&this.uplot.redraw()}};rf(po,[Yu,ju,lf,of]);var go=po,af=Wn;typeof window<"u"&&Object.assign(window,{Yagr:go});var cf=go;if(typeof ht.exports=="object"&&typeof Ls=="object"){var uf=(e,t,s,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Object.getOwnPropertyNames(t))!Object.prototype.hasOwnProperty.call(e,n)&&n!==s&&Object.defineProperty(e,n,{get:()=>t[n],enumerable:!(i=Object.getOwnPropertyDescriptor(t,n))||i.enumerable});return e};ht.exports=uf(ht.exports,Ls)}return ht.exports});
//# sourceMappingURL=yagr.umd.min.js.map
