import React from 'react';
import { ThemeContext } from './ThemeContext';
import { ThemeSettingsContext } from './ThemeSettingsContext';
import { DEFAULT_DARK_THEME, DEFAULT_LIGHT_THEME, DEFAULT_THEME } from './constants';
import { getDeprecatedRootClassName, getRootClassName } from './getBodyClassName';
import { updateBodyClassName } from './updateBodyClassName';
import { useSystemTheme } from './useSystemTheme';
export function ThemeProvider({ theme = DEFAULT_THEME, systemLightTheme = DEFAULT_LIGHT_THEME, systemDarkTheme = DEFAULT_DARK_THEME, nativeScrollbar = false, scoped = false, rootClassName = '', children, }) {
    const systemTheme = (useSystemTheme() === 'light' ? systemLightTheme : systemDarkTheme);
    const themeValue = theme === 'system' ? systemTheme : theme;
    const prevRootClassName = React.useRef('');
    React.useEffect(() => {
        if (!scoped) {
            updateBodyClassName(themeValue, { 'native-scrollbar': nativeScrollbar }, rootClassName, prevRootClassName.current);
            prevRootClassName.current = rootClassName;
        }
    }, [nativeScrollbar, themeValue, scoped, rootClassName]);
    const contextValue = React.useMemo(() => ({
        theme,
        themeValue,
    }), [theme, themeValue]);
    const themeSettingsContext = React.useMemo(() => ({ systemLightTheme, systemDarkTheme }), [systemLightTheme, systemDarkTheme]);
    return (React.createElement(ThemeContext.Provider, { value: contextValue },
        React.createElement(ThemeSettingsContext.Provider, { value: themeSettingsContext }, scoped ? (React.createElement("div", { className: getRootClassName({ theme: themeValue, 'native-scrollbar': nativeScrollbar }, [
                getDeprecatedRootClassName({
                    theme: themeValue,
                    'native-scrollbar': nativeScrollbar,
                }),
                rootClassName,
            ]) }, children)) : (children))));
}
ThemeProvider.displayName = 'ThemeProvider';
